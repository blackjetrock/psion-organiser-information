<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- saved from url=(0043)https://www.jaapsch.net/psion/mancomms2.htm -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>Comms Link Manual - Jaap's Psion Organiser II Page</title>
<link rel="stylesheet" type="text/css" href="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/psion.css">
<link rel="shortcut icon" href="https://www.jaapsch.net/psion/pics/favicon.ico">
<style type="text/css">
  .key {
     text-decoration:none;
     font-weight: bold;
  }
  .ul {
     border-bottom:1px solid #000;
  }
</style>
<script type="application/ld+json">
{
  "@context": "http://schema.org", "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem", "position": 1,
    "item": { "@id": "../index.htm", "name": "Home" }
  },{
    "@type": "ListItem", "position": 2,
    "item": { "@id": "index.htm", "name": "Psion II" }
  },{
    "@type": "ListItem", "position": 3,
    "item": { "@id": "mancomms2.htm", "name": "Comms Link Manual (1989)" }
  }]
}
</script>
</head>
<body>
<div class="header"><h1>Jaap's Psion II Page</h1><a href="https://www.jaapsch.net/psion/index.htm" class="jpp"></a></div>
<ol class="breadcrumb">
  <li><a href="https://www.jaapsch.net/index.htm">Home</a> /</li>
  <li><a href="https://www.jaapsch.net/psion/index.htm">Psion II</a> /</li>
  <li>Comms Link Manual (1989)</li>
</ol>


<p>Below is the version of the Comms Link manual used from 1989, when the Comms
Link was updated to make use of the LZ model's larger screen. Note that it
is still compatible with the CM and XP models. This manual is also available
in <a href="https://www.jaapsch.net/psion/mancomms2g.htm">German</a>. The previous version of the
manual used until 1988 can be found here:
<br><a href="https://www.jaapsch.net/psion/mancomms.htm">Comms Link Manual (1987-88)</a>
</p>

<hr>

<h1>Organiser II
<br>Comms Link
<br>RS232</h1>

<hr>

<p>
Copyright Psion PLC 1989
</p>

<p>
All rights reserved. This manual and the programs referred to
herein are copyrighted works of Psion PLC, London, England.
Reproduction in whole or in part including utilisation in
machines capable of reproduction or retrieval, without the
express written permission of Psion PLC is prohibited. Reverse
engineering is also prohibited.
</p>

<p>
The information in this document is subject to change without
notice.
</p>

<p>
Psion and the Psion logo are registered trademarks of Psion
PLC. Psion Organiser II, Datapak and Rampak are trademarks
of Psion PLC.
</p>

<p>
All references in this manual to PCs are to the IBM PC, IBM
XT and IBM AT, which are registered trademarks of
International Business Machines Corp.
</p>

<p>
All references in this manual to Macintosh are to the Apple
Macintosh range of computers. Apple and Macintosh are
registered trademarks of Apple Computer Inc.
</p>

<p>
VAX and VMS are trademarks of Digital Equipment Corp.
<br>Lotus, 1-2-3 and Symphony are registered trademarks of Lotus
Development Corp. DIF is a trademark or Software Arts Inc.
<br>Hayes is a trademark of Hayes Microcomputer Products Inc.
</p>

<p>
VI(February 92)
<br>Part No. 6100-0071
</p>

<hr>

<h2>Contents</h2>

<p class="contents">
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p0"><b>Introduction</b></a>

<b>Setting up</b>
1 <a href="https://www.jaapsch.net/psion/mancomms2.htm#p1">Fitting the Comms Link Cable</a>
2 <a href="https://www.jaapsch.net/psion/mancomms2.htm#p2">Communications parameters</a>

<b>Connecting to your application</b>
3 <a href="https://www.jaapsch.net/psion/mancomms2.htm#p3">Connecting to an IBM PC/XT/AT or compatible</a>
4 <a href="https://www.jaapsch.net/psion/mancomms2.htm#p4">Connecting to a Macintosh</a>
5 <a href="https://www.jaapsch.net/psion/mancomms2.htm#p5">Connecting to any other computer</a>
6 <a href="https://www.jaapsch.net/psion/mancomms2.htm#p6">Connecting to a printer</a>
7 <a href="https://www.jaapsch.net/psion/mancomms2.htm#p7">Terminal emulation</a>

<b>Further use</b>
8 <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8">Comms Link and OPL</a>

<b>Appendices</b>
A <a href="https://www.jaapsch.net/psion/mancomms2.htm#pA">ASCII Control characters</a>
B <a href="https://www.jaapsch.net/psion/mancomms2.htm#pB">The Comms Link Interface</a>
C <a href="https://www.jaapsch.net/psion/mancomms2.htm#pC">Parity, Bits and Stop</a>

<a href="https://www.jaapsch.net/psion/mancomms2.htm#pI"><b>Index</b></a>
</p>

<hr>

<a id="p0"></a><h2>Introduction</h2>

<p>
The Psion Comms Link connects your Organiser II to a
printer, desktop computer, modem, or any device
which has an RS232 serial port. What you can do with
Comms Link depends on the device that it connects to.
Common uses are:
</p>

<ul>
<li>Printing files and programs
</li><li>Sending files and programs between your
Organiser and a desktop computer
</li><li>Using the Organiser as a terminal to access
Electronic Mail and Telex services.
</li></ul>

<p>
If you wish to connect to an IBM PC/XT/AT or
compatible, or a Macintosh, the Comms Link package
includes special software (on the floppy disk) for one of
these computers. If you wish to communicate with any
other kind of computer you will need a
communications program for that computer.
</p>

<p>
When using Comms Link, you may be doing a variety
of things on the Organiser. You may be:
</p>

<ul>
<li>In OPL - running a procedure under the Prog
option from the top-level menu, say.
</li><li>In another Organiser application, such as the
Pocket Spreadsheet.
</li><li>In the Comms Link's own menu - the Comms
menu.
</li></ul>

<p>
Each of these has its advantages. Using the Comms
menu is fast and direct: you can print and transmit
files simply by selecting an item from a menu. With
OPL you have greater control and access to operations
selecting which records in a data file are printed and
controlling the print layout.
</p>

<p>
If you are working on the Pocket Spreadsheet (available
as a separate product) you are now capable of loading
and saving Lotus 1-2-3, Symphony and DIF files from
an attached Apple Macintosh, IBM PC/XT/AT or
compatible.
</p>

<p>
When you select Comms from the top level menu you
are presented with the Comms menu. The items it
contains have a variety of functions. They are covered
in detail in later chapters, but below is an overview. On
model LZ the Comms menu is displayed like this:
</p>

<p class="indent"><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/menu.gif" alt="LZ Comms Menu" width="410" height="258">

</p><p>
On models CM and XP this menu appears like this:
</p>

<p class="indent"><span class="screen">TRANSMIT RECEIVE
SETUP TERM AUTO </span><span class="code">
CAPTURE BOOT</span></p>

<p>
Comms link server all models of the Organiser II, as
does this manual.
</p>

<h3>This manual</h3>

<p>
Because Comms Link can be used for very different
tasks, there are separate chapters on linking to a
printer, a desktop computer and through terminal
emulation. But certain features of preparing the
connection for use are the same whatever your
application. These are covered in Chapters 1 and 2,
and you should read these first.
</p>

<p>
Chapter 8, 'Comms Link and OPL' is relevant for all
applications, and additional technical information is
provided in the appendices.
</p>

<hr>

<a id="p1-1"></a>
<a id="p1"></a><h2>1 Fitting the
Comms Link
cable</h2>

<h3>Plugging into the
Organiser</h3>

<p>
At one end of the Comms Link cable is the
industry standard 25-pin RS232 socket; this plugs
into your printer/computer/modem. At the other end
of the cable is a moulded fitting which plugs into your
Organiser. This plug contains the additional software
which the organiser needs to use Comms Link.
</p>

<p>
To plug the cable into the Organiser:
</p>

<ul class="arrowlist">
<li> First switch off your Organiser by selecting Off
from the top-level menu (if you have a Rampak
fitted see the note overleaf).
</li><li> Slide open the door at the top of the Organiser and
insert the plug into the port, making sure it slides
all the way in until you feel a click. (The plug will
only go in one way, with the Psion name on the
upper face.)
</li><li> To load the communications software into the
Organiser, press the <span class="key">ON/CLEAR</span> key twice. The
first press switches the Organiser on and the
second press loads the software.
</li></ul>

<a id="p1-2"></a>
<p>
A new menu option, Comms, will have been inserted
into the main Organiser menu, just before the last
option, Off. Press <span class="key">ON/CLEAR</span> again if it hasn't.
</p>

<p>
<b>If Comms doesn't appear in the menu</b>, you may not
have inserted the plug fully.
</p>

<ul class="arrowlist">
<li> Switch the machine off and remove the cable.
</li><li> Carefully re-insert it and then press <span class="key">ON/CLEAR</span>
twice again.
</li></ul>

<p>
<b>OUT OF MEMORY</b> message? - there isn't enough
internal memory (4K approximately) left on your
Organiser to load the Comms Link software.
</p>

<ul class="arrowlist">
<li> Clear some memory - e.g. delete any non-vital files
or records; use the Tidy option in the Diary; or
Save your files on a Datapak and then erase them
on A:.
</li><li> Return to the top-level menu. Press <span class="key">ON/CLEAR</span>.
</li></ul>

<p>
If you get the same error message, clear some more
memory.
</p>

<p>
<b>If you have a Rampak</b>, you are advised to remove it
before fitting the Comms Link cable. Follow this
procedure:
</p>

<ul class="arrowlist">
<li>Switch off the Organiser and remove the Rampak.
</li><li>Insert the Comms Link cable. If you are using a
Mains Adaptor, insert it into the Comms Link.
</li><li>Switch on the Organiser (this dissipates any power
surge).
</li><li><a id="p1-3"></a>Switch off the Organiser. Insert the Rampak.
</li><li>Switch on the Organiser. Press <span class="key">ON/CLEAR</span> again
to load the Comms Link software.
</li></ul>

<p>
<b>If you have a Mains Adaptor</b>, a good time to use it is
while using Comms Link, especially when receiving
files to a Datapak. To connect the Mains Adaptor,
simply plug it into the socket on the Comms Link
fitting.
</p>

<h4>Removing the cable from the
Organiser</h4>

<ul class="arrowlist">
<li> Switch off the Organiser by selecting Off.
</li><li> Press the catch below the Psion label and pull.
</li></ul>

<p>
The software will still be stored in memory, however.
To remove this:
</p>

<ul class="arrowlist">
<li> Press <span class="key">ON/CLEAR</span> to switch the Organiser back on.
</li><li> Press <span class="key">ON/CLEAR</span> again at the top level menu.
</li></ul>

<p>
The Comms option should now have disappeared from
the main menu - and the memory used by Comms
Link freed for other uses.
</p>

<p>
<b>Don't</b> unplug the cable while the Organiser is switched
on. This could cause electrical damage to the
Organiser and Comms Link. (A DEVICE MISSING error
would be reported if you were using the Comms option
at the time.)
</p>

<a id="p1-4"></a>
<h3>Plugging into a printer or
desktop computer</h3>

<p>
Because there is no absolutely standard hardware
communications interface, you may need to prepare
your machine before it can connect with the Organiser.
</p>

<h5>
Does your printer/computer have an
RS232 (serial) port ?
</h5>

<ul>
<li>If your <b>computer</b> doesn't have a serial port your
dealer may supply a 'serial card'.
</li><li>If your <b>printer</b> doesn't have a serial port, you have
two alternatives: obtain either a 'serial card' or a
'serial to parallel converter'.
</li></ul>

<h5>
Is this serial port male or female ?
</h5>

<p>
The Comms Link plug is female, so it needs a male
serial port to connect to (see below].
</p>

<p align="center"><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/rs232.jpg" alt="RS232 Male and Female Connectors" width="252" height="208">

</p><p>
If the gender of your printer or desktop computer port
is female, you will definitely need an adaptor.
</p>

<a id="p1-5"></a>
<h5>
Do you need an adaptor ?
</h5>

<p>
If you have an IBM PC, XT or compatible, you won't
need an adaptor. The following will require an adaptor:
</p>

<ul>
<li>Most printers
</li><li>IBM ATs and compatibles
</li><li>Macintoshes
</li><li>Most other Computers
</li></ul>

<p>
Psion provides suitable adaptors for some of these.
</p>

<p>
<b>If you have an Adaptor</b> and it physically fits the port
on your printer/computer:
</p>

<ul class="arrowlist">
<li> Proceed with this manual and see if the
connection works.
</li><li> If it doesn't, check the wiring details in Appendix B
of this manual and in the manual for the printer/
other computer.
</li><li> Consider obtaining an adaptor from Psion or
having one made up.
</li></ul>

<p>
<b>If you use a modem</b>, use the cable that connects the
computer to the modem to connect the computer with
the Comms Link.
</p>

<h4>Plugging into a modem</h4>

<p>
If you wish to connect with a modem, you will need a
<b>modem adaptor</b> to fit between the Comms Link cable
and the modem itself.
</p>

<p>
Modem adaptors are available from Psion. For further
details of modem adaptors see Appendix B.
</p>

<hr>

<a id="p2-1"></a>
<a id="p2"></a><h2>
2 Communications
parameters
</h2>

<p>
Before the Organiser and your printer, desktop
computer or modem can communicate, certain basic
<b>communications parameters</b> must be matched
between the Organiser and the other machine. For
each application, only certain changes need to be
made from the set-up which Comms Link starts with:
</p>

<ul>
<li>For Macintoshes and IBM PC/XT/ATs and
compatibles, only one change is necessary from
the default Setup. This is explained fully in the
Chapters devoted to these applications. It is
recommended that you study this Chapter if you
intend to use Comms Link for more advanced
operations than standard file transfer.

</li><li>When you're not connecting to one of these
computers, setting up is more complex. However,
you will only have to do the initial setup once, and
thereafter it will be easier to change the Setup for
any additional particular tasks because you will be
familiar with Setup.
</li></ul>

<p>
First make sure that the Organiser and your machine
are fully connected via the Comms Link cable.
</p>

<ul class="arrowlist">
<li> Select Comms from the top-level menu, then select
Setup from the Comms menu.
</li></ul>

<p>
You are presented with a list of the communications
parameters, given in full in the table overleaf.
</p>

<a id="p2-2"></a>
<a id="p2-3"></a>
<table summary="">
<tbody><tr><th class="ul">Name</th><th class="ul">Default</th><th class="ul">Options</th><th class="ul" colspan="2">Parameter function</th><th class="ul">How to change</th></tr>
<tr><td class="ul">BAUD</td><td class="ul">9600</td><td class="ul">50, 75, 110, 150, 300, 600, 1200, 2400, 4800, 9600</td><td class="ul" colspan="2">Baud rate - rate at which data is transferred</td>
  <td class="ul" rowspan="7"><ul class="arrowlist"><li>Move are cursor down the list of parameters with ↓
    and ↑ to the one you want. → appears after
    the name of the parameter which is current.
    </li><li>Change the parameter value by circling through the
    list of options with → and ←.
    </li></ul>
    </td></tr>
<tr><td class="ul">PARITY</td><td class="ul">NONE</td><td class="ul">NONE, ODD, EVEN, MARK, SPACE</td><td class="ul">Parity</td><td class="ul" rowspan="3">Determine control bits added to character for transmission</td></tr>
<tr><td class="ul">BITS</td><td class="ul">8</td><td class="ul">7, 8</td><td class="ul nowrap">No. of data bits</td></tr>
<tr><td class="ul">STOP</td><td class="ul">1</td><td class="ul">1, 2</td><td class="ul nowrap">No. of stop bits</td></tr>
<tr><td class="ul">HAND</td><td class="ul">XON</td><td class="ul">NONE, XON, RTS, XON+RTS,DTR, XON+DTR, RTS+DTR, ALL</td><td class="ul" colspan="2">Type of handshaking used</td></tr>
<tr><td class="ul">PROTOCOL</td><td class="ul">NONE</td><td class="ul">NONE, XMODEM, PSION</td><td class="ul" colspan="2">File transfer protocol</td></tr>
<tr><td class="ul">ECHO</td><td class="ul">HOST</td><td class="ul">LOCAL, HOST</td><td class="ul" colspan="2">Whether transmitted characters are displayed</td></tr>


<tr><td class="ul">WIDTH</td><td class="ul">NONE</td><td class="ul">NONE, an integer between 1 and 250</td><td class="ul" colspan="2">Used to limit the number of characters in a single line</td>
   <td rowspan="8"><ul class="arrowlist"><li>Move the cursor down the list of parameters with ↓
      and ↑ to the one you want. → appears after the name of the
      parameter which is current.
      </li><li> Change the parameter value by pressing <span class="key">EXE</span>, typing
      in a value and pressing <span class="key">EXE</span> again. Pressing <span class="key">ON/CLEAR</span>
      resets the current parameter to its original value.</li></ul></td></tr>
<tr><td class="ul">TIMEOUT</td><td class="ul">NONE</td><td class="ul">NONE, an integer between 1 and 255</td><td class="ul" colspan="2">Time after which a failed operation will be abandoned and error reported</td></tr>
<tr><td class="ul">REOL</td><td class="ul">&lt;CR&gt;&lt;LF&gt;</td><td class="ul">NONE, 1 or 2 characters (in ASCII code)</td><td class="ul" colspan="2">Which received character(s) indicate the end of a line</td></tr>
<tr><td class="ul">REOF</td><td class="ul">&lt;SUB&gt;</td><td class="ul">NONE, 1 or 2 characters (in ASCII code)</td><td class="ul" colspan="2">Which received character(s) indicate the end of a file</td></tr>
<tr><td class="ul">RTRN</td><td class="ul">NONE</td><td class="ul">NONE, 1 or 2 characters (in ASCII code)</td><td class="ul" colspan="2">Which character is to replace a specified received character</td></tr>
<tr><td class="ul">TEOL</td><td class="ul">&lt;CR&gt;&lt;LF&gt;</td><td class="ul">NONE, 1 or 2 characters (in ASCII code)</td><td class="ul" colspan="2">Which transmitted character(s) indicate the end of a line</td></tr>
<tr><td class="ul">TEOF</td><td class="ul">&lt;SUB&gt;</td><td class="ul">NONE, 1 or 2 characters (in ASCII code)</td><td class="ul" colspan="2">Which transmitted character(s) indicate the end of a file</td></tr>
<tr><td>TTRN</td><td>NONE</td><td>NONE, 1 or 2 characters (in ASCII code)</td><td colspan="2">Which character is to replace a specified character before transmission</td></tr>
</tbody></table>

<a id="p2-4"></a>
<h3>The Setup list</h3>

<p>
When you select Setup, the parameter names are listed
down the left of me screen, and their settings down the
right:
</p>
<table summary="">
<tbody><tr><td><span class="screen">Baud →          9600
Parity          NONE
Bits               8
Stop               1</span></td>
<td><br>or</td>
<td><br><span class="screen">BAUD →      9600
PARITY      NONE</span></td></tr>
<tr><td>(model LZ)</td><td></td><td>(models XP and CM)</td>
</tr></tbody></table>

<p>
The → sign indicates the current parameter - i.e. the
one whose setting is currently being changed.
</p>

<h4>To change the settings</h4>

<p>
When you change the settings, not all the parameters
behave in the same way. This is because some
parameters have a large range of allowed values,
others a restricted range (see opposite). The method of
selection is appropriate for the size of the range:
</p>

<p>
For Baud down to Echo:
</p>

<ul class="arrowlist">
<li> Press the ← and → cursor keys to cycle through
the allowed list or values. The setting displayed is
the setting that will be selected.
</li><li> Press <span class="key">ON/CLEAR</span> to restore the default setting.
</li></ul>

<p>
For Width down to Ttrn:
</p>

<ul class="arrowlist">
<li> Press <span class="key">EXE</span> to clear the old parameter value.
</li><li> Type in the new parameter value, using DEL to
correct. If you enter more than one number,
separate them by commas - e.g. 13,10
</li><li><a id="p2-5"></a> Press <span class="key">ON/CLEAR</span> to clear what you've typed.
(Pressing <span class="key">ON/CLEAR</span> again restores the previous
value. Pressing <span class="key">ON/CLEAR</span> a further time restores
the parameter to its default setting.)
</li><li> Press <span class="key">EXE</span> to enter the new value. To enter the
value NONE, press <span class="key">EXE</span> while the line is clear.
</li></ul>

<p>
If the new value is accepted it is displayed. If the value
is invalid, the data is cleared and you return to the
editor, where you can type, correct and enter another
value.
</p>

<h4>Values allowed</h4>

<p>
Those parameters which have a restricted range of
allowed values are presented as a list - like a menu
which you cycle through, and from which you select
one item.
</p>

<p>
The other parameters accept too wide a range of values
to be presented in this way, and so you type in the
value directly. The value entered is a number, but what
the number signifies is different for different
parameters:
</p>

<p>
Width - number of characters
<br>Timeout - number of seconds
<br>Reol, Reof, Rtrn, Teol, Teof, Ttrn - ASCII code.
</p>

<p>
ASCII codes are used so that a full character set, not
just the characters on the Organiser keyboard, are
available to you.
</p>

<ul class="arrowlist">
<li> To decide the code for the character you want,
consult the full ASCII character set given in an
Appendix of the Organiser manual.
</li><li><a id="p2-6"></a> When you have decided, type in the character's
numeric code. When you press <span class="key">EXE</span>, the character
corresponding to the code is displayed.
</li></ul>

<p>
E.g. entering 42 displays an asterisk, since the ASCII
code for * is 42.
</p>

<p>
<b>Control characters</b> (codes 0 to 31 and 127) have their
ASCII names shown in angle brackets - e.g. 13,10 as
&lt;CR&gt;&lt;LF&gt;. Appendix A in this manual gives the names
of the ASCII control codes.
</p>

<p>
Characters with codes greater than 127 display as a
<b>hexadecimal</b> value in angle brackets - e.g. 128 as
&lt;$0D&gt;.
</p>

<p>
The numbers you enter are interpreted as decimal
numbers unless they are prefixed by a dollar sign ($),
when they are taken to be hexadecimal (base 16). For
example, the ASCII carriage return code may be
entered as 13 or as $D. (Counting in hexadecimal is
like this: 1 2 3 4 5 6 7 8 9 A B C D E F 10 11 12 13 ...
where 10 is equivalent to 16 in decimal.)
</p>

<h3>Saving the Setup list</h3>

<p>
Once you have set the parameters to their correct
values, press <span class="key">MODE</span> to enter the setup menu. On
model LZ this is displayed along the top line of the
screen:
</p>

<p class="indent"><span class="screen">Exit Abandon Edit S→
____________________
Parity          NONE
Bits               8</span></p>

<p>
The → sign on the top line indicates that more items
follow.
</p>

<a id="p2-7"></a>
<p>
On models XP and CM the menu is displayed like this:
</p>

<p class="indent"><span class="screen">EXIT ABANDON   &nbsp;
EDIT SAVE LOAD  </span><span class="code">
DIR ERASE RESET</span></p>

<p>
The menu contains the following items:
</p>

<table summary="">
<tbody><tr><th width="100">Exit     </th><td>Exits Setup menu, implementing any
         changes.</td></tr>
<tr><th>Abandon  </th><td>Exits Setup menu, discarding any
         changes.</td></tr>
<tr><th>Edit     </th><td>Returns to the parameter list to
         continue editing.</td></tr>
<tr><th>Save     </th><td>Saves the current Setup list.</td></tr>
<tr><th>Load     </th><td>Loads a previously saved Setup list.</td></tr>
<tr><th>Dir      </th><td>Read the directory of saved Setups.</td></tr>
<tr><th>Erase    </th><td>Erases a previously saved setup list.</td></tr>
<tr><th>Reset    </th><td>Resets to the default setup settings.</td></tr>
</tbody></table>

<p>
You select from the menu in the same way as from
other menus.
</p>

<p>
Whilst you are viewing the setup menu you cannot
edit the parameter settings. Select Edit to do this.
</p>

<p>
When you Exit the setup menu <b>and not before</b>, the
current parameter settings used by the Comms Link
software are replaced by the settings in the displayed
list. If you choose to Abandon the edit, you return to
the Comms menu but the parameters actually used
are <b>not</b> changed.
</p>

<a id="p2-8"></a>
<h5>When setup returns to the default values</h5>

<p>
The only time that the parameters actually used
change is when you Exit the setup option after editing
the values. It is therefore not necessary to use Setup
each time you remove and insert the Comms Link
cable. The parameters are reinitialised to their default
values only in the following cases:
</p>

<ul>
<li>When the Organiser is reset using the Reset
command in the top-level menu.
</li><li>When the organiser has no power (e.g. when the
battery is removed for longer than 90 seconds).
</li></ul>

<p>
The parameters are not re-initialised when you select
Reset in the Setup menu - unless you then select Exit
to implement the changes.
</p>

<p>
The Setup option effectively makes a copy of the
current parameters which you can view, modify and
then implement if you choose.
</p>

<h3>Setup files</h3>

<p>
With the Save, Load, Dir and Erase commands in the
Setup menu, you can create and maintain parameter
setting files to fit your personal requirements.
</p>

<p>
For example, you might save one Setup list for
connecting directly with your desktop computer and
one for connecting via a modem. Then you could
prepare the Comms link in each case simply by
loading the file containing your tested settings.
</p>

<p>
Selecting either Exit or Abandon returns to the Comms
menu. Selecting Edit returns to the parameter editor.
</p>

<a id="p2-9"></a>
<p>
The remaining commands return to the Setup menu
on completion.
</p>

<p>
When you select Save, Load or Erase from the Setup
menu, the screen shows a prompt like this:
</p>

<p class="indent code">Save A:
Load A:</p>

<p>
or
</p>

<p class="indent code">Erase A:</p>

<p>
Press the <span class="key">MODE</span> key to change the device, if you wish,
and then enter the desired Setup file name in the
usual way. (On model LZ, press <span class="key">EXE</span> or ↓ to get a
directory list of files - with Load and Erase commands
only.)
</p>

<p>
<b>Load, Save and Erase do not affect the parameter
values currently being used by the Comms Link
software.</b> They replace only the parameters displayed
in the Setup list. Select Exit from the menu to
implement the settings.
</p>

<p>
To view a directory of Setup files select the Dir option
from the Setup menu. Press <span class="key">MODE</span> to change the
current device, if necessary. Press <span class="key">EXE</span> as usual to
view the names of Setup files which are stored on the
specified device. Press <span class="key">ON/CLEAR</span> to return to the
Setup menu.
</p>

<hr>

<a id="p3-1"></a>
<a id="p3"></a><h2>
3 Connecting to
an IBM PC or
compatible
</h2>

<h5>Introduction</h5>

<p>
This Chapter assumes that your Organiser and your
PC have been physically connected as explained in
Chapter 1. This Chapter describes the process of
transferring files between an Organiser and an
IBM PC/XT/AT or compatible which is running the
supplied Comms Link software.
</p>

<p>
The advantages of using this software compared to
some other communications program are:
</p>

<ul>
<li>There are fewer communications parameters to set.
</li><li>The communication is based on an error-checked
framing protocol. This means there is only a
negligible chance of receiving corrupted data, even
when using modems over a dial-up line.
</li><li>The advanced protocol allows communication to be
controlled entirely from the Organiser. This means
that you can receive files from an <b>unattended</b>
computer running the Comms Link software.
</li><li>Comms Link provides the basis for advanced
communications applications - e.g. loading
spreadsheet files from your computer (when used
with the Organiser Pocket Spreadsheet).
</li><li><a id="p3-2"></a>You can write OPL programs to run via Comms
Link - e.g. to perform more complex file transfers
or to access remote files on the PC directly from
the Organiser.
</li></ul>

<h5>Installing the Comms Link files</h5>

<p>
Before installing Comms Link, make a copy of the disk
in case it becomes corrupted. Keep the original as a
backup and install Comms Link from the copy.
</p>

<p>
If you have a hard disk, you may find it convenient to
create a sub-directory in which to store the Comms
Link files. Then use the DOS command PATH to set up
a path to the Comms Link directory. If you use PATH
in your AUTOEXEC.BAT file you can run Comms Link
from any directory. See your DOS manual for details
on how to do this.
</p>

<p>
When running the Comms Link program from a floppy
disk, you should not remove the floppy disk containing
the Comms Link program at any time. You may find it
convenient to make this floppy disk an operating
system disk as well, so that it can run on its own
without your having to keep inserting another system
disk.
</p>

<a id="p3-3"></a>
<h3>Transferring a file</h3>

<p>
The process of transferring a file from the Organiser to
a PC, or vice versa, is extremely straightforward,
because:
</p>

<ul>
<li>A minimum of preparation is required once you
have physically plugged the two machines together.
</li><li>The transfer itself involves nothing more than
selecting items from menus and typing in
appropriate file names.
</li></ul>

<p>
This section uses the example of sending a procedure
file from the Organiser to the PC, and then receiving it
back to the Organiser. The easiest way to get familiar
with Comms Link is probably to follow this example
through, and then experiment with transmitting and
receiving different types of files.
</p>

<h4>Starting up</h4>

<h5>On the PC:</h5>

<p>
To run the Comms Link program:
</p>

<ul class="arrowlist">
<li> Go to the directory where the Comms Link Files are
stored.
</li></ul>

<p>
If you've set a PATH to this directory, go to the
directory to which you want to send Organiser files.
This will make it easier to specify file names later on.
</p>

<ul class="arrowlist">
<li> Type <span class="code">CL </span>↵
</li></ul>

<p>
The program display appears: "Organiser II Comms
Link Server (C) Psion ...". This message is all that is
displayed on the PC until it starts receiving or sending
<a id="p3-4"></a>a file. From this point on, the PC is controlled
from the Organiser.
</p>

<p>
While the Comms Link program is running, the PC
continually sends signals to the Organiser. If you turn
your Organiser off, these signals will turn the
Organiser back on again after a few seconds.
</p>

<h5>On the Organiser:</h5>

<ul class="arrowlist">
<li> Select Comms from the top-level menu.
</li><li> Select Setup from the Comms menu.
</li><li> Press ↓ until → appears next to <span class="code">Protocol</span>.
</li><li> Press → until the Protocol setting is <span class="code">PSION</span>.
</li><li> Press <span class="key">MODE</span> to enter the Setup menu. Select Exit
to return to the Comms menu.
</li></ul>

<p>
<b>This is the only change that needs to be made in
Comms Link's default settings.</b> This is because
PSION protocol and the Comms Link program
automatically match all the other parameters.
</p>

<h4>Selecting the file</h4>

<h5>Selecting whether to send or receive:</h5>

<ul class="arrowlist">
<li> In the Comms menu, simply select Transmit or
Receive. For this example, select Transmit.
</li></ul>

<h5>Selecting the type of file to transfer:</h5>

<p>
Once you've selected either Transmit or Receive, you
are presented with a menu of file types.
</p>

<p>
On models XP and CM this is the menu:
</p>

<p class="indent code">FILE PROCEDURE</p>

<a id="p3-5"></a>
<p>
<span class="code">FILE</span> stands for data file and <span class="code">PROCEDURE</span> for
procedure. These are the two types of file which you
can transfer between the Organiser and the PC.
</p>

<p>
On model LZ these are the menu items:
</p>

<p class="indent code">File Procedure Notes</p>

<p>
<span class="code">Notes</span> stands for Notepad files. <span class="code">Procedure</span> stands
for procedures. <span class="code">File</span> stands for both data files and
Diary Files (but not files from the diary on models XP or
CM). The top line of the display confirms that you are
Transmitting, with PSION protocol.
</p>

<ul class="arrowlist">
<li> For this example, select Procedure.
</li></ul>

<h5>Selecting the source and destination file names:</h5>

<p>
Once you've selected a file type, you are asked for the
name of the file you want to send <b>from the Organiser</b>:
</p>

<p class="indent code">Send A:</p>

<ul class="arrowlist">
<li> Type in the desired procedure name, without the
colon.
</li><li> Press <span class="key">EXE</span> to enter the name.
</li></ul>

<p>
(On model LZ, press ↓ to get a directory list of available
procedures. Use ↑ and ↓ to scan through this list, and
<span class="key">EXE</span> to select the name which the cursor is
highlighting.)
</p>

<p>
Once you've entered a name, you are asked for the
name you want the procedure to have <b>on the PC</b>. As a
default, the same name is offered as that of the
Organiser procedure you're sending.
</p>

<ul class="arrowlist">
<li> To choose a new name, press <span class="key">ON/CLEAR</span> to clear
the suggested name, then type in the new name.
</li></ul>

<a id="p3-6"></a>
<h5>Pathnames</h5>

<p>
If you don't include a pathname, the procedure will be
sent by default to the directory from which you run the
Comms Link program. To specify the pathname:
</p>

<ul>
<li>Use / for \ and % for _ where necessary.
</li></ul>

<p>
For example, <span class="code">/DIRA/TOOLS/PROC%5</span> would create
the file PROC_5.OPL in subdirectory TOOLS of
directory DIRA. During the transmission, Comms Link
automatically adds the PC file type extension .OPL and
translates / and % to \ and _ respectively. (If you do
use the / character, the appropriate directory must
exist on the PC, or you will get a SERVER FAILURE
error when you try to send the file.)
</p>

<h4>Sending the procedure</h4>

<ul class="arrowlist">
<li> Press <span class="key">EXE</span> to enter the name for the procedure file on
the PC.
</li></ul>

<p>
The transfer begins. During the transfer, the Organiser
shows the message 'Sending' with a count of the
blocks so far sent.
</p>

<p>
On completion, the Organiser returns to the prompt:
<span class="code">Send A:</span> - ready for you to enter the name of another
procedure to transmit. The procedure you just sent is
suggested as a default.
</p>

<ul class="arrowlist">
<li> Press <span class="key">ON/CLEAR</span> to clear the default suggestion
and type in the name of another procedure to
transmit.
</li></ul>

<p>
or
</p>

<ul class="arrowlist">
<li> Press <span class="key">ON/CLEAR</span> twice to return to the Comms
menu.
</li></ul>

<a id="p3-7"></a>
<h4>Viewing the received procedure</h4>

<ul class="arrowlist">
<li> On the PC, press Q and then Y to quit the Comms
Link program. (You cannot perform any other
operations on the computer whilst CL is running.)
</li><li> Go to the relevant directory and show its contents.
</li><li> Locate your procedure. Note that it has been given
the extension .OPL.
</li><li> Load the procedure into your usual editor or
wordprocessor. It is a simple (ASCII) text file,
which you could now edit.
</li></ul>

<h4>Receiving a procedure</h4>

<p>
Say you wanted to transfer this procedure back to the
Organiser.
</p>

<ul class="arrowlist">
<li> On the PC, type <span class="code">CL </span>↵ to restart the Comms Link
program.
</li><li> On the Organiser, enter the Comms menu and
select Receive.
</li><li> Select Procedure as the type of file to receive.
</li></ul>

<p>
You are asked for the name you want the procedure to
have <b>on the Organiser</b>:
</p>

<p class="indent code">Receive A:NAME</p>

<p>
The file name you last used is suggested as a default.
(On model LZ, the top line of the display confirms that
you have Chosen to receive a procedure. No directory
list is available by pressing ↓.)
</p>

<ul class="arrowlist">
<li> Enter the desired procedure name.
</li></ul>

<a id="p3-8"></a>
<p>
If you enter the name of a procedure which already
exists on the Organiser, when you press <span class="key">EXE</span> you get
the message:
</p>

<p class="indent code">A:NAME EXISTS
DELETE Y/N</p>

<p>
You would get a similar warning if you tried to send a
procedure to the PC which already existed there.
</p>

<p>
If you pressed N you would return to <span class="code">Receive A:NAME</span>
where you could enter a new name.
</p>

<p>
Once you have entered the name for the procedure on
the Organiser, you are asked for the name of the
procedure <b>on the PC</b> that you want to receive:
</p>

<p class="indent code">From:NAME</p>

<p>
The name you selected for the procedure on the
Organiser is suggested as a default.
</p>

<ul class="arrowlist">
<li> Press <span class="key">ON/CLEAR</span> to enter a different name or <span class="key">EXE</span>
to enter the suggested name. (On model LZ no
directory list is available by pressing ↓.)
</li></ul>

<p>
When you press <span class="key">EXE</span>, a 'Receiving' message is
displayed, with a count of the blocks so far received.
On completion of the file transfer, you are returned to
</p>

<p class="indent code">Receive A:NAME</p>

<p>
for you to choose another procedure to receive.
</p>

<ul class="arrowlist">
<li> Press <span class="key">ON/CLEAR</span> twice to return to the Comms
menu.
</li></ul>

<p>
To see what happened to the procedure, press
<span class="key">ON/CLEAR</span> again and select Prog. Get a directory list.
The name of the received procedure has been added to
the end of the list.
</p>

<a id="p3-9"></a>
<p>
But try to run the received procedure and you will get
a MISSING PROC error. This is because the received
procedure file is a plain text file, which the Organiser
cannot run. To create the object code:
</p>

<ul class="arrowlist">
<li> Select Edit from the Prog menu.
</li><li> Press <span class="key">MODE</span>, select Translate, then Save.
</li><li> Now select Run from the Prog menu.
</li></ul>

<p>
To transfer the object code to the PC, you would have
to write an OPL procedure. See Chapter 8 for details.
</p>

<h3>Transferring other types of files</h3>

<p>
Transferring a data file, an LZ diary file or an LZ
notepad file is as easy as transferring a procedure file.
Simply select the relevant type from the menu
presented after you select Transmit or Receive. From
that point on the transfer process is the same as when
transferring a procedure file, as above.
</p>

<p>
However, on model LZ note that:
</p>

<ul>
<li>You cannot transmit password-protected Notes
files. You will get a BAD NOTES FILE error if you
try. Unprotect the File, as explained in the
Organiser manual, if you do want to send this file.
</li><li>When you select File on model LZ, whether you
transmit a diary or data file depends solely on the
file name you enter - e.g. to transmit a diary file,
select the appropriate diary file name.
</li></ul>

<p>
<b>For all models</b>, the following sections give details of
specific features of the different file types which affect
<a id="p3-10"></a>how you view and write files which are to be
transferred. These notes cover most of the points
which could give you unexpected results.
</p>

<h5>Plain text file</h5>

<p>
All the files that can be transferred with Transmit and
Receive are text files (ASCII) which you can edit in your
usual wordprocessor or editor. However, when you
save one of these files after viewing it, make sure that
it is still in a format acceptable to the Organiser.
</p>

<p>
The file must be a plain text file, with no control
characters (i.e. with ASCII codes less than 32) other
than Reol/Reof sequences (as set in the Setup list - see
the table on page 2-2) and &lt;TAB&gt;s.
</p>

<p>
&lt;TAB&gt;s are received differently by different files:
</p>

<ul>
<li>In procedure files (all models) and LZ notepad files,
&lt;TAB&gt;s are automatically translated to spaces by
Comms Link during transfer.
</li><li>In data files (all models) and LZ diary files, &lt;TAB&gt;s
separate fields within records.
</li></ul>

<h5>Format of data files and LZ diary files</h5>

<p>
Data files consist of a number of <b>records</b> each split
into a number of <b>fields</b>. LZ diary files consist of
records only. Data file records may contain up to 254
characters. LZ diary file records up to 64 characters.
</p>

<p>
<b>Records</b> are separated by &lt;CR&gt; and <b>fields</b> are
separated by &lt;TAB&gt;.
</p>

<p>
So if you want to write a data file on the PC and have it
appear in the usual way on the Organiser, press the
&lt;TAB&gt; key where you use ↓ to make a new line when
<a id="p3-11"></a>entering a record on the Organiser. Then press ↵ to
begin a new record. (Blank lines in the PC's text file are
removed by the Comms Link software: an organiser
record may not be empty.)
</p>

<p>
Alternatively, use Ttrn or Rtrn to translate &lt;TAB&gt;s to a
more convenient character - e.g. a comma.
</p>

<h5>Rtrn, Ttrn</h5>

<p>
To convert &lt;TAB&gt;s (ASCII 9) on the Organiser to
commas (ASCII 44) on the PC and vice versa, set Ttrn
and Rtrn in the Setup list, like this:
</p>

<ul class="arrowlist">
<li> Select Setup from the Comms menu.
</li><li> With ↓ scan down to Rtrn. Press <span class="key">EXE</span> and type:
<span class="code">44,9</span> <span class="key">EXE</span>. This displays as <span class="code">,&lt;HT&gt;</span>.
</li><li> Scan down to Ttrn. Press <span class="key">EXE</span> and type <span class="code">9,44</span>
<span class="key">EXE</span>. This displays as <span class="code">&lt;HT&gt;,</span>.
</li></ul>

<p>
Rtrn and Ttrn replace the first character with the
second. If you enter only one character, it is removed.
Rtrn works on received characters, Ttrn on those to be
transmitted. Their default setting is NONE.
</p>

<h5>Appending</h5>

<p>
If, when receiving a data or LZ diary file to the
Organiser, you select a file name which already exists
on the specified device on the Organiser, you are
presented with this menu:
</p>

<p class="indent code">Erase Append</p>

<p>
<b>Appending</b> an existing file means 'add the contents of
the received file onto the end of the contents of the
existing file'. <b>Erasing</b> an existing file means that the
old file is deleted and the new file takes its place.
</p>

<a id="p3-12"></a>
<p>
You cannot append a file which you send to a PC with
Transmit. (You can if you use the OPL commands
explained in Chapter 8.) You will erase the file unless
you choose another name. You are given a warning
that the file name already exists on the PC.
</p>

<h5>Length of file names</h5>

<p>
File names on the Organiser may be up to 8 alpha-
numeric characters long, and must start with a letter.
</p>

<h5>File extensions</h5>

<p>
Comms Link automatically gives files an extension
during file transfer - .OPL for procedure files, .NTS for
LZ notepad files, .ODB for data and LZ diary files. If
your wordprocessor changes this extension when you
save the file, either:
</p>

<ul class="arrowlist">
<li> Use the Rename command to change the file
extension (see your DOS manual for details).
</li></ul>

<p>
or
</p>

<ul class="arrowlist">
<li> When you Receive the file to the Organiser, include
the new file extension as part of the PC file name,
e.g. at the <span class="code">From:</span> prompt enter <span class="code">fred.txt</span> if <span class="code">.txt</span>
is the extension your wordprocessor adds.
Otherwise you will get a FILE NOT FOUND error.
</li></ul>

<h5>Procedure names</h5>

<p>
When you create a procedure under Prog on the
Organiser, the file name and procedure name are the
same, except that the procedure name has a colon.
</p>

<p>
If you want to write Organiser procedures on a PC,
include the procedure name, with colon, as the first
line of the file. If the file's first line is not recognised by
<a id="p3-13"></a>the Organiser as the procedure name, the <b>file name</b>
given in the Receive is used as the <b>procedure name</b>,
inserted as the first line of the procedure.
</p>

<h5>Error messages on the PC</h5>

<p>
The following error numbers may be reported to the PC
screen during file transfer. Both these errors usually
indicate that the physical connection has broken. The
file transfer is abandoned.
</p>

<table summary="">
<tbody><tr><td width="70">-63</td><td>TIMEOUT</td></tr>
<tr><td>-66</td><td>LINK NOW DISCONNECTED</td></tr>
</tbody></table>

<h3>Further features</h3>

<p>
Comms Link includes features for advanced use:
</p>

<h4>OPL</h4>

<p>
The following types of files cannot be transferred using
Transmit and Receive:
</p>

<ul>
<li>Procedure files (object code)
</li><li>Diary files from models CM and XP
</li><li>Comms Link setup files
</li><li>Pager setup files
</li></ul>

<p>
They can be transferred if you write an appropriate
OPL program. See Chapter 8 for full details.
</p>

<h4>Boot</h4>

<p>
Boot is one of the options in the Comms menu. It will
work only when the Organiser is connected to an IBM
<a id="p3-14"></a>PC/XT/AT or compatible running the supplied
communications program Comms Link.
</p>

<p>
It is used to run Organiser applications, such as MAKE
in the Developer (available as a separate product),
written in the Organiser processor's machine code but
stored as files on the PC. Comms Link is not supplied
with any applications of this type, but the Boot
command provides a 'hook' for applications
(particularly communications applications) to be
provided on floppy disk alone.
</p>

<p>
When you enter the Boot command, Comms Link
prompts for the name of the application to run. The
subsequent behaviour of the command depends upon
the application.
</p>

<p>
If you accidentally enter the Boot command, press
<span class="key">ON/CLEAR</span> to abandon the prompt for the application
name and return to the Comms menu.
</p>

<p>
If you enter a name when you are not connected to a
PC running CL, or if the application does not exist on
the PC, you will get an error message after a few
seconds' wait. You can then press SPACE to return to
the Comms menu.
</p>

<h4>Connecting via modems</h4>

<p>
A typical connection between a computer and an
Organiser via a telephone is illustrated opposite.
</p>

<p>
Modems are necessary to convert the data from the
computer and the Organiser into a form suitable for
transmission over a phone line. The Comms Link cable
needs a modem adaptor to connect to the modem.
</p>

<a id="p3-15"></a>
<p class="indent"><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/commdia3.gif" alt="Connecting via Modems" width="373" height="188"></p>

<p>
An arrangement like this, where the computer is
attached to a modem and a telephone line, at the
office, say, allows you to dial in to the computer from
another telephone and transfer files between the
computer and your Organiser. In this case, you would:
</p>

<ul>
<li>Leave your computer switched on and running the
Comms Link program.
</li><li>Leave the modem connected to your computer in
auto answer mode.
</li></ul>

<p>
Because of the nature of the Comms Link software,
you should ring up the PC from the Organiser, not the
Organiser from the PC. The modem which is connected
to the Organiser may be an 'acoustic coupled modem'
(where the connection to the telephone line is made via
a pair of rubber cups which fit over the telephone
handset) or it may plug directly into a telephone socket.
</p>

<h5>Setting up on the PC</h5>

<p>
At your computer keyboard, run the Comms Link
program as described above, except that when you
come to type
</p>

<p class="indent code">CL ↵</p>

<p>
you must add some extra parameters:
</p>

<p class="indent code">CL [BAUD, PORT, MODE, STRING] ↵</p>

<a id="p3-16"></a>
<p>
where you may omit trailing parameters. Information
about these parameters is provided in the file
'Readme.doc' on your Comms Link disk.
</p>

<p>
The parameters are:
</p>

<dl>
<dt>BAUD
</dt><dd>Selects the baud rate. Options are: 300, 600,
   1200, 2400, 4800 and 9600. 9600 is the default. If
   the modems are operating over a dial-up line, the
   baud rate is likely to be 2400, 1200 or 300.
   <p>
   Remember to set the baud rate in the Setup list on
   the Organiser as well.
   </p>

</dd><dt>PORT
</dt><dd>Selects the serial port: either 1 (the main port) or 2
   (the secondary port). The default is 1. This
   parameter corresponds to the n in the DOS
   command MODE COMn:baud. See your DOS
   manual for details.

</dd><dt>MODE
</dt><dd>Selects the mode of operation:
   <p>
   0 (the default) for direct connection - Comms Link
   immediately attempts to link with the Organiser.
   </p>

   <p>
   1 or 2 should be used when connected to a modem
   in auto-answer mode. When MODE is 1, Comms
   Link waits until DSR is asserted before it attempts
   to link. When MODE is 2, Comms Link waits until
   DCD is asserted before it attempts to link.
   </p>

</dd><dt>STRING
</dt><dd>The STRING parameter specifies one or more
   commands to be sent to the modem before
   <a id="p3-17"></a>proceeding with the link connection. By default, no
   data is sent to the modem. This parameter would
   be used to configure a sophisticated modem (see
   example below). Any backslash character [\] in the
   string is converted to a carriage return [&lt;CR&gt;].
</dd></dl>

<h5>Examples:</h5>

<p>
1  Use the secondary port in a direct connection:
</p>

<p class="indent code">CL 9600,2</p>

<p>
2 Use an auto-answer modem, waiting for Carrier Detect:
</p>

<p class="indent code">CL 1200,1,2</p>

<p>
3 Configure a Hayes command set compatible modem,
resetting the modem and then setting it to auto-answer
after 3 rings:
</p>

<p class="indent code">CL 1200,1,2,ATZ\ATS0=3\</p>

<h5>Setting up on the Organiser</h5>

<p>
In the Setup list on the Organiser, set Hand to
RTS+DTR.
</p>

<p>
(This will work with both direct Connection and via a
modem. But since the Comms Link protocol contains
its own flow control, handshaking is active only in
modem control - so leave Hand at its default value if
you are not using modems.)
</p>

<p>
To configure the modem attached to the Comms Link
cable, either:
</p>

<ul>
<li>Write an OPL procedure (see example program in
Chapter 8)
</li></ul>

<p>
or
</p>

<a id="p3-18"></a>
<ul>
<li>Use terminal emulation (see Chapter 7],
</li></ul>

<h3>File transfer via modems</h3>

<p>
Once the connection via modems is set up, you can
transfer files as if you had a straight hardware
connection - using Transmit and Receive or an OPL
procedure.
</p>

<h3>Single floppy disc drive units</h3>

<p>
On single floppy disk systems, drives A: and B: refer to
the same drive, but with A: and B: representing
different disks. If an access is made to one drive when
the last access was to the other, DOS will prompt you
to change the floppy disk. If you are using the PC as
an unattended server which is connected to an
auto-answer modem, this prompting for a disk change
will lock the server up (as you are not there to press a
key).
</p>

<p>
You can avoid this situation by using the ASSIGN
command before you leave the PC, like this:
</p>

<p class="indent code">ASSIGN B=A</p>

<p>
ASSIGN reroutes all floppy drive references for drive B:
to drive A:.
</p>

<p>
When you issue this command:
</p>

<ul>
<li>Drive A: and not drive B: must be the current
drive.
</li><li>You must assign B: to A:, not A: to B:.
</li></ul>

<p>
See your DOS manual for more details on the ASSIGN
command.
</p>

<hr>

<a id="p4-1"></a>
<a id="p4"></a><h2>
4 Connecting to a
Macintosh
</h2>

<h5>Introduction</h5>

<p>
This Chapter assumes that your Organiser and your
Apple Macintosh have been physically connected as
explained in Chapter 1. This Chapter describes the
process of transferring files between an Organiser and
a Macintosh which is running the supplied Comms
Link software.
</p>

<p>
The advantages of using this software compared to
some other communications program are:
</p>

<ul>
<li>There are fewer communications parameters to set.
</li><li>The communication is based on an error-checked
framing protocol. This means there is only a
negligible chance of receiving corrupted data, even
when using modems over a dial-up line.
</li><li>The advanced protocol allows communication to be
controlled entirely from the Organiser. This means
that you can receive files from an <b>unattended</b>
computer running the Comms Link software.
</li><li>Comms Link provides the basis for advanced
communications applications - e.g. loading
spreadsheet files from your computer (when used
with the Organiser Pocket Spreadsheet).
</li><li><a id="p4-2"></a>You can write OPL programs to run via Comms
Link - e.g. to perform more complex file transfers
or to access remote Files on the Macintosh directly
from the Organiser.
</li></ul>

<h5>Installing Comms Link</h5>

<p>
Before installing Comms Link, make a copy of the disk
in case it becomes corrupted. Keep the original as a
backup and install Comms Link from the copy.
</p>

<p>
Copy the Comms Link folder and the 'SysErrs.Err' file
to either:
</p>

<ul>
<li>The root
</li></ul>

<p>
or
</p>

<ul>
<li>A folder named 'Comms Link' (no other name will
work)
</li></ul>

<p>
on either a floppy or hard disk.
</p>

<p>
When running the Comms Link program from a floppy
disk, you should not remove the floppy disk containing
the Comms Link program at any time.
</p>

<p>
You may find it convenient to make this floppy disk an
operating system disk as well, so that it can run on its
own without your having to keep inserting another
system disk.
</p>

<a id="p4-3"></a>
<h3>Transferring a file</h3>

<p>
The process of transferring a file from the Organiser to
an Apple Macintosh, or vice versa, is extremely
straightforward, because:
</p>

<ul>
<li>A minimum of preparation is required once you
have physically plugged the two machines together.
</li><li>The transfer itself involves nothing more than
selecting items from menus and typing in
appropriate file names.
</li></ul>

<p>
This section uses the example of sending a procedure
file from the Organiser to the Macintosh, and then
receiving it back to the Organiser. The easiest way to
get familiar with Comms Link is probably to follow this
example through, and then experiment with
transmitting and receiving different types of files.
</p>

<h4>Starting up</h4>

<h5>On the Macintosh:</h5>

<ul class="arrowlist">
<li> Simply start up the Comms Link program by
double clicking on the Comms Link icon. The
program display appears.
</li></ul>

<p>
For normal file transfers, this is all the preparation
necessary on the Macintosh.
</p>

<p>
The menu items along the top of the display are
explained in full in a later section of this Chapter. The
only item you need to use frequently is Quit, in the File
menu. To select this item:
</p>

<ul class="arrowlist">
<li> Pull down the File menu.
</li><li><a id="p4-4"></a> Move the pointer to Quit. When it is highlighted,
click.
</li></ul>

<p>
Alternatively, just click in the 'close' box at the top left
of the Comms Link window.
</p>

<p>
The Organiser assumes that you have plugged the
Comms Link lead (via the adaptor) into the modem
port. If you used the printer port instead, either:
</p>

<ul class="arrowlist">
<li> Disconnect Comms Link from the printer port and
reconnect it into the modem port.
</li></ul>

<p>
or
</p>

<ul class="arrowlist">
<li> Pull down the Setup menu on the Macintosh and
select the 'Printer port' item (the ✓ sign confirms
the selection). Then pull down the File menu and
select 'Save'.
</li></ul>

<h5>On the Organiser:</h5>

<ul class="arrowlist">
<li> Select Comms from the top-level menu.
</li><li> Select Setup from the Comms menu.
</li><li> Press ↓ until → appears next to <span class="code">Protocol</span>.
</li><li> Press → until the Protocol setting is <span class="code">PSION</span>.
</li><li> Press <span class="key">MODE</span> to enter the Setup menu. Select Exit
to return to the Comms menu.
</li></ul>

<p>
<b>This is the only change that needs to be made to
Comms Link's default settings.</b> This is because
PSION protocol and the Comms Link program on the
Macintosh automatically match all the other
parameters.
</p>

<a id="p4-5"></a>
<h4>Selecting the file</h4>

<h5>Selecting whether to send or receive:</h5>

<ul class="arrowlist">
<li> In the Comms menu, simply select Transmit or
Receive. For this example, select Transmit.
</li></ul>

<h5>Selecting the type of file to transfer:</h5>

<p>
Once you've selected either Transmit or Receive, you
are presented with a menu of file types.
</p>

<p>
On models XP and CM this is the menu:
</p>

<p class="indent code">FILE PROCEDURE</p>

<p>
<span class="code">FILE</span> stands for data file and <span class="code">PROCEDURE</span> for
procedure. These are the two types of file which you
can transfer between the Organiser and the Macintosh.
</p>

<p>
On model LZ these are the menu items:
</p>

<p class="indent code">File Procedure Notes</p>

<p>
<span class="code">Notes</span> stands for Notepad files. <span class="code">Procedure</span> stands
for procedures. <span class="code">File</span> stands for both data files and
Diary files (but not files from the diary on models XP or
CM). The top line of the display confirms that you are
Transmitting, with PSION protocol.
</p>

<ul class="arrowlist">
<li> For this example, select Procedure.
</li></ul>

<h5>Selecting the source and destination file names:</h5>

<p>
Once you've selected a file type, you are asked for the
name of the file you want to send <b>from the Organiser</b>.
</p>

<p class="indent code">Send A:</p>

<ul class="arrowlist">
<li> Type in the desired  procedure name, without the
colon.
</li><li><a id="p4-6"></a>Press <span class="key">EXE</span> to enter the name.
</li></ul>

<p>
(On model LZ, press ↓ to get a directory list of available
procedures. Use ↑ and ↓ to scan through this list, and
<span class="key">EXE</span> to select the name that the cursor is highlighting.
</p>

<p>
Once you've entered a name, you are asked for the
name you want the procedure to have on the
Macintosh. As a default, the same name is offered as
that of the Organiser procedure you're sending.
</p>

<ul class="arrowlist">
<li> To choose a new name, press <span class="key">ON/CLEAR</span> to clear
the suggested name, then type in the new name.
</li></ul>

<h5>Folders</h5>

<p>
If you don't specify the folder to which you want the
procedure to be sent, it will be sent by default to the
folder from which you ran the Comms Link program.
To specify drive and folder:
</p>

<ul>
<li>Separate drive name from folder name with a
colon, :
</li><li>Separate folder name from procedure name (or
another folder name) with the / character.
</li><li>Use % for the _ character.
</li></ul>

<p>
For example, <span class="code">HDISK:TOOLS/PROC%5</span> would create
the file PROC_5.OPL in the TOOLS folder on drive
HDISK. During the transmission, Comms Link
automatically adds the file type extension .OPL and
translates / and % to \ and _ respectively.
</p>

<p>
If you do use the / character, the appropriate folder
must exist on the Macintosh, or you will get a SERVER
FAILURE error when you try to send the file. For the
limit on how many folders can be nested inside each
other see your Macintosh documentation. The whole
<a id="p4-7"></a>name, including drive and folder names, must be no
longer than 32 characters in order to be accepted by
the Organiser.
</p>

<p>
<b>NB: on 'flat file' disk systems you cannot specify
drive and folder.</b> Files can be sent to or accessed from
only the top-level folder of the drive from which
Comms Link is being run.
</p>

<h4>Sending the procedure</h4>

<ul class="arrowlist">
<li> Press <span class="key">EXE</span> to enter the name for the procedure on
the Macintosh.
</li></ul>

<p>
The transfer begins. During the transfer, the Organiser
shows the message 'Sending', with a count of the
blocks so far sent.
</p>

<p>
On completion, the Organiser returns to the prompt:
<span class="code">Send A:</span> - ready for you to enter the name of another
procedure to transmit. The procedure you just sent is
suggested as a default.
</p>

<ul class="arrowlist">
<li> Press <span class="key">ON/CLEAR</span> to clear the default suggestion
and type in the name of another procedure to send.
</li></ul>

<p>
or
</p>

<ul class="arrowlist">
<li> Press <span class="key">ON/CLEAR</span> twice to return to the Comms
menu.
</li></ul>

<h4>Viewing the received procedure</h4>

<p>
To view the received procedure, on the Macintosh:
</p>

<ul class="arrowlist">
<li> Close the Comms Link application by clicking in
the corner box, or by selecting Quit from the File
menu.
</li><li><a id="p4-8"></a>Go to the folder where you sent the procedure. An
icon has been added, with the name you gave the
file, plus the file type extension (.OPL) added by
Comms Link.
</li><li> Load the procedure into your wordprocessing
package.
</li></ul>

<p>
If you click on the procedure file icon you will probably
get a message saying that no application can be found
to open the document. So enter the wordprocessor
package first and then load the procedure in. It is a
simple text file, which you could now edit.
</p>

<h4>Receiving a procedure</h4>

<p>
Say you wanted to transfer this procedure back to the
Organiser.
</p>

<ul class="arrowlist">
<li> On the Macintosh, double click on the Comms
Link icon to restart the program.
</li><li> On the Organiser, enter the Comms menu and
select Receive.
</li><li> Select Procedure as the type of file to receive.
</li></ul>

<p>
You are asked for the name you want the procedure to
have <b>on the Organiser</b>: <span class="code">Receive A:NAME</span>. The file
name you last used is suggested as a default. (On
model LZ, the top line of the display confirms that you
have chosen to receive a procedure. No directory list is
available by pressing ↓.)
</p>

<ul class="arrowlist">
<li> Enter the desired procedure name.
</li></ul>

<p>
If you enter the name of a procedure which already
exists on the Organiser, when you press <span class="key">EXE</span> you get
the message:
</p>

<a id="p4-9"></a>
<p class="indent code">A:NAME EXISTS
DELETE Y/N</p>

<p>
You would get the same warning if you tried to send a
procedure to the Macintosh which already existed
there.
</p>

<p>
If you pressed N you would return to <span class="code">Receive A:NAME</span>
where you could enter a new name.
</p>

<p>
Once you have entered the name for the procedure on
the Organiser, you are asked for the name of the
procedure <b>on the Macintosh</b> that you want to receive:
</p>

<p class="indent code">From:NAME</p>

<p>
The name you selected for the procedure on the
Organiser is suggested as a default.
</p>

<ul class="arrowlist">
<li> Press <span class="key">ON/CLEAR</span> to enter a different name or <span class="key">EXE</span>
to enter the suggested name. (On model LZ no
directory list is available by pressing ↓.)
</li></ul>

<p>
When you press <span class="key">EXE</span>, a 'Receiving' message is
displayed, with a count of the blocks so far received.
On completion of the file transfer, you are returned to
</p>

<p class="indent code">Receive A:NAME</p>

<p>
for you to choose another procedure to receive.
</p>

<ul class="arrowlist">
<li> Press <span class="key">ON/CLEAR</span> twice to return to the Comms
menu.
</li></ul>

<p>
To see what happened to the procedure, press
<span class="key">ON/CLEAR</span> again and select Prog. Get a directory list.
The name of the received procedure has been added to
the end of the list.
</p>

<p>
But try to run the received procedure and you will get
a MISSING PROC error. This is because the received
<a id="p4-10"></a>procedure file is a plain text file, which the Organiser
cannot run. To create the object code:
</p>

<ul class="arrowlist">
<li> Select Edit from the Prog menu.
</li><li> Press <span class="key">MODE</span>, select Translate, then Save.
</li><li> Now select Run from the Prog menu.
</li></ul>

<p>
To send the object code to the Macintosh, you will have
to write an OPL procedure. See Chapter 8 for details,
</p>

<h3>Transferring other types of files</h3>

<p>
Transferring a data file, an LZ diary file or an LZ
notepad file is as easy as transferring a procedure file.
Simply select the relevant type from the menu
presented after you select Transmit or Receive. From
that point on the transfer process is the same as when
transferring a procedure file, as above.
</p>

<p>
However, on model LZ note that:
</p>

<ul>
<li>You cannot transmit password-protected Notes
files. You will get a BAD NOTES FILE error if you
try. Unprotect the file, as explained in the
Organiser manual, if you do want to send this file.
</li><li>When you select File on model LZ, whether you
transmit a diary or data file depends solely on the
file name you enter - e.g. to transmit a diary file,
select the appropriate diary file name.
</li></ul>

<p>
<b>For all models</b>, the following sections give details of
specific features of the different file types which affect
how you view and write files which are to be
<a id="p4-11"></a>transferred. These notes cover most of the points
which could give you unexpected results.
</p>

<h5>Plain text file</h5>

<p>
All the tiles that can be transferred with Transmit and
Receive are text files (ASCII) which you can edit in your
usual wordprocessor or editor. However, when you
save one of these files after viewing it, make sure that
it is still in a format acceptable to the Organiser.
</p>

<p>
The file must be a plain text file, with no control
characters (i.e. with ASCII codes less than 32) other
than Reol/Reof sequences (as set in the Setup list - see
the table on page 2-2) and &lt;TAB&gt;s.
</p>

<p>
&lt;TAB&gt;s are received differently by different files:
</p>

<ul>
<li>In procedure files (all models] and LZ notepad files,
&lt;TAB&gt;s are automatically translated to spaces by
Comms Link during transfer.
</li><li>In data files (all models) and LZ diary files, &lt;TAB&gt;s
separate fields within records.
</li></ul>

<h5>Format of data files and LZ diary files</h5>

<p>
Data files consist of a number of <b>records</b> each split
into a number of <b>fields</b>. LZ diary files consist of
records only. Data file records may contain up to 254
characters. LZ diary file records up to 64 characters.
</p>

<p>
<b>Records</b> are separated by &lt;CR&gt; and <b>fields</b> are
separated by &lt;TAB&gt;.
</p>

<p>
So if you want to write a data file on the Macintosh
and have it appear in the usual way on the Organiser,
press the &lt;TAB&gt; key where you use ↓ to make a new
line when entering a record on the Organiser. Then
<a id="p4-12"></a>press ↵ to begin a new record. (Blank lines in the
Macintosh text file are removed by the Comms Link
software; an Organiser record may not be empty.)
</p>

<p>
Alternatively, use Ttrn or Rtrn to translate &lt;TAB&gt;s to a
more convenient character - e.g. a comma.
</p>

<h5>Rtrn, Ttrn</h5>

<p>
To convert &lt;TAB&gt;s (ASCII 9) on the Organiser to
commas (ASCII 44) on the Macintosh and vice versa,
set Ttrn and Rtrn in the Setup list, like this:
</p>

<ul class="arrowlist">
<li> Select Setup from the Comms menu.
</li><li> With ↓ scan down to Rtrn. Press <span class="key">EXE</span> and type:
<span class="code">44,9</span> <span class="key">EXE</span>. This displays as <span class="code">,&lt;HT&gt;</span>.
</li><li> Scan down to Ttrn, Press <span class="key">EXE</span> and type <span class="code">9,44</span>
<span class="key">EXE</span>. This displays as <span class="code">&lt;HT&gt;,</span>.
</li></ul>

<p>
Rtrn and Ttrn replace the first character with the
second. If you enter only one character, it is removed.
Rtrn works on received characters, Ttrn on those to be
transmitted. Their default setting is NONE - no
translation occurs.
</p>

<h5>Appending</h5>

<p>
If, when receiving a data or LZ diary file to the
Organiser, you select a file name which already exists
on the specified device on the Organiser, you are
presented with this menu:
</p>

<p class="indent code">Erase Append</p>

<p>
<b>Appending</b> an existing file means 'add the contents of
the received file onto the end of the contents of the
existing file'. <b>Erasing</b> an existing file means that the
old file is deleted and the new the takes its place.
</p>

<a id="p4-13"></a>
<p>
You cannot append a file which you send to a
Macintosh with Transmit. (You can if you use the OPL
commands explained in Chapter 8.) You will erase the
file unless you choose another name. You are given a
warning that the tile name already exists on the
Macintosh.
</p>

<h5>Length of file names</h5>

<p>
File names on the Organiser may be up to 8
alphanumeric characters long, and must start with a
letter.
</p>

<h5>File extensions</h5>

<p>
Comms Link automatically gives files an extension
during file transfer - .OPL for procedure files, .NTS for
LZ notepad files, .ODB for data and LZ diary files. If
your wordprocessor changes this extension when you
save the file, either:
</p>

<ul class="arrowlist">
<li> Change the file extension on the Macintosh before
beginning the file transfer.
</li></ul>

<p>
or
</p>

<ul class="arrowlist">
<li> When you Receive the file to the Organiser, include
the new file extension as part of the Macintosh file
name, e.g. at the <span class="code">From:</span> prompt enter <span class="code">fred.txt</span>
if <span class="code">.txt</span> is the extension your wordprocessor adds.
Otherwise you will get a FILE NOT FOUND error.
</li></ul>

<h5>Procedure names</h5>

<p>
When you create a procedure under Prog on the
Organiser, the file name and procedure name are the
same, except that the procedure name has a colon.
</p>

<a id="p4-14"></a>
<p>
If you want to write Organiser procedures on a
Macintosh, include the procedure name, with colon, as
the first line of the file. If the file's first line is not
recognised by the Organiser as the procedure name,
the <b>file name</b> given in the Receive is used as the
<b>procedure name</b>, inserted as the first line of the
procedure.
</p>

<h5>Error messages on the Macintosh</h5>

<p>
The following error numbers may be reported to the
Macintosh screen during file transfer. Both these
errors usually indicate that the physical connection
has broken. The file transfer is abandoned.
</p>

<table summary="">
<tbody><tr><td width="70">-63</td><td>TIMEOUT</td></tr>
<tr><td>-66</td><td>LINK NOW DISCONNECTED</td></tr>
</tbody></table>

<h3>Further features</h3>

<p>
Comms Link includes features for advanced use:
</p>

<h4>OPL</h4>

<p>
The following types of files cannot be transferred using
Transmit and Receive:
</p>

<ul>
<li>Procedure files (object code)
</li><li>Diary files from models CM and XP
</li><li>Comms Link setup files
</li><li>Pager setup files
</li></ul>

<p>
They can be transferred if you write an appropriate
OPL program. See Chapter 8 for full details.
</p>

<a id="p4-15"></a>
<h4>Boot</h4>

<p>
Boot is one of the options in the Comms menu. It is
designed to run applications written in the Organiser
processor's machine code but stored as files on the
other computer. Comms Link is not supplied with any
applications of this type.
</p>

<p>
If you accidentally enter the Boot command, press
<span class="key">ON/CLEAR</span> to abandon the prompt for the application
name and return to the Comms menu.
</p>

<h3>Connecting to the Macintosh via modems</h3>

<p>
A typical connection between a computer and an
Organiser via a telephone is illustrated below.
</p>


<p class="indent"><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/commdia3.gif" alt="Connecting via Modems" width="373" height="188"></p>

<p>
Modems are necessary to convert the data from the
computer and the Organiser into a form suitable for
transmission over a telephone line. The Comms Link
cable requires a modem adaptor to connect to the
modem.
</p>

<p>
An arrangement like this, where the computer is
attached to a modem and a telephone line, say, at the
<a id="p4-16"></a>office, allows you to dial in to the computer from
another telephone and transfer files between the
computer and your Organiser.
</p>

<p>
<b>Because of the nature of the Comms Link software,
you should always ring up the Macintosh from the
Organiser.</b> In this case, you should:
</p>

<ul>
<li>leave your Macintosh switched on and running
the Comms Link application.
</li><li>Leave the modem connected to your Macintosh in
auto-answer mode.
</li></ul>

<p>
The modem which is connected to the Organiser may
be an acoustic coupled modem (where the connection
to the telephone line is made via a pair of rubber cups
which fit over the telephone handset) or it may plug
directly into a telephone socket.
</p>

<h5>Setting up on the Macintosh</h5>

<p>
The Comms Link application contains the following
pull-down options:
</p>

<table summary="">
<tbody><tr><th width="70">Dial</th><td>Lets you send commands to a modem.</td></tr>
<tr><th>Setup</th><td>A list of communications parameters.</td></tr>
<tr><th>File</th><td>Various options</td></tr>
</tbody></table>

<h5>File</h5>

<dl>
<dt>Revert to saved
</dt><dd>Changes parameter settings used in
   communication to those in the Saved Setup list.

</dd><dt>Save
</dt><dd>Saves current parameter settings.

</dd><dt><a id="p4-17"></a>Drive
</dt><dd>Changes the current drive.

</dd><dt>Eject
</dt><dd>Ejects disk currently inserted.

</dd><dt>Quit
</dt><dd>Quits Comms Link application.
</dd></dl>

<h5>Setup</h5>

<p>
'Revert to saved' and 'Save' in the File option refer to
the list contained in the Setup option. To change one
of the settings in this list:
</p>

<ul class="arrowlist">
<li> Pull down the Setup menu.
</li><li> Highlight the setting you want, and click to select
it.
</li><li> Pull down the File menu and select Save;
alternatively press Command-S.
</li></ul>

<p>
<b>Changes made to the Setup list are not actually
implemented until the list has been Saved.</b>
</p>

<p>
<b>Only one Setup list can be saved at a time.</b> The
Setup last saved is the Setup which you are returned
to when you start up the Comms Link program again
after a break.
</p>

<h5>Setup for connecting to a modem:</h5>

<ul class="arrowlist">
<li> Set the PORT parameter on the Macintosh to
Modem.
</li><li> Change BAUD to suit the modem you're using. If
the modems are operating over a dial-up line, the
baud rate is likely to be 2400, 1200, or 300.
</li><li><a id="p4-18"></a>HAND parameter - try setting to RTS+DTR
(RTS/CTS handshaking + DTR/DSR handshaking]
</li><li> On the Organiser, set Baud and Hand to match
the settings on the Macintosh.
</li></ul>

<p>
RTS/CTS handshaking is suitable for use with an
auto-answer modem, with the DCD pin of the modem
connected to the CTS pin of the Macintosh. On the
Organiser, RTS/CTS stops Comms Link from
transmitting any data until the modem attached to the
Macintosh detects an incoming call. (RTS+DTR will
also work in direct connection, but the PSION protocol
actually ignores the Hand setting.)
</p>

<h5>Dial</h5>

<p>
The DIAL facility is used to configure a modem from
the Macintosh - e.g. to prepare it to auto-answer.
Whilst running the Comms Link program, this is your
means of communicating with an attached modem:
</p>

<ul class="arrowlist">
<li> Pull down the Setup menu. Select 'Set Dial
string...'. Type in the dial string and select 'OK'.
</li><li> Pull down the File menu and select 'Save'.
</li><li> Pull down the Dial menu and select 'Dial'.
</li></ul>

<p>
A 'Sending dial string...' message is displayed while the
string is sent to the modem. It is sent regardless of any
handshaking in use.
</p>

<p>
All the characters available on your keyboard can be
typed in directly (upper and lower case are ignored).
</p>

<a id="p4-19"></a>
<ul>
<li>To send control characters - those with ASCII
codes less than 32 - put a $ character
immediately before the letter whose number in the
alphabet corresponds to the relevant ASCII code
for the character you want to send.
</li></ul>

<p>
E.g. to send ATD237&lt;CR&gt; set the dial string to
<span class="code">ATD237$13</span>
</p>

<ul>
<li>To send ASCII 0, use <span class="code">$@</span>.
</li><li>To send ASCII 27 to 31 use <span class="code">$[</span>, <span class="code">$\</span>, <span class="code">$]</span>, <span class="code">$^</span> and <span class="code">$_</span>
respectively.
</li><li>&amp; sends ASCII 13 (a carriage return] and also
causes a delay, until no characters are received
over a certain period. This is about half a second
at 9600 baud, a second at 4800 baud, and so on.
</li><li><span class="code">$$</span> sends a $, and <span class="code">$&amp;</span> sends &amp; - as literal strings,
not their assigned functions.
</li></ul>

<p>
Remember to Save the Macintosh Setup whenever you
change the handshaking, the port or the dial string.
</p>

<h5>Setting up on the Organiser</h5>

<p>
Remember to change the Setup list on the Organiser
every time you change the setup on the Macintosh.
</p>

<p>
To configure the modem attached to the Organiser,
either:
</p>

<ul>
<li>Write an OPL procedure (see example program in
Chapter 8)
</li></ul>

<p>
or
</p>

<ul>
<li>Use terminal emulation (see Chapter 7).
</li></ul>

<a id="p4-20"></a>
<h5>File transfer</h5>

<p>
Once the connection via modems is set up, you can
transfer files as if you had a straight hardware
connection - using Transmit and Receive or an OPL
procedure.
</p>

<hr>

<a id="p5-1"></a>
<a id="p5"></a><h2>
5 Connecting to
any other
computer
</h2>

<p>
<b>Before reading this chapter</b> you should have read
Chapters 1 and 2, which explain how to fit the Comms
Link cable and about the setting of communications
parameters. This chapter describes how Comms Link
may be used to connect to any computer which has an
RS232 port.
</p>

<p>
Apple Macintoshes and the IBM PC/XT/AT and
compatibles fall into this category, and everything in
this Chapter does apply to these computers. However,
you are much better off using the supplied Comms
Link software, as described in Chapters 3 and 4.
</p>

<h4>Requirements</h4>

<p>
Before you can transfer files between your computer
and the Organiser, you will need communications
software for your computer. This software should
support one or preferably both of the following services:
</p>

<ul>
<li>Terminal emulation with the ability to upload and
capture ASCII files
</li><li>XMODEM file transfer.
</li></ul>

<p>
These services may be provided by a specialised
communications program or as part of an integrated
software package.
</p>

<a id="p5-2"></a>
<p>
Instead of terminal emulation, you may be able to
configure the serial port and then copy to and from it
using the operating system commands - if your
operating system is sufficiently advanced.
</p>

<h3>Establishing the connection</h3>

<p>
There are no standard settings across the different
types of computers. Therefore Comms Link's default
parameter settings may not be correct for your
computer, though there is a chance that they are.
</p>

<p>
It is not possible for this manual to give specific details
for every make of computer. Instead, this Chapter gives
general information, which will be sufficient provided
that you have a reasonable knowledge of your other
computer.
</p>

<p>
There are two ways to find out what parameter settings
you need:
</p>

<ol type="i">
<li>Work out from your other computer manual and
the information on parameters given below what
settings are likely to give a match. Then, using
Term from the Comms menu, test the connection
with these settings.
</li><li>Select Auto from the Comms menu. Then use
Term from the Comms menu to test the settings
suggested by Auto.
</li></ol>

<p>
Once you have determined the correct settings, it is
recommended that you Save your Setup, to a pack if
possible, as explained in Chapter 2. You then have a
backup in case you wish to experiment with some
<a id="p5-3"></a>other settings or in case the Setup list gets reinitialised
(in one of the circumstances listed in Chapter 2).
</p>

<p>
When the connection is working, continue with the
section 'Transferring files'.
</p>

<p>
On the following pages information is given on:
</p>
<ul>
<li>Term
</li><li>Auto
</li><li>Handshaking (Hand parameter)
</li><li>Other parameters which may need changing for
your computer.
</li></ul>

<h4>Term</h4>

<ul class="arrowlist">
<li> Run the communications program on the other
computer, as described in its user documentation.
</li><li> Match the settings of the communications
parameters in this program with those in the
Setup list on the Organiser.
</li><li> Then on the other computer enter terminal mode
(or its equivalent).
</li><li> On the Organiser select Term from the Comms
menu. This is the Organisers terminal mode.
</li><li> Once the screen is ready, type a few characters at
each end of the connection and see if they are
appearing correctly on the screen of the other
machine.
</li></ul>

<p>
If this is not the case, some of the communications
parameters are set incorrectly.
</p>

<a id="p5-4"></a>
<h4>Auto</h4>

<p>
Auto works by sending to the other computer a line of
text under first one combination of parameters, then
another, then another. The line of text that is sent is a
message stating what the parameter settings were for
that text transmission.
</p>

<p>
So if the text actually gets printed on the screen
without corruption you know that the settings which
are displayed are the correct ones to use.
</p>

<ul class="arrowlist">
<li> On the other computer, enter terminal mode.
</li><li> On the Organiser, select Auto from the Comms
menu.
</li></ul>

<p>
Auto immediately begins transmitting. The Organiser
display continuously shows the combination of
parameters which is currently being sent. Auto
continues until every combination has been tried,
when you are returned to the Comms menu.
</p>

<ul class="arrowlist">
<li> When you are satisfied that you have the correct
parameter values, press <span class="key">ON/CLEAR</span> to abandon
Auto and return to the Comms menu.
</li><li> Select Setup and make the relevant changes to the
list.
</li><li> Exit the Setup list. Start the file transfer process.
</li></ul>

<p>
More than one set of values may be printed correctly
on your computer screen. Try the connection with
each of them in turn.
</p>

<p>
Auto works out only the Baud, Parity, Bits and Stop
parameters. For full details of the last three of these,
see Appendix C of this manual.
</p>

<a id="p5-5"></a>
<p>
If Auto falls to print any correct parameter settings, it
is probably because Hand is set incorrectly. In this
case, either:
</p>

<ul class="arrowlist">
<li> Try a different handshaking and run Auto again.
</li></ul>

<p>
or
</p>

<ul class="arrowlist">
<li> Try a different handshaking and test it with Term.
</li></ul>

<h4>Handshaking</h4>

<p>
Which type of handshaking is suitable is determined
largely by the computer you are connecting to and the
communications software you are running. XON/XOFF
handshaking is ignored by XMODEM (and PSION)
protocol.
</p>

<p>
A quick way to test whether the handshaking you are
using is correct is to:
</p>

<ul class="arrowlist">
<li> Change Echo to LOCAL in the Setup list.
</li><li> Enter Term, type a few characters, and see
whether anything appears on the Organiser
screen.
</li></ul>

<p>
Because <b>all</b> characters transmitted in Term are
displayed on the Organiser screen when Echo is
LOCAL, you know that if no characters are displayed
your handshaking must be wrong.
</p>

<h4>Other parameters to check</h4>

<table summary="">
<tbody><tr><th width="110">Protocol</th><td><b>XMODEM</b> protocol includes checksum
            error checking, which is a significant
            advantage when the transfer occurs
            over dial-up lines. It can only be used
            <a id="p5-6"></a>if your communications program also
            supports XMODEM file transfer. If so,
            check that you use checksum not
            CRC error checking.
            <p>
            <b>NONE</b> (the default setting) provides a
            more primitive file transfer with no
            error checking.
            </p>
            <p>
            (<b>PSION</b> protocol works only with the
            Comms Link software, which runs only
            on IBM PC/XT/ATs and Compatibles
            or on Apple Macintoshes)</p></td></tr>

<tr><th>Reof, Teof</th><td>The default setting - &lt;SUB&gt; (ASCII 26)
            - is probably correct for your
            computer. NONE for both Reof and
            Teof may be appropriate for file
            transfers under XMODEM protocol.</td></tr>
<tr><th>Reol, Teol</th><td>If the lines in text files on your
            computer do not end with &lt;CR&gt;&lt;LF&gt;,
            lines on that computer will not match
            up with lines on the Organiser. Change
            Reol and Teol to correct this.</td></tr>
</tbody></table>

<h3>Transferring files</h3>

<h4>Overview</h4>

<p>
Once you have established basic communications
between the Organiser and the computer, you can
transfer files between the two.
</p>

<p>
On the Organiser, the transfer involves nothing more
than selecting items from menus and typing in
appropriate file names. This makes it very
straightforward.
</p>

<a id="p5-7"></a>
<p>
On the other computer, you prepare either to receive or
transmit, with the commands which that computer
uses - e.g. transmit might be called Send.
</p>

<p>
Whether you prepare the receiving or transmitting
computer first depends on how you set Protocol.
</p>

<ul>
<li>If Protocol is set to NONE, always prepare the
<b>receiving</b> computer first.
</li><li>If Protocol is set to XMODEM, prepare the
computers in whichever order you want.
</li></ul>

<p>
If you don't transfer in the right order, part of the
beginning of the file may be lost.
</p>

<p>
On models CM and XP you can transfer:
</p>

<ul>
<li>Data files
</li><li>Procedure files
</li></ul>

<p>
On model LZ you can transfer:
</p>

<ul>
<li>Data files
</li><li>Diary files (but not CM or XP diary files)
</li><li>Procedure files
</li><li>Notepad files
</li></ul>

<p>
<b>On all models, you can transfer only text files</b>. You
need PSION protocol to transfer other types of files,
and this will work only on Apple Macintoshes and the
IBM PC/XT/AT and compatibles.
</p>

<p>
Before proceeding with this Chapter, if you have any
doubts about receiving and sending a file from your
other computer, see the relevant file transfer
documentation.
</p>

<a id="p5-8"></a>
<h4>Selecting the file name on the Organiser</h4>

<h5>Selecting whether to transmit or receive:</h5>

<ul class="arrowlist">
<li> Enter the Comms menu on the Organiser.
</li><li> Select either Transmit or Receive.
</li></ul>

<h5>Selecting the type of file:</h5>

<p>
Once you have selected either to transmit or receive,
you are asked for the type of file. On models CM and
XP this is the menu presented:
</p>

<p class="indent code">FILE PROCEDURE</p>

<p>
Select <span class="code">FILE</span> to send a data file, <span class="code">PROCEDURE</span> to send a
procedure.
</p>

<p>
On model LZ the top line of the display confirms your
choice of Transmit and Receive, and which Protocol
you are using. The menu of file types is like this:
</p>

<p class="indent code">File Procedure Notes</p>

<p>
Select <span class="code">File</span> to send a data or LZ diary file. Select
<span class="code">Procedure</span> to send a procedure. Select <span class="code">Notes</span> to
send a Notepad file.
</p>

<h5>Selecting source/destination file name:</h5>

<p>
Once you have selected a file type, you are prompted
for the name of the file you wish to transfer:
</p>

<p class="indent code">Send A:</p>

<p>
or
</p>

<p class="indent code">Receive A:</p>

<a id="p5-9"></a>
<ul class="arrowlist">
<li> Enter the appropriate file name. The name must
be no longer than 8 characters and must start
with a letter.
</li></ul>

<p>
If you have already transferred some files, the name of
the last file you transferred will be given as a default.
</p>

<p>
(On model LZ, the top line confirms your choice of file
type. When you are transmitting, pressing ↓ gives you
a directory list of available files.)
</p>

<h4>The transmission</h4>

<p>
How the transmission sequence proceeds depends on
which Protocol you are using.
</p>

<h5>Protocol set to NONE<br>(prepare receiving computer first)</h5>

<p>
<b>When receiving to the Organiser</b>
</p>

<ul class="arrowlist">
<li> Enter the file name on the Organiser.
   <p>
   The Organiser merely waits once it has accepted
   the destination file name, displaying a 'Waiting for
   data' message.
   </p>

</li><li> Enter the 'Send file' command on the other
computer. The transfer begins.

   <p>
   The received data is displayed on the Organiser
   screen at the same time as it is saved. At the
   higher baud rates this will not be readable, but it
   does let you know that data transfer is going
   ahead.
   </p>
</li></ul>

<p>
<b>When transmitting from the Organiser</b>
</p>

<ul class="arrowlist">
<li> Enter the 'Receive file' command on the other
  computer.
   <a id="p5-10"></a><p>
     The other computer should simply wait while you
     prepare the Organiser.
   </p>

</li><li> On the Organiser select Transmit, then the file
  type and enter the file name.

   <p>
     When you press <span class="key">EXE</span> the transfer begins. During
     the transfer the transmission data is displayed on
     the Organiser screen, but may or may not be
     displayed on the other computer's screen.
   </p>
</li></ul>

<p>
After the transfer has completed - whether you were
transmitting or receiving on the Organiser - you are
returned to the prompt:
</p>

<p class="indent code">Send A:</p>

<p>
or
</p>

<p class="indent code">Receive A:</p>

<p>
for you to select another file to transfer.
</p>

<h3>Protocol set to XMODEM<br>(prepare either computer first)</h3>

<p>
With this protocol, the computer you set first simply
waits whilst the other computer is prepared - either to
transmit or receive.
</p>

<p>
On the Organiser a 'Connecting...' message is
displayed when the file name on the Organiser has
been accepted, whether you are receiving or
transmitting.
</p>

<p>
Then, when you have prepared the other computer, or
immediately if it was already prepared, a message
shows that the transfer is going ahead:
</p>

<a id="p5-11"></a>
<p class="indent code">Receiving block nn</p>

<p>
or
</p>

<p class="indent code">Sending block nn</p>

<p>
where <span class="code">nn</span> indicates the number of blocks successfully
received or transmitted.
</p>

<p>
If all goes well, the block count will steadily increase,
until a 'Receive OK' or 'Send OK' message is displayed.
Then press any key to exit the completed transfer
procedure.
</p>

<ul>
<li>Pressing <span class="key">ON/CLEAR</span> at any time during the
  transfer abandons it, saving all the information so
  far received.
</li></ul>

<p>
You can use this to end the transfer if the
communications program on the other computer
cannot be set to send an Reof character. In that case
the computers would hang if you didn't do this.
</p>

<p>
The following XMODEM error messages may be shown:
</p>

<table summary="">
<tbody><tr><td width="150">Error in nn</td><td>An error was detected while
               receiving block nn.</td></tr>
<tr><td>Duplicate nn</td><td>Received a duplicate of a block
               already received.</td></tr>
<tr><td>Failed in nn</td><td>A fatal error was detected.</td></tr>
<tr><td>Resending nn</td><td>Resending an unacknowledged
               block.</td></tr>
</tbody></table>

<p>
The other computer display may provide further details
of any failure.
</p>

<a id="p5-12"></a>
<h3>Transferring different types of files</h3>

<p>
Once you have selected the relevant file type from the
menu presented after the Transmit/Receive menu, the
transfer process is the same for all file types. However
on model LZ note that:
</p>

<ul>
<li>You cannot transmit password-protected Notes
  files. You will get a BAD NOTES FILE error if you
  try. Unprotect the file, as explained in the
  Organiser manual, if you do want to send this file.
</li><li>When you select File on model LZ, whether you
  transmit a diary or data file depends solely on the
  file name you enter - e.g. to transmit a diary file,
  select the appropriate diary file name.
</li></ul>

<p>
<b>For all models of the Organiser</b>, the following
sections give details of specific features of the different
file types which affect how you view and write files
which are to be transferred. These notes cover most of
the points which could give you unexpected results,
</p>

<h5>Plain text file</h5>

<p>
All the files that can be transferred with Transmit and
Receive are text files (ASCII) which you can edit in your
usual wordprocessor or editor, however, when you
save one of these files after viewing it, make sure that
it is still in a format acceptable to the Organiser.
</p>

<p>
The file must be a plain text file, with no control
characters (i.e. with ASCII code less than 32) other
than Reol/Reof sequences (as set in the setup list - see
the table on page 2-2) and &lt;TAB&gt;s.
</p>

<a id="p5-13"></a>
<p>
&lt;TAB&gt;s are received differently by different files:
</p>

<ul>
<li>In procedure files (all models) and LZ notepad files,
  &lt;TAB&gt;s are automatically translated to spaces by
  Comms Link during transfer.
</li><li>In data files (all models) and LZ diary files, &lt;TAB&gt;s
  separate fields within records.
</li></ul>

<h5>Format of data files and LZ diary files</h5>

<p>
Data files consist of a number of <b>records</b> each split
into a number of <b>fields</b>. LZ diary files consist of
records only. Data file records may contain up to 254
characters. LZ diary file records up to 64 characters.
</p>

<p>
<b>Records</b> are separated by &lt;CR&gt; and <b>fields</b> are
separated by &lt;TAB&gt;.
</p>

<p>
So if you want to write a data file on your other
computer and have it appear in the usual way on the
Organiser, press the &lt;TAB&gt; key where you use ↓ to
make a new line when entering a record on the
Organiser. Then press ↵ to begin a new record. (Blank
lines in the text file are removed by the Comms Link
software: an Organiser record may not be empty.)
</p>

<p>
Alternatively, use Ttrn or Rtrn to translate &lt;TAB&gt;s to a
more convenient character - e.g. a comma.
</p>

<h5>Rtrn, Ttrn</h5>

<p>
To convert &lt;TAB&gt;s (ASCII 9) on the Organiser to
commas (ASCII 44) on your other computer and vice
versa, set Ttrn and Rtrn in the Setup list, like this:
</p>

<ul class="arrowlist">
<li> Select Setup from the Comms menu.
</li><li> With ↓ scan down to Rtrn. Press <span class="key">EXE</span> and type:
<span class="code">44,9</span> <span class="key">EXE</span>. This displays as <span class="code">,&lt;HT&gt;</span>.
</li><li><a id="p5-14"></a>Scan down to Ttrn. Press <span class="key">EXE</span> and type <span class="code">9,44</span>
<span class="key">EXE</span>. This displays as <span class="code">&lt;HT&gt;,</span>.
</li></ul>

<p>
Rtrn and Ttrn replace the first character with the
second. If you enter only one character, it is removed.
Rtrn works on received characters, Ttrn on those to be
transmitted. Their default setting is NONE - no
translation occurs.
</p>

<h5>Existing names on the Organiser</h5>

<p>
When transmitting from the Organiser, an error
message will appear if the file you want to send can't
be found.
</p>

<p>
When receiving to the Organiser, if a file already exists
under the name you have specified to Receive to, you
are asked for confirmation of what to do:
</p>

<p>
If the file is a procedure or LZ notepad file you are
prompted by the Organiser:
</p>

<p class="indent code">A:NAME EXISTS
DELETE Y/N</p>

<p>
where NAME is the file specified.
</p>

<ul class="arrowlist">
<li> Press N and you return to the previous screen,
  where you may type in a different name or press
  <span class="key">ON/CLEAR</span> to abandon the transfer.
</li><li> Press Y and the old file is deleted, overwritten by
  the incoming file.
</li></ul>

<p>
If the file is a data file or LZ diary file you get this
menu:
</p>

<p class="indent code">Erase Append</p>

<p>
<b>Appending</b> an existing file means 'add the contents of
the received file onto the end of the contents of the
<a id="p5-15"></a>existing file'. <b>Erasing</b> an existing file means that the
old file is deleted and the new file takes its place.
</p>

<p>
You cannot append a file which you send to another
computer with Transmit. (You can if you use the OPL
commands explained in Chapter 8.) You will erase the
file unless you choose another name. You are <b>not</b>
given any warning that the file name already exists on
the other computer.
</p>

<h5>Length of file names</h5>

<p>
File names on the Organiser may be up to 8 alpha-
numeric characters long, and must start with a letter.
</p>

<h3>File extensions</h3>

<p>
Comms Link automatically gives files an extension
during file transfer - .OPL for procedure files, .NTS for
LZ notepad files, .ODB for data and LZ diary files. If
your wordprocessor changes this extension when you
save the file, either:
</p>

<ul class="arrowlist">
<li> Change the file extension on the other computer
 before beginning the file transfer.
</li></ul>

<p>
or
</p>

<ul class="arrowlist">
<li> When you Receive the file to the Organiser, include
  the new file extension as part of the file name. E.g.
  at the <span class="code">From:</span> prompt enter <span class="code">fred.txt</span> if <span class="code">.txt</span> is
  the extension your wordprocessor adds. Otherwise
  you will get a FILE NOT FOUND error.
</li></ul>

<h5>Procedure names</h5>

<p>
When you create a procedure under Prog on the
Organiser, the file name and procedure name are the
same, except that the procedure name has a colon.
</p>

<a id="p5-16"></a>
<p>
If you want to write Organiser procedures on your
other computer, include the procedure name, with
colon, as the first line of the file. If the file's first line is
not recognised by the Organiser as the procedure
name, the <b>file name</b> given in the Receive is used as
the <b>procedure name</b>, inserted as the first line of the
procedure.
</p>

<h3>Using modems</h3>

<p>
In principle, there is no reason why the Organiser and
the other computer should not be connected over a
dial-up line using a pair of modems. However, in
practice, this may be inconvenient because when
Protocol is set to either NONE or XMODEM (you
cannot use PSION protocol), you have to type on both
the Organiser and the other computer when
performing a file transfer. Since you obviously cannot
type on both machines yourself, you would normally
need an accomplice who would enter the necessary
commands for you at the other end.
</p>

<p>
If you do use modems, bear in mind that:
</p>

<ul>
<li>XMODEM protocol is error correcting.
</li><li>Baud must match the baud rate of the modems. If
the modems are operating over a dial-up line, the
baud rate is probably 2400, 1200 or 300.
</li><li>Most handshaking will probably work. RTS/CTS
handshaking works between the Organiser and
the modem. XON/XOFF provides 'end to end'
handshaking, but is ignored by XMODEM protocol.
</li><li>You will need a modem adaptor (available from
Psion).
</li></ul>

<hr>

<a id="p6-1"></a>
<a id="p6"></a><h2>
6 Connecting to a
printer
</h2>

<p>
<b>Before reading this Chapter</b> you should have read
Chapters 1 and 2, which explain how to fit the Comms
Link cable and about the setting of communications
parameters. This chapter covers:
</p>

<ul>
<li>The parameter settings suitable for printers
</li><li>Printing itself.
</li></ul>

<p>
It is assumed that the Organiser and printer are
physically connected, as explained in Chapter 1.
</p>

<h3>Establishing the connection</h3>

<p>
There are no standard settings across the different
types and makes of printers. Therefore the default
values for the parameters may well not be correct for
your printer.
</p>

<p>
The parameters which <b>must</b> be set correctly are the
first five in the list: Baud, Parity, Bits, Stop and Hand.
There are two ways in which you can find out what
values you need:
</p>

<ol type="i">
<li>Select Auto from the Comms menu. Then use
Term from the Comms menu to test the settings
suggested by Auto.
</li><li><a id="p6-2"></a>Work out from your printer manual and the
information on parameters given below what
settings are likely to give a match. Then, using
Term from the Comms menu, test the connection
with these settings.
</li></ol>

<p>
Once you have determined the correct settings, it is
recommended that you Save your Setup, to a pack if
possible, as explained in Chapter 2. You then have a
backup in case you wish to experiment with some
other settings or in case the Setup list gets reinitialised
(in one of the circumstances listed in chapter 2).
</p>

<p>
When the connection is working, continue with the
section 'Printing with Comms Link'.
</p>

<p>
On the following pages information is given on:
</p>

<ul>
<li>Auto
</li><li>Term
</li><li>Baud, Parity, Bits and Stop
</li><li>Handshaking [Hand].
</li></ul>

<h5>Other parameters</h5>

<p>
The default settings of the other parameters in the
Setup list probably don't need to be changed. However,
at the end of this Chapter are details of the parameters
which you may need to change for the particular
printer you're using or for a certain printing operation.
</p>

<p>
Parameters which you may find useful are:
</p>

<ul>
<li>Width
</li><li>Timeout
</li></ul>

<a id="p6-3"></a>
<h4>Auto</h4>

<p>
Auto works by sending to the printer a line of text
under first one combination of parameters, then
another, then another. The line of text that is sent is a
message stating what the parameter settings were for
that text transmission.
</p>

<p>
So if the text actually gets printed without corruption
you know that the settings which are printed are the
correct ones to use.
</p>

<p>
Auto begins transmitting as soon as you select it from
the Comms menu. During the transmission, the
Organiser display continuously shows the combination
of parameters which is currently being sent. Auto
continues until every combination has been tried,
when you are returned to the Comms menu. So:
</p>

<ul class="arrowlist">
<li> When you are satisfied that you have the correct
  parameter values, press <span class="key">ON/CLEAR</span> to abandon
  Auto and return to the Comms menu.
</li><li> More than one set of values may get printed.
  Check the printed lines carefully for errors, and
  select the best set.
</li></ul>

<p>
Auto works out only the first 4 parameters in the list.
These are the only essential ones, apart from Hand.
</p>

<p>
If Auto fails to print any correct parameter settings, it
is probably because Hand is set incorrectly. Either:
</p>

<ul class="arrowlist">
<li> Change the handshaking according to the
  information given below. Then run Auto again.
</li></ul>

<p>
or
</p>

<ul class="arrowlist">
<li> Study your printer manual and then test various
settings with Term.
</li></ul>

<a id="p6-4"></a>
<h4>Term</h4>

<p>
Sets the Organiser to terminal emulation mode - where
key presses directly transmit characters down the
cable, turning your Organiser and connected printer
into a sort of typewriter. Terminal emulation is really
designed for other uses, but it is the most immediate
way of testing the printer connection.
</p>

<ul class="arrowlist">
<li> Select Term. The display clears to just a flashing
  cursor at the left of the bottom line.
</li><li> Press <span class="key">EXE</span> a couple of times. If the paper in your
  printer feeds a line each time, you must have at
  least Baud, Bits and Stop set correctly.
</li><li> To return to the Comms menu press <span class="key">ON/CLEAR</span>.
</li></ul>

<p>
To test whether your handshaking is wrong:
</p>

<ul class="arrowlist">
<li> Enter the Setup list and change Echo to LOCAL.
</li><li> Return to Term. Type some characters.
</li></ul>

<p>
Because <b>all</b> characters transmitted in Term are
displayed on the screen when Echo is LOCAL, you
know that If no characters are displayed your
handshaking must be wrong.
</p>

<h4>Baud, Parity, Bits and Stop</h4>

<p>
Some particularly common printer settings are:
</p>

<p>
Baud 1200, 2400, 4800 or 9600
<br>Stop 2
<br>Bits 8, Parity NONE, or Bits 7, Parity ODD,
or Bits 7, Parity EVEN
</p>

<p>
Using a faster baud rate will not necessarily speed up
printing; there is simply a limit to how fast printers
<a id="p6-5"></a>can print. For example, 1200 baud corresponds to
about 120 characters per second, which is a lot faster
than most printers are able to print. (Handshaking
enables the printer to still cope with data at this speed.)
</p>

<p>
If you get the Bits and Parity settings wrong, the
printer should still print something; but some
characters (often about half) may print incorrectly.
Appendix C gives full details of these parameters.
</p>

<h4>Handshaking</h4>

<p>
Handshaking (or 'flow control') is needed because
printers cannot keep up with the rate at which the
Organiser transmits data. There needs to be a means
of holding the Organiser up when the internal memory
of the printer (its buffer) fills up. The handshaking
method used is set by Hand.
</p>

<dl>
<dt>NONE
</dt><dd>Won't stop your printer from working altogether
   but you will lose data whenever you transmit more
   than the printer can hold in its internal buffer.
</dd><dt>XON+DTR
</dt><dd>Try this handshaking first. If it fails, try just XON.
</dd></dl>

<p>
DTR and XON are the only two types of handshaking
commonly used by serial printers.
</p>

<p>
DTR handshaking sets the <b>D</b>ata <b>T</b>erminal <b>R</b>eady
control pin high when the printer is ready to receive
data, and low when its buffer is full.
</p>

<p>
XON/XOFF handshaking: the printer sends an XOFF
control character to pause the Organiser whenever its
buffer is full. It send an XON when it is ready for
more. (Also known as DCT/DC3 handshaking.)
</p>

<a id="p6-6"></a>
<h3>Printing</h3>

<p>
The methods of printing, and the things you are likely
to print out, are slightly different on different models of
the Organiser.
</p>

<h4>Printing from model LZ</h4>

<p>
The following applications each contain a 'Print' Item
in their menus:
</p>

<ul>
<li>Notes
</li><li>Diary
</li><li>Prog
</li><li>Xfiles
</li></ul>

<p>
To print out a procedure, for example, simply:
</p>

<ul class="arrowlist">
<li> Select Prog from the top-level menu.
</li><li> Select Print, and enter the name of the desired
  procedure.
</li></ul>

<p>
When you press <span class="key">EXE</span> the procedure is sent to the
printer. Press <span class="key">ON/CLEAR</span> to interrupt the printing.
</p>

<p>
Printing from any of the other menus involves the
same process. This should fulfil most of your printing
requirements. To print from an application supplied on
a Psion program pack, e.g. the Pocket Spreadsheet, see
the relevant section in the manual.
</p>

<a id="p6-7"></a>
<h4>Printing from models XP and CM</h4>

<p>
On these models of the Organiser you can print out
procedures, data files, individual records and notes.
</p>

<h5>Printing procedures</h5>

<p>
To print a procedure simply:
</p>

<ul class="arrowlist">
<li> Select FROG from the top-level menu.
</li><li> Select LIST. Enter the name of the desired
  procedure.
</li><li> When you press <span class="key">EXE</span> the procedure is sent to the
  printer. Press <span class="key">ON/CLEAR</span> to interrupt the printing.
</li></ul>

<h5>Printing data files</h5>

<p>
This method of printing data files does not require any
programming in OPL. However, the appearance of the
printout can be improved if you write an appropriate
procedure - see 'Printing from OPL' below.
</p>

<ul class="arrowlist">
<li> Ensure PROTOCOL and TEOF are still set to
  NONE (their default settings].
</li><li> Select TRANSMIT from the COMMS menu. You are
  presented with this menu:
  <p class="indent code">FILE PROCEDURE</p>
</li><li> Select FILE (PROCEDURE would print a
  procedure).
</li><li> Enter the name of the data file you wish to print,
  at the prompt:
  <p class="indent code">SEND A:</p>
</li></ul>

<a id="p6-8"></a>
<p>
If you have previously specified a file to be printed,
that file's name is suggested as a default. Otherwise,
A:MAIN is suggested.
</p>

<p>
To enter another file name:
</p>

<ul class="arrowlist">
<li> Press <span class="key">ON/CLEAR</span> to clear the suggested name.
</li><li> Press <span class="key">MODE</span> if necessary to change the device.
</li><li> Type in the new file name.
</li></ul>

<p>
When you press <span class="key">EXE</span> the file is sent to the printer. If
the file is found and transmitted successfully you are
returned to the COMMS menu. Any errors are reported
to the screen.
</p>

<p>
Data files are stored in the Organiser using a &lt;TAB&gt;
character to separate adjacent fields within records.
When you print a file, the &lt;TAB&gt; character will be
printed in between the fields in each record.
Depending on the content of your data file and the way
your printer responds to &lt;TAB&gt;s, this may produce an
undesirable layout.
</p>

<p>
You can change the way data files appear on the
printed page by setting TTRN such that &lt;TAB&gt;
characters are translated into another character (see
'Optional parameters', below).
</p>

<h5>Printing notes</h5>

<p>
If you want to prepare and then print a message
without having to save it as an individual data file, use
the capture buffer (normally used for other purposes).
To prepare the message:
</p>

<ul class="arrowlist">
<li> Select CAPTURE from the COMMS menu. The
  CAPTURE menu is displayed.
</li><li><a id="p6-9"></a>Select EDIT from this menu. You are presented
  with the prompt
  <p class="indent code">CAPTURE:</p>
</li><li> Type your message. The editor is almost identical
  to the editor in the PROG menu. For full details
  see the section on CAPTURE in Chapter 7.
</li></ul>

<p>
Your message remains in memory even when you press
<span class="key">ON/CLEAR</span> to return to the CAPTURE menu. To print
the contents of the capture buffer:
</p>

<ul class="arrowlist">
<li> Select TRANSMIT from the CAPTURE menu.
</li></ul>

<p>
The contents of the capture buffer are sent to the
printer (provided you haven't changed PROTOCOL to
PSION or XMODEM). You return to the CAPTURE
menu. Press <span class="key">ON/CLEAR</span> to return to the COMMS
menu.
</p>

<h5>Printing from OPL</h5>

<p>
The easiest way to print your data files is to use
TRANSMIT and FILE, as explained above. By using
LPRINT statements in an OPL procedure, however, you
can control how the text is positioned on your
printout, and select which records and which fields to
print.
</p>

<p>
Details of printing from OPL are given in the relevant
sections of your main Organiser manual. For full
details of using OPL with Comms Link see Chapter 8 of
this manual.
</p>

<p>
Below is an example program to print the data file
named 'MAIN'. (This is the file, in the internal memory
of the Organiser or on a Datapak or Rampak, used by
<a id="p6-10"></a>the top-level FIND and SAVE facilities.) The procedure
prints the data file, with:
</p>

<ul>
<li>Records separated by a blank line
</li><li>The fields of each record on separate lines
</li></ul>

<p>
When the program is run, it first prompts for the letter
of the device which contains the MAIN file. Enter A, B
or C (without the colon).
</p>

<p class="program">MPRINT:
LOCAL A$(1)
PRINT "Device: ";
INPUT A$
OPEN A$+":MAIN",A,F1$,F2$,F3$,F4$,F5$,F6$,F7$,F8$
DO
    IF LEN(A.F1$) :LPRINT A.F1$ :ENDIF
    IF LEN(A.F2$) :LPRINT A.F2$ :ENDIF
    IF LEN(A.F3$) :LPRINT A.F3$ :ENDIF
    IF LEN(A.F4$) :LPRINT A.F4$ :ENDIF
    IF LEN(A.F5$) :LPRINT A.F5$ :ENDIF
    IF LEN(A.F6$) :LPRINT A.F6$ :ENDIF
    IF LEN(A.F7$) :LPRINT A.F7$ :ENDIF
    IF LEN(A.F8$) :LPRINT A.F8$ :ENDIF
    LPRINT
    NEXT
UNTIL EOF
CLOSE</p>

<p>
This program is designed for printing out an
unstructured data file, where the number of fields and
the meaning of each field varies from record to record.
This is often the case for the MAIN file. The program
assumes that no record contains more than eight
fields. Blank fields are not printed.
</p>

<p>
You can use the program either directly or as a basis
for a more refined program better suited to the
structure of your data. For example, you may wish to
change the maximum number of fields, or to include a
selection criterion to print only those records which
satisfy a particular condition.
</p>

<a id="p6-11"></a>
<h3>Optional parameters</h3>

<p>
The following parameters are those which you may
need to change for your particular printer or for a
certain print job.
</p>

<dl>
<dt>Width
</dt><dd>
   Width can be used to stop your printer from
   printing off the right hand edge of the paper.

   <p>
   Set Width to 70 and the Organiser will insert &lt;CR&gt;
   after 70 characters (if the line gets that long).
   Width can be set to between 1 and 250.
   </p>

   <p>
   Width works with:
   </p><ul>
    <li>Print from the Notes, Prog, Diary and Xfiles menus
      (model LZ)
    </li><li>LIST from the PROG menu (models XP and CM)
    </li><li>Terminal emulation
    </li><li>OPL - e.g. LPRINT statements.
   </li></ul>

   <p>
   It doesn't work with Transmit from the Comms
   menu.
   </p>

   <p>
   Width's default setting is NONE - i.e. no checks
   are made on the length of a transmitted line, and
   no &lt;CR&gt; is inserted.
   </p>

   <p>
   Your printer may automatically stop printing when
   it gets to the edge of the paper - or you may never
   output lines that long. In this case, you can leave
   Width set to NONE.
   </p>

</dd><dt>Timeout
</dt><dd>
   If you attempt any print operation while the
   printer is 'off line' or out of paper, the Organiser
   Will wait indefinitely to send the next line of data.
   <a id="p6-12"></a>(provided Hand is set correctly) This is because
   the default value of Timeout is NONE.

   <p>
   For normal use, this is acceptable. You may
   always escape by:

   </p><ul>
    <li>Putting the printer 'on line'
    </li><li>Inserting more paper if necessary
   </li></ul>

   <p>
      or
   </p>

   <ul>
    <li>Pressing <span class="key">ON/CLEAR</span> to abandon the operation,
   </li></ul>

   <p>
      However, you can use the Timeout parameter to
      make print operations (for example the OPL
      command LPRINT) fail after the printer has been
      paused for a specified timeout interval. This is
      useful in an OPL program which will inform the
      program user when the printer has been paused
      for a suspiciously long time.
   </p>

   <p>
      The value you enter for Timeout must be an
      integer between 1 and 255. This specifies an
      approximate timeout interval in seconds.
   </p>

</dd><dt>Teol (transmit end of line)
</dt><dd>
   The Teol parameter specifies the characters (if any)
   which are sent by the Organiser to indicate the
   end of a line. Initially, this is set to 13,10 (ASCII
   code) - a carriage return followed by a line feed.
   This will be correct for most printers.

   <p>
   It is possible that your printer will be set to
   perform a line feed automatically whenever it
   receives a carriage return. In this case you will get
   two line feeds at the end of each line - and your
   printed output will be double spaced - unless you
   change the default setting, say to just ASCII 13.
   </p>

</dd><dt><a id="p6-13"></a>Teof (transmit end of file)
</dt><dd>
   The Teof parameter specifies the characters (if any)
   which are sent by the Organiser to indicate the
   end of a file when using Transmit under the
   Comms menu. If you wish to use Transmit to print
   data files (as described at the end of this Chapter)
   set Teof to NONE, or 12 to give a form feed.
   <br>&nbsp;

</dd><dt>Ttrn (translate transmitted characters)
</dt><dd>
   The Ttrn parameter lets you choose a certain
   character which is to be 'translated' before it is
   sent to the printer. The Organiser removes every
   instance of the character, and if you want replaces
   it with another specified character. E.g. to
   translate every occurrence of &lt;TAB&gt; to a comma
   (ASCII 44):

   <ul class="arrowlist">
   <li> Press <span class="key">EXE</span> when Ttrn is the current parameter.
   </li><li> Type <span class="code">9,44</span> <span class="key">EXE</span>.
   </li></ul>

   <p>
   This is the most common use of Ttrn, since the
   &lt;TAB&gt; character is used to separate fields in
   Organiser data files. Initially, Ttrn is set to NONE -
   i.e. no characters are changed.
   </p>

   <p>
   To remove characters without replacing them with
   another, only give one value to the Ttrn parameter.
   E.g. to remove all &lt;TAB&gt; characters type 9 <span class="key">EXE</span>.
   </p>
</dd></dl>

<hr>

<a id="p7-1"></a>
<a id="p7"></a><h2>
7 Terminal
Emulation
</h2>

<h3>The terminal emulation facilities</h3>

<p>
In terminal emulation the Organiser does not seek to
compete with devices with full displays. However, an
Organiser with Comms Link and a portable modem
can be carried with you, to access electronic mail
services when you are away from your desk.
</p>

<p>
Comms Link provides advanced terminal faculties. You
can:
</p>

<ul>
<li>Capture data from an electronic mail system (the
  host) into the <b>capture buffer</b> (within the internal
  memory of the Organiser).
</li><li>Then simply store the data in the buffer, or Edit
  and/or Save it as an Organiser file.
</li><li>Then transmit the contents of the buffer, to
  another computer, say.
</li></ul>

<p>
So you could log on to an electronic mail system, view
your mail and then log off again. Whilst 'off-line' you
could edit the 'transcription' of the on-line session,
removing unwanted system messages or prompts.
Then, at a later time, send the contents of the capture
buffer to a printer or to your desktop PC.
</p>

<p>
If you want to prepare a message - e.g. a telex - before
logging on, you can do this in one of your Notepads
(model LZ), or in the empty capture buffer (models CM
<a id="p7-2"></a>and XP). This will be stored until you are ready to
transmit it.
</p>

<p>
In this Chapter it is assumed, where necessary, that
you are already familiar with using a modem and/or
logging on to your electronic mail (or other) system
from a terminal or desktop computer.
</p>

<p>
Before you continue with this Chapter you should have
read Chapters 1 and 2, which explain how to fit the
Comms Link cable and about the setting of
communications parameters.
</p>

<h3>Setting the parameters</h3>

<p>
The parameters which <b>must</b> he set correctly and which
will possibly involve a change from the default settings
are: Baud, Hand, Teol and Reol.
</p>

<dl>
<dt>Baud
</dt><dd>Set to the baud rate of the host, or of the modem if
   you are using one.

   <p>
   It isn't possible to set a different rate for
   transferred and received data on the Organiser. If
   you wish to communicate with a split speed host
   (e.g. using the V23 75/1200 standard) use a
   modem which buffers the data and presents a
   single speed at the RS232 interface.
   </p>

</dd><dt>Hand
</dt><dd>Set to XON+RTS. RTS/CTS handshaking operates
   between the Organiser and the modem (if you are
   using one) and XON/XOFF handshaking provides
   'end to end' handshaking.<br>&nbsp;

</dd><dt><a id="p7-3"></a>Teol
</dt><dd>During terminal emulation, pressing the <span class="key">EXE</span> key
   transmits the Teol sequence. The sequence is also
   sent at the end of every line in a file transmitted by
   the Organiser.

   <p>
   The Teol default setting (&lt;CR&gt;&lt;LF&gt;) is usually not
   suitable for terminal emulation. Change to just
   &lt;CR&gt;. <b>It is very important that you set this
   parameter correctly, otherwise you will almost
   certainly be unable to log on to a remote
   system.</b>
   </p>

</dd><dt>Reol
</dt><dd>Set to the sequence which is sent by the host at
   the end of each line. This would normally be some
   combination of &lt;CR&gt; (ASCII 13) and &lt;LF&gt; (ASCII
   10). The default value is probably correct.

   <p>
   If Reol is set wrongly, you will notice it in the
   following cases:
   </p>

   <ol type="i">
   <li>The display may not scroll properly. Normally,
   every Reol sequence received in terminal
   emulation causes the display to start a new line
   - i.e. the screen scrolls down (but see Width).

   </li><li>When receiving a file, Reol is used to recognise:

   <ul>
   <li>The end of records in data and LZ diary files
   </li><li>The end of lines in procedure and LZ notepad
   files.
   </li></ul>

   <p>
   So you might get records or procedure lines
   joining up, or extra &lt;CR&gt;s or &lt;LF&gt;s treated as
   literal characters. This would cause a BAD
   PROCEDURE error in a received procedure file.
   </p>
   <a id="p7-4"></a>
   <p>
   Try using Ttrn and Rtrn to delete any stray
   incoming &lt;CR&gt; or &lt;LF&gt;.
   </p>
   </li></ol>
</dd></dl>

<p>
The following parameters are those which may need
changing for your particular application or which give
you extra flexibility.
</p>

<dl>
<dt>Echo
</dt><dd>In terminal emulation, characters corresponding
   to keys pressed on the Organiser are transmitted
   to the host and characters which are received from
   the host are displayed on the Organiser screen
   (and optionally saved in the capture buffer).

   <p>
   When Echo is LOCAL, transmitted as well as
   received characters are displayed on the Organiser
   (and recorded in the capture buffer if Capture is
   enabled). If you see every character twice, set Echo
   to HOST. This stops the characters transmitted by
   the Organiser from being 'echoed' back by the
   host.
   </p>

</dd><dt>Width
</dt><dd>Forces an end of line (as if the Reol sequence had
   been received) when the received line length
   becomes greater than the number of characters
   specified.

   <p>
   E.g. setting Width to 16 (the width of the Organiser
   display - or 20 for model LZ) will cause a received
   line longer than 16 (20) characters to be continued
   on a new display line rather than scrolled
   horizontally.
   </p>

   <p>
   This parameter does not affect transmitted lines.
   The maximum Width that you can specify is 250.
   </p>

</dd><dt><a id="p7-5"></a>Reof, Teof
</dt><dd>The Reof sequence identifies the end of a file
   received to the Organiser. The Organiser sends the
   Teof sequence to signal the end of a file, or the end
   of the capture buffer, transmitted to a host.

   <p>
   Roof and Teof work only with Transmit and
   Receive from the Comms menu.
   </p>

   <p>
   The correct values for Reof and Teof depend on the
   host and the software which it is running, but the
   default settings are probably correct.
   </p>

</dd><dt>Rtrn, Ttrn
</dt><dd>Remove a specified character or translate it to
   another character on transmission or reception of
   that character. When Rtrn or Ttrn is set to NONE
   (the default), no translation occurs. When set to
   only one character, that character is removed.
   When set to two characters, the first character is
   translated to the second character.

   <p>
   Rtrn and Ttrn are typically used to translate
   &lt;TAB&gt; characters in data files, where they
   separate adjacent fields in records, to a more
   convenient field delimiter for use on the host. For
   example, you might wish to convert a &lt;TAB&gt; on
   the Organiser to a comma on the host. To convert
   &lt;TAB&gt;s (ASCII 9) to commas (ASCII 44) and vice
   versa, set Ttrn and Rtrn like this:

   </p><ul class="arrowlist">
    <li> Press <span class="key">EXE</span> when Ttrn is the current parameter
      and type: <span class="code">9,44</span> <span class="key">EXE</span>.
    </li><li> Press <span class="key">EXE</span> when Rtrn is current and type <span class="code">44,9</span>
      <span class="key">EXE</span>.
   </li></ul>
</dd></dl>

<a id="p7-6"></a>
<h3>Term</h3>

<ul class="arrowlist">
<li> Save the changes to your setup list by pressing
  <span class="key">MODE</span> and then Exit (or Save them as a file if you
  want).
</li><li> From the Comms menu select Term. You have now
  entered terminal emulation.
</li></ul>

<h5>Preparing a modem</h5>

<p>
If your modem has auto-dial facilities:
</p>

<ul class="arrowlist">
<li> On the Organiser keyboard, type the dial number
  in the way appropriate for your modem - e.g. if you
  were connected to a Hayes modem, type
  <span class="code">ATD237</span> <span class="key">EXE</span>.
</li><li> Wait for the modem to indicate that the call has
  been connected.
</li></ul>

<p>
If the modem doesn't have auto-dial facilities:
</p>

<ul class="arrowlist">
<li> Dial the host manually.
</li><li> Switch the modem to data when you hear the
  whistle of the modem at the other end.
</li></ul>

<p>
Once the call has been connected (the 'carrier'
indicator on your modem will have lit up):
</p>

<ul class="arrowlist">
<li> Press <span class="key">EXE</span> repeatedly until you see the expected
  system prompt.
</li><li> Log on to the system in the normal way.
</li></ul>

<p>
If all seems to be working but the host mysteriously
will not accept your log on, check that Teol is correctly
set for your system.
</p>

<a id="p7-7"></a>
<h4>Display of received data</h4>

<h5>Scrolling</h5>

<p>
As data is received by the Organiser, the lower display
line scrolls <b>horizontally</b> when the line length exceeds
the width of the screen - 16 characters on models XP
and CM, 20 on model LZ.
</p>

<p>
If an end of line sequence (as set by Reol) is received,
or if the line width (as set by Width) is exceeded, the
display scrolls <b>vertically</b> to show the first 16 (20)
characters of the line on the upper display line, the
remaining characters on the lower line.
</p>

<p>
A horizontal or vertical scroll delay is applied where
necessary to give you a chance to view the data
received. You can avoid horizontal scrolling by setting
the Width parameter to 16 (20).
</p>

<h5>Control characters</h5>

<p>
Received ASCII characters with numbers below 32 are
displayed as ^A for ASCII 1, ^B for ASCII 2, ^C for
ASCII 3 and so on, with two exceptions:
</p>

<ul>
<li>All received &lt;NUL&gt;s are discarded.
</li><li>All received &lt;TAB&gt; characters are displayed using
a special &lt;TAB&gt; graphic: <img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/tab.gif" width="15" height="24" alt="Tab graphic">
</li></ul>

<p>
A received Reol scrolls the display, and is then
discarded. A received Reof is also discarded. If you see
the same control characters at the beginning or end of
each line this may indicate that you have set Reol
incorrectly.
</p>

<p>
Comms Link terminal emulation ignores escape codes.
</p>

<a id="p7-8"></a>
<h3>Keyboard during emulation</h3>

<p>
In terminal emulation, <span class="key">SHIFT</span>, <span class="key">CAP</span> and <span class="key">NUM</span> allow
the usual full range of upper and lower case letters,
numbers, operators and punctuation to be produced.
However, the cursor keys behave differently to normal:
</p>

<ul>
   <li>The ↓ key pauses the display and the ↑ key starts
   the display again. (You will not lose any data
   provided you are using the correct handshaking]
   </li><li>The ← and → keys operate like shift keys,
   effectively providing a range of new character keys.
</li></ul>

<p>
The ← key acts like the CONTROL key on a PC
keyboard, enabling you to send control characters
such as &lt;SUB&gt; for end of file. &lt;DC3&gt; for pause, etc.
</p>

<p>
The full range of additional characters is given in the
table opposite. Note that on models XP and CM the
ASCII \ character is displayed as a Yen sign (Y) and the
~ character as a right arrow.
</p>

<h3>Quitting terminal emulation</h3>

<ul class="arrowlist">
<li> To exit terminal emulation and return to the
  Comms menu, press <span class="key">ON/CLEAR</span>.
</li></ul>

<p>
You will not lose any data when you exit and re-enter
terminal emulation, provided that you are using the
correct handshaking.
</p>

<p>
During terminal emulation, the Organiser must always
be able to receive characters from the host. Because of
this, the Organiser cannot employ its usual
power-conserving technique of switching off the ports
when waiting for a key press. <b>Unless you are using a
Mains Adaptor, avoid leaving the Organiser for long
periods within terminal emulation.</b>
</p>

<a id="p7-9"></a>
<h4>Organiser keys during emulation</h4>

<table summary="">
<tbody><tr><td colspan="2">with LEFT arrow</td><td></td><td></td><td></td><td colspan="2">with RIGHT arrow</td></tr>
<tr><td>ASCII no.</td><td>ASCII char.</td><td></td><td></td><td></td><td>ASCII char.</td><td>ASCII no.</td></tr>
<tr><td>01</td><td>SOH      </td><td rowspan="26">←</td><td>A</td><td rowspan="26">→</td><td>ESC  </td><td>1B</td></tr>
<tr><td>02</td><td>STX      </td><td>B</td><td>FS   </td><td>1C</td></tr>
<tr><td>03</td><td>ETX      </td><td>C</td><td>GS   </td><td>1D</td></tr>
<tr><td>04</td><td>EOT      </td><td>D</td><td>RS   </td><td>1E</td></tr>
<tr><td>05</td><td>ENQ      </td><td>E</td><td>US   </td><td>1F</td></tr>
<tr><td>06</td><td>ACK      </td><td>F</td><td>!    </td><td>21</td></tr>
<tr><td>07</td><td>BEL      </td><td>G</td><td>#    </td><td>23</td></tr>
<tr><td>08</td><td>BS       </td><td>H</td><td>&amp;</td><td>24</td></tr>
<tr><td>09</td><td>HT       </td><td>I</td><td>'    </td><td>27</td></tr>
<tr><td>0A</td><td>LF       </td><td>J</td><td>?    </td><td>3F</td></tr>
<tr><td>0B</td><td>VT       </td><td>K</td><td>@    </td><td>40</td></tr>
<tr><td>0C</td><td>FF       </td><td>L</td><td>[    </td><td>5B</td></tr>
<tr><td>0D</td><td>CR       </td><td>M</td><td>\    </td><td>5C</td></tr>
<tr><td>0E</td><td>SO       </td><td>N</td><td>]    </td><td>5D</td></tr>
<tr><td>0F</td><td>SI       </td><td>O</td><td>^    </td><td>5E</td></tr>
<tr><td>10</td><td>DLE      </td><td>P</td><td>_    </td><td>SF</td></tr>
<tr><td>11</td><td>DC1(XON) </td><td>Q</td><td>'    </td><td>60</td></tr>
<tr><td>12</td><td>DC2      </td><td>R</td><td>{    </td><td>7B</td></tr>
<tr><td>13</td><td>DC3(XOFF)</td><td>S</td><td>|    </td><td>7C</td></tr>
<tr><td>14</td><td>DC4      </td><td>T</td><td>}    </td><td>7D</td></tr>
<tr><td>15</td><td>NAK      </td><td>U</td><td>~    </td><td>7E</td></tr>
<tr><td>16</td><td>SYN      </td><td>V</td><td>DEL  </td><td>7F</td></tr>
<tr><td>17</td><td>ETB      </td><td>W</td><td>?    </td><td>3F</td></tr>
<tr><td>18</td><td>CAN      </td><td>X</td><td>?    </td><td>3F</td></tr>
<tr><td>19</td><td>EM       </td><td>Y</td><td>?    </td><td>3F</td></tr>
<tr><td>1A</td><td>SUB      </td><td>Z</td><td>?    </td><td>3F</td></tr>
</tbody></table>

<a id="p7-10"></a>
<h3>The Capture Buffer</h3>

<h4>For models XP and CM</h4>

<p>
When you select CAPTURE from the COMMS menu,
this sub-menu is presented.
</p>

<table summary="">
<tbody><tr><th>TERM</th><td>Enter terminal emulation with capture
                     enabled.</td></tr>
<tr><th>EDIT</th><td>Enter the capture buffer editor.</td></tr>
<tr><th>SAVE</th><td>Sace capture buffer data to a file.</td></tr>
<tr><th>TRANSMIT</th><td>Transmit the data in the capture
                     buffer.</td></tr>
<tr><th>CLEAR</th><td>Clear the capture buffer.</td></tr>
</tbody></table>

<p>
To exit from the CAPTURE menu back to the COMMS
menu, press <span class="key">ON/CLEAR</span> while the capture menu is
displayed.
</p>

<p>SAVE, TRANSMIR and CLEAR will operate only when
the capture buffer contains data. A BUFFER IS EMPTY
message will be displayed if this is not the case.
</p>

<dl>
<dt>TERM
</dt><dd>
   Term in the CAPTURE menu enters terminal
   emulation with the same effect as selecting Term
   in the COMMS menu except that:
   <ul>
   <li>Displayed characters are recorded in the
   capture buffer.
   </li><li>The scroll delays are switched off.
   </li></ul>
   <p>
   Pressing <span class="key">ON/CLEAR</span> returns to the CAPTURE
   menu.
   </p>
   <a id="p7-11"></a>
   <p>
   Using TERM under CAPTURE can rapidly
   consume your free memory. Don't be too casual
   about leaving large amounts of data in the capture
   buffer or you may find that various operations
   elsehwhere on the Organiser will fail with an OUT
   OF MEMORY meddage.
   </p>
   <p>
   You may take the opportunity to release some
   memory (e.g. by deleting some o all of the data in
   the capture buffer) before returning to terminal
   emulation. Provided that handshaking is in use,
   you will not miss any data in the meantime.
   </p>
</dd><dt>EDIT
</dt><dd>
   The capture buffer editor is almost identical to the
   procedure editor under the top-level menu item
   PROG:
   <ul>
   <li>Th ↑ and ↓ cursor keys scan through captured
   lines.
   </li><li><span class="key">ON/CLEAR</span> deletes a line.
   </li><li>The ← and → cursor keys move the cursor
   within a line.
   </li><li><span class="key">DEL</span> and <span class="key">SHIFT</span>-<span class="key">DEL</span> delete left and right
   respectively.
   </li><li>Key presses corresponding to printable
   characters insert at the cursor position.
   </li></ul>
   <p>
   Additionally
   </p>
   <ul>
   <li><span class="key">EXE</span> splits a line at the cursor position.
   </li></ul>
   <a id="p7-12"></a>
   <p>
   Received &lt;TAB&gt; characters are displayed with the
   special &lt;TAB&gt; graphic. <span class="key">MODE</span> returns to the
   CAPTURE menu.
   </p>
   <p>
   The EDIT option can be used to prepare data 'off
   line' for subsequent transfer to a host. Select Edit
   from the CAPTURE menu before you have
   captured any data. The screen will show:
   </p>
   <p class="indent code">CAPTURE:</p>
   <p>
   The capture buffer is empty, and you may enter
   text into it. The capture buffer can hold as much
   data as the free memory of the Organiser can hold.
   </p>

</dd><dt>SAVE
</dt><dd>
   You can save the data in the capture buffer to a
   data or procedure file.
   <ul class="arrowlist">
    <li> Select SAVE and a menu is presented for these
      types. Select the appropriate one.
    </li><li> Select a name for the file on the Organiser.
   </li></ul>
   <p>
   Press <span class="key">EXE</span> and the save proceeds. <b>The data
   remains in the capture buffer even after the
   Save has finished.</b>
   </p>
   <p>
   If you intend to save the contents of the buffer to
   the internal memory of the organiser (A: rather
   than a pack), the buffer must not occupy more
   than half of the available free memory of the
   machine. Otherwise, when attempting to save the
   contents of the buffer an OUT OF MEMORY
   message will be displayed and the Save will be
   abandoned.
   </p>

</dd><dt><a id="p7-13"></a>TRANSMIT
</dt><dd>The TRANSMIT option in the CAPFURE menu
   behaves in the same way as TRANSMIT under the
   COMMS menu - except that it transmits the
   contents of the capture buffer, without prompting
   for a file type.
   <ul class="arrowlist">
    <li> Select TRANSMIT and you are prompted for a file
      name on the receiving device.
    </li><li> Press <span class="key">EXE</span> and the transmission proceeds.
   </li></ul>
   <p>
   TEOL, TEOF and TTRN are all applied to the
   transmitted data. For details of how the
   PROTOCOL setting affects the transmission, see
   Chapter 6.
   </p>

</dd><dt>CLEAR
</dt><dd>Clears the capture buffer. You will be prompted to
   confirm this.
   <p>
   <b>If you don't CLEAR the buffer it will retain its
   contents indefinitely.</b>
   </p>
   <p>
   If there is data in the buffer and you exit from the
   COMMS option altogether (even if you remove the
   Comms Link plug and software from the
   Organiser) the capture buffer will still remain
   intact.
   </p>
   <p>
   This means that you can download some data, say
   from an electronic mail service, then disconnect.
   unplug the cable and return home or to the office,
   then print out the contents of the capture buffer
   when convenient.
   </p>
</dd></dl>

<a id="p7-14"></a>
<h4>For model LZ</h4>

<h5>Capture buffer editor</h5>

<p>
When you select Capture from the Comms menu you
immediately enter the capture buffer editor, with this
prompt when the buffer is empty:
</p>

<p class="indent code">Capture:</p>

<p>
The capture buffer editor has the same features as the
Notes editor.
</p>

<ul>
   <li>The ↑ and ↓ cursor keys scan through captured
     lines.
   </li><li>The ← and → cursor keys move the cursor within
     a line.
   </li><li>DEL and SHIFT-DEL delete left and right
     respectively.
   </li><li>Key presses corresponding to printable characters
     insert at the cursor position.
   </li><li><span class="key">EXE</span> splits a line at the cursor position.
</li></ul>

<p>
Received &lt;TAB&gt; characters are displayed with the
special &lt;TAB&gt; graphic.
</p>

<p>
You can use the empty capture buffer to prepare data
'off line' for subsequent transfer to a host (using
Transmit from the Capture menu).
</p>

<p>
The capture buffer will hold as much data as the free
memory of the Organiser can hold.
</p>

<h5>Capture menu</h5>

<ul class="arrowlist">
<li> Press <span class="key">MODE</span> while using the capture buffer editor.
  This menu appears along the top of the display:
</li></ul>

<a id="p7-15"></a>
<table summary="">
<tbody><tr><th width="70">Term     </th><td>Enters terminal emulation with
         capture enabled.</td></tr>
<tr><th>Find     </th><td>Finds occurrences of the string entered.</td></tr>
<tr><th>Save     </th><td>Saves capture buffer data to a file.</td></tr>
<tr><th>Transmit </th><td>Transmits the contents of the capture
         buffer.</td></tr>
<tr><th>Home     </th><td>Moves you to the top of the buffer.</td></tr>
<tr><th>End      </th><td>Moves you to the end of the buffer.</td></tr>
<tr><th>Clear    </th><td>Clears the capture buffer.</td></tr>
</tbody></table>

<ul class="arrowlist">
<li> To return to the capture buffer editor from the
  menu, press <span class="key">ON/CLEAR</span>. You return to where you
  were when you pressed <span class="key">MODE</span>.
</li><li> To return to the Comms menu, press <span class="key">ON/CLEAR</span>
  in the Capture buffer.
</li></ul>

<p>
When you leave the buffer, its contents remain intact
(held in the internal memory). When you return to the
capture buffer, you return to the editor at the position
from where you left.
</p>

<p>
Save, Transmit and Clear will give a BUFFER IS
EMPTY message if there is no data in the buffer.
</p>

<dl>
<dt>Term
</dt><dd>Enters terminal emulation with the same features
   as Term selected from the Comms menu (see
   above). The two differences are that:
   <ul>
     <li>Displayed characters are recorded in the
        capture buffer.
     </li><li>The scroll delays are switched off.
   </li></ul>
   <p>
   Pressing <span class="key">ON/CLEAR</span> returns to the Capture menu.
   </p>
   <a id="p7-16"></a>
   <p>
   Using Term under Capture can rapidly consume
   your free memory. Don't be too casual about
   leaving large amounts of data in the capture buffer
   or you may find that various operations elsewhere
   on the Organiser will fail with an OUT OF
   MEMORY message.
   </p>
   <p>
   If you get an OUT OF MEMORY message during
   the capture of data to the buffer, terminal
   emulation is abandoned. Press SPACE to exit to
   the Capture menu.
   </p>
   <p>
   You may take the opportunity to release some
   memory (e.g. by deleting some of the data in the
   capture buffer) before returning to terminal
   emulation. Provided that handshaking is in use,
   you will not miss any data in the meantime.
   </p>

</dd><dt>Find
</dt><dd>Select Find and you are asked for a searchstring.
   Enter the desired string. Then each time you press
   <span class="key">EXE</span>, the cursor moves to the next occurrence of
   the string. To edit the data at that point, press
   <span class="key">ON/CLEAR</span>. Press ← or → to edit the searchstring.
   <br>&nbsp;
</dd><dt>Save
</dt><dd>You can save the data in the capture buffer to a
   data file, a procedure or a notepad file.
   <ul class="arrowlist">
      <li> Select Save and a menu is presented:
   </li></ul>
   <p class="indent code">File Procedure Notes</p>
   <ul class="arrowlist">
      <li> Select the appropriate one.
   </li></ul>
   <p>
   You are prompted for the name to save the file
   under on the Organiser:
   </p>
   <p class="indent code">Save A:</p>
   <a id="p7-17"></a>
   <p>
   A default name will be suggested if you have
   already saved from the capture buffer to a file.
   </p>
   <ul class="arrowlist">
      <li> Press <span class="key">EXE</span>.
   </li></ul>
   <p>
   If the file name you entered already exists on the
   selected device, you are asked:
   </p>
   <p class="indent code">DELETE Y/N?</p>
   <p>
   If the file was a procedure or notes file, or get this
   menu if the file was a data file:
   </p>
   <p class="indent code">Erase Append</p>
   <p>
   If you select Erase, an 'Erasing' message appears.
   During the Save process, a 'Saving' message is
   shown. On completion, you return to the capture
   buffer editor. <b>The data remains in the capture
   buffer even after it has been saved.</b>
   </p>
   <p>
   If you intend to save the contents of the buffer to
   the internal memory of the Organiser (A: rather
   than a pack in B: or C:), the buffer must not
   occupy more than half of the available free
   memory. Otherwise you'll get an OUT OF
   MEMORY message and the Save will be
   abandoned.
   </p>

</dd><dt>Transmit
</dt><dd>Transmits the contents of the capture buffer.
   <ul class="arrowlist">
      <li> Select Transmit and you are prompted for a File
        name on the receiving device.
      </li><li> Press <span class="key">EXE</span> and the transmission proceeds.
   </li></ul>
   <p>
   The transmission is affected by the current
   settings in the Setup list, just like Transmit in the
   Comms menu. Teol, Teof and Ttrn are all applied
   <a id="p7-18"></a>to the transmitted data. The transmission process
   also depends upon which Protocol is set - e.g.
   PSION protocol can only be used when the
   connected computer is running the Comms Link
   program. With no protocol, the receiving computer
   should be prepared first. For details of these
   protocols, see Chapter 6.
   </p>

</dd><dt>Clear
</dt><dd>Clears the capture buffer. You will be prompted to
   confirm this.
   <p>
   <b>If you don't Clear the buffer it will retain its
   contents indefinitely.</b>
   </p>
   <p>
   If there is data in the buffer and you exit from the
   Comms option altogether (even if you remove the
   Comms Link plug and software from the
   Organiser) the capture buffer will still remain
   intact.
   </p>
   <p>
   This means that you can download some data, say
   from an electronic mail service, then disconnect,
   unplug the cable and return home, then print out
   the capture buffer when convenient.
   </p>
</dd></dl>

<h3>Example file transfer</h3>

<p>
As well as Transmit/Receive in the Capture menu, you
can use Transmit/Receive from the Comms menu in
conjunction with terminal emulation to transfer files
between the Organiser and a host. You may or may not
be using modems.
</p>

<p>
In the following example, a data file stored n a Digital
Equipment Corp. VAX mini computer running VMS is
received to the Organiser. This is just one example of
<a id="p7-19"></a>what can be done with terminal emulation. It
illustrates some of the uses of the communications
parameters discussed above.
</p>

<h4>File types</h4>

<p>
The Organiser file types that you can send or receive to
are:
</p>

<ul>
<li>Data files
</li><li>Procedure files
</li></ul>

<p>
and additionally on model LZ:
</p>

<ul>
<li>Diary files
</li><li>Notepad files
</li></ul>

<p>
These are all text files. If you want to transfer binary
files, see Chapter 8. For further information on these
file types, see the relevant section in Chapter 5.
</p>

<h4>Transfer strategy</h4>

<p>
When connected to a VAX, the Organiser keyboard
controls not only the Organiser but the VAX command
line. On the Organiser the command to 'transmit'
consists merely in your selecting an item from the
Comms menu (and then a file name). On the VAX,
however, you must <b>type</b> the command word - whatever
it is in the software the VAX is running - including the
proper file name and followed by 'enter', e.g. type
fred.doc Enter
</p>

<p>
Receive/Transmit in the Comms menu is the mode in
which you are communicating with the Organiser:
Term is the mode in which you are communicating
<a id="p7-20"></a>with the VAX. Obviously you cannot be in both modes
at once, so you have to find a way to prepare first one
computer and then the other.
</p>

<p>
If the VAX is the source it will try to send the requested
file immediately - i.e. before you have returned to the
Comms menu and prepared the Organiser. The way to
get around this is to type a 'pause' signal at the end of
the file name when you are in Term, then go back to
Comms and prepare the Organiser; when you press
<span class="key">EXE</span> a 'continue' signal is sent and the VAX will
immediately send the requested file.
</p>

<h4>Setting up</h4>

<p>
The following Setup is suitable for VAX terminal
emulation generally.
</p>

<ul class="arrowlist">
<li> Select Setup from the Comms menu. Make the
  following changes from the default setup.
</li></ul>

<table summary="">
<tbody><tr><th width="70">Ttrn</th><td>8,127<br>
         The VAX uses &lt;DEL&gt; (ASCII 127)
         where the Organiser uses &lt;BS&gt;
         (backspace: ASCII 8).</td></tr>
<tr><th>Teol</th><td>&lt;CR&gt;</td></tr>
<tr><th>Reol</th><td>&lt;LF&gt;</td></tr>
<tr><th>Rtrn</th><td>&lt;CR&gt;<br>
         The VAX sends &lt;CR&gt;&lt;LF&gt;&lt;CR&gt; as its
         end of line signal. Rtrn cuts out the
         extra &lt;CR&gt;s, leaving the single &lt;LF&gt;
         as the signal for Teol.</td></tr>
</tbody></table>

<ul class="arrowlist">
<li> Press <span class="key">MODE</span> and select Exit.
</li><li><a id="p7-21"></a>Select Term from the Comms menu to enter
terminal emulation.
</li><li> Press <span class="key">EXE</span> a couple of times to bring up the VAX's
prompt line. (The <span class="key">EXE</span> won't spoil the command
line you go on to type: it will simply be ignored as
a literal string.)
</li><li> Type <span class="code">fred.doc</span> where fred.doc is the data
file to be sent. <b>Don't press <span class="key">EXE</span> yet.</b>
</li></ul>

<p>
Because Echo is set correctly you will see on the
Organiser screen what you are typing to the VAX.
</p>

<ul class="arrowlist">
<li> <b>Before pressing <span class="key">EXE</span></b>, hold down ← and press S.
</li></ul>

<p>
When you press <span class="key">EXE</span> and the VAX receives the line,
←S works as an XOFF signal, pausing the host -
provided you have XON/XOFF handshaking activated.
If you didn't add this, the host would immediately
transmit the file to the Organiser screen, not to an
Organiser file.
</p>

<ul class="arrowlist">
<li> Once you've pressed <span class="key">EXE</span> press <span class="key">ON/CLEAR</span> to
return to the Comms menu.
</li><li> Select Receive
</li><li> From the next menu select the relevant file type.
</li></ul>

<p>
On models CM and XP, select procedure for a
procedure file or File for a data file. On model LZ you
can also choose File for an LZ diary file or Notes for an
LZ notepad file.
</p>

<ul class="arrowlist">
<li> Type fred for the file name on the Organiser.
Press <span class="key">EXE</span> to enter it.
</li></ul>

<a id="p7-22"></a>
<p>
The file transfer begins. The <span class="key">EXE</span> key sent an XON
signal to the host, allowing the command you typed in
(suspended with the XOFF) to be processed.
</p>

<p>
During the transfer the received data is displayed on
the Organiser screen. At higher baud rates this may be
too fast to read, but it does let you know that the
transfer is going ahead.
</p>

<p>
At the end of the file the Organiser expects to receive
an Reof signal. One way of arranging this is to include
^Z (&lt;SUB&gt;, or whatever you have Reof set to) in the
file on the VAX. If the Organiser receives no Reof
signal, it will simply wait. When data has stopped
displaying an the screen, press ON/CLFAR to quit.
</p>

<h5>Abandoning the transfer</h5>

<p>
Pressing <span class="key">ON/CLEAR</span> at any time during the transfer
abandons it, saving all the information so far received.
</p>

<hr>

<a id="p8-1"></a>
<a id="p8"></a><h2>
8 Comms Link
and OPL
</h2>

<p>
This Chapter assumes that you are familiar with the
Organiser programming language, OPL, described in
detail in the Organiser manual.
</p>

<p>
Whilst Comms Link is fitted to the Organiser, it adds to
OPL a number of procedures. These enable you to
open and read files on an attached computer, or
transfer files between the Organiser and the computer.
</p>

<p>
These 'communications procedures' are called in
exactly the same way that you would call your own
procedures. They are stored in the Comms Link device.
<b>Do not give any of your own procedures the same
name as any of the procedures described here.</b>
Having 2 procedures with the same name could
confuse both you and the Organisers operating system.
</p>

<p>
The procedures fall into two groups. The following can
be used in connection with any computer:
</p>

<table summary="">
<tbody><tr><th width="110">LSET:</th><td>Sets the communications parameters.</td></tr>
<tr><th>LINPUT$:</th><td>Receives a line of data.</td></tr>
<tr><th>TRIG$:</th><td>Transmits data then receives a line of
            data.</td></tr>
</tbody></table>

<p>
Also, the standard <b>LPRINT</b> command can be used.
</p>

<p>
LPRINT, LINPUT$: and TRIG$: can be abandoned
whilst running by pressing <span class="key">ON/CLEAR</span>. This feature
can be disabled by using the ESCAPE OFF command.
</p>

<a id="p8-2"></a>
<p>
The remaining procedures are protocol-based.
</p>

<ul>
<li>They can only be used when the Organiser is
   connected to a computer running the supplied
   program Comms Link.
</li><li>They automatically set Protocol to PSION for the
   duration of their operation. This means that they
   benefit from error checking.
</li></ul>

<p>
If the Organiser is not connected to a computer which
is running Comms Link (for convenience this will be
referred to simply as a PC) the procedure will fail with
a DEVICE READ ERR after a few seconds. When the
procedure finishes, it returns Protocol to whatever
setting it was previously.
</p>

<p>
These are the protocol-based procedures:
</p>

<ol>
<li>File transfer:
<table summary="">
<tbody><tr><th width="110">XTSEND:</th><td>Sends a file to a PC.</td></tr>
<tr><th>XTRECV:</th><td>Receives a file from a PC.</td></tr>
</tbody></table>

</li><li>Remote file access:
<table summary="">
<tbody><tr><th width="110">XFOPEN:</th><td>Opens a file.</td></tr>
<tr><th>XFCLOSE:</th><td>Closes the open file.</td></tr>
<tr><th>XFEOF:</th><td>Returns end of file status.</td></tr>
<tr><th>XFPOS:</th><td>Sets the current file position.</td></tr>
<tr><th>XFGET$:</th><td>Reads data from the open file.</td></tr>
<tr><th>XFPUT:</th><td>Writes data to the open file.</td></tr>
</tbody></table>
</li></ol>

<p>
Don't use any of these names for your own procedures.
Nor any of the following, which are used internally:
</p>

<p>
XLCON: XLDIS: XLPUT: XLGET$: XMLOAD:
</p>

<a id="p8-3"></a>
<h4>LSET:</h4>

<p>
You can change the communications parameters from
within a program - you don't have to leave Prog and go
into the Comms menu to enter the Setup option. Use
LSET:
</p>

<p class="code">LSET:(Baud%,Parity%,Bits%,Stop%,Hand%,
Echo%,Width%,Reol$,Reof$,Rtrn$,Teol$,
Teof$,Ttrn$,Timeout%,Protocol%)</p>

<ul>
<li>The order of the parameters cannot be changed.
</li><li>If you don't want to reset <b>all</b> the communications
   parameters, give the value -1 to the parameters
   you don't wish to change.
</li></ul>

<p>
E.g. <span class="code">  LSET:(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,-1)</span>
<br>
sets TIMEOUT to 3 seconds without affecting the
current setting of any of the other Setup parameters.
</p>

<ul>
<li>If there are <b>trailing</b> parameters which you do not
   wish to change, they may be omitted.
</li></ul>

<p>
E.g. <span class="code">  LSET:(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3)</span>
<br>
has the same effect as the previous example.
</p>

<ul>
<li>However, you can't omit parameters which come
   <b>before</b> a parameter you do want to change in the
   order of the list.
</li><li><b>Omitting all the parameters to LSET: restores
   all the communications parameters to their
   default values.</b>
</li><li>Parameters which are changed by LSET: remain
   changed when the OPL program terminates.
</li></ul>

<a id="p8-4"></a>
<p>
As in Setup, the communications parameters may take
their value only from a list of allowed values. The
values to give the procedure parameters are as follows:
</p>

<table summary="">
<tbody><tr><th width="110">Parameter</th><th>Range</th></tr>
<tr><td>Baud%</td><td>50, 75, 110, 150, 300, 600, 1200, 2400, 4800, 9600</td></tr>
<tr><td>Parity%</td><td>0 (NONE) 1 (ODD) 2 (EVEN) 3 (MARK) 4 (SPACE)</td></tr>
<tr><td>Bits%</td><td>7 (7 BIT DATA) 8 (8 BIT DATA)</td></tr>
<tr><td>Stop%</td><td>1 (1 STOP BIT) 2 (2 STOP BITS)</td></tr>
<tr><td>Hand%</td><td>0 (NONE) 1 (XON) 2 (RTS) 3 (XON+RTS) 4 (DTR) 5 (XON+DTR) 6 (RTS+DTR) 7 (ALL)</td></tr>
<tr><td>Echo%</td><td>0 (LOCAL) 1 (HOST)</td></tr>
<tr><td>Protocol%</td><td>0 (NONE) 1 (XMODEM) 2 (PSION)</td></tr>
</tbody></table>

<p>
E.g. <span class="code">  LSET:(9600,2,8,1)</span>
<br>
sets the communications parameters to 9600 baud,
even parity, 8 data bits and 1 stop bit.
</p>

<p>
For the string parameters any characters represented
on the Organiser keyboard can be entered in quotes
("*", "G"). For any other characters enter their ASCII
code number with the CHR$ function. For a two
character string, separate the characters with a + sign.
A zero length string ("") corresponds to the Setup value
NONE.
</p>

<p>
E.g. <span class="code">  LSET:(-1,-1,-1,-1,, 1,-1,-1,-1,-1,"/"+CHR$(9),-1,-1,CHR$(9)+"/")</span>
<br>
sets Rtrn and Ttrn such that "/" is converted to &lt;TAB&gt;
on input and &lt;TAB&gt; to "/" on output.
</p>

<a id="p8-5"></a>
<h4>LPRINT</h4>

<p>
LPRINT is an OPL command built into the language.
LPRINT has the same syntax as the PRINT command
and operates in the same way, except that output is
transmitted to the connected device instead of to the
display. So LPRINT will fail if there is no other device
connected via Comms Link. PRINT and LPRINT are
described in the Organiser manual.
</p>

<p>
Any occurrences of &lt;CR&gt; and &lt;SUB&gt; are automatically
converted to Teol and Teof sequences respectively. (A
&lt;CR&gt; is added by the LPRINT command if the
command line does not end with a semicolon.)
</p>

<p>
LPRINT ignores the settings of Echo, Protocol, Reol,
Reof and Rtrn, but the transmitted data is subject to
Ttrn processing.
</p>

<h4>LINPUT$:</h4>

<p>
Receives data from the connected device. You must
specify the number of characters you wish to receive,
e.g.
</p>

<p><span class="code">data$=LINPUT$:(n%)</span>
<br>- where <span class="code">n%</span> is an integer in the range 0 to 254.
</p>

<ul>
<li>If <span class="code">n%</span> is 0, any received data is discarded.
</li><li>If <span class="code">n%</span> is non-zero, LINPUT$: returns <span class="code">n%</span> characters.
     If an Reol or Reof is received, only the characters
     up to and including the Reol/Reof are returned.
</li></ul>

<p>
Typically, you might match <span class="code">n%</span> with the length
allocated to data$ when it was declared. If the
Connected device returns less than <span class="code">n%</span> characters, the
<a id="p8-6"></a>LINPUT$: will wait, expecting the remaining characters
to arrive. To avoid this, supply another parameter:
</p>

<p>
<span class="code">data$=LINPUT$:(n%,t%)</span>
<br>
- where <span class="code">t%</span> specifies a timeout in seconds.
</p>

<ul>
   <li>If <span class="code">t%</span> is omitted or given the value zero, LINPUT$
     will wait indefinitely until either an Reol/Reof
     sequence or <span class="code">n%</span> characters are received.
   </li><li>If <span class="code">t%</span> is in the range 1 to 255, LINPUT$: returns
     with either <span class="code">n%</span> characters or as many characters
     as it had received when the timer expired. The
     timer expires when no character has been received
     for the specified time.
</li></ul>

<p>
If you have the choice, it is safer to use a one character
Reol and Reof. A two character Reol/Reof might get
split if the first character of the sequence happens to
arrive as the last character allowed by <span class="code">n%</span>.
</p>

<p>
LINPUT$: ignores the settings of Echo, Protocol, Teol.
Teof, Ttrn and Width.
</p>

<h4>TRIG$:</h4>

<p>
TRIG$: is the same as LINPUT$: except that a string is
first transmitted before waiting for received data.
</p>

<p>
<span class="code">data$=TRIG$:(n%,a$)    </span>or<br>
<span class="code">data$=TRIG$:(n%,t%,a$)</span>
</p>

<p>
The parameters <span class="code">n%</span> and <span class="code">t%</span> are as for LINPUT$: above.
The parameter <span class="code">a$</span> is the string to be transmitted before
waiting for received data. <span class="code">a$</span> is subject to Ttrn
processing. &lt;CR&gt; and &lt;SUB&gt; are automatically
converted to Teol and Teof sequences respectively.
</p>

<a id="p8-7"></a>
<p>
TRIG$: is equivalent to an LPRINT followed by an
LINPUT$:. It is slightly faster. TRIG$: ignores the
setting of Echo and Protocol.
</p>

<h3>File transfer</h3>

<h4>XTSEND: and XTRECV:</h4>

<p>
These have the syntax:
</p>

<p class="code">XTSEND:(remote$,local$,type%)
XTRECV:(remote$,local$,type%)</p>

<p>
XTSEND: sends the Organiser file with file name
<span class="code">local$</span> and of type <span class="code">type%</span> to the PC, giving it the
pathname <span class="code">remote$</span>. Any existing file on the PC of the
same name is replaced.
</p>

<p>
XTRECV: restores the PC file with file name <span class="code">remote$</span>
of type <span class="code">type%</span> to the Organiser, giving the created file
the file name <span class="code">local$</span>. Any existing file on the
Organiser of the same name is replaced.
</p>

<ol>
<li><span class="code">local$</span>
<p>
Include the device name (A:, B: or C:) in the same way
as, for example, the OPL OPEN command. On model
LZ there are the following restrictions on <span class="code">local$</span>:
</p>
<ul>
<li><b>Do not</b> include any wildcards ('*' or '+'). The
   XTSEND: or XTRECV: will definitely fail if you do
   include any. (But see the next section, on DIRW$.)
</li><li><b>Do not</b> include any of the file extensions used by
   DIRW$ (.DIA. .ODB etc.) The XTSEND: or
   XTRECV: will definitely fail if you do include any.
</li></ul>

<a id="p8-8"></a>
</li><li><span class="code">remote$</span>
<p>
May or may not include pathname and file extension.
</p>
<ul>
<li>If you don't include the full pathname, Comms
   Link will look in or send to the directory that was
   current when the Comms Link program was run.
</li><li>If you do want to specify the pathname use "/"
   characters in <span class="code">remote$</span> for "\" characters in the
   pathname: they are translated automatically by
   Comms Link.
</li><li>If you don't include any file extension, Comms
   Link automatically adds the extension appropriate
   for the type you specify in <span class="code">type%</span> (see below).
</li></ul>
<p>
You <b>must</b> include a value for <span class="code">type%</span>.
</p>

</li><li><span class="code">type%</span>
<p>
The parameter types and their default extensions on
the PC are as follows:
</p>

<table summary="">
<tbody><tr><th width="70">type%</th><th>file type</th><th>default PC extension</th></tr>
<tr><td>0        </td><td>data file, LZ diary files (text) </td><td>.ODB</td></tr>
<tr><td>1        </td><td>procedure files (text)           </td><td>.OPL</td></tr>
<tr><td>2        </td><td>XP, CM diary files               </td><td>.OB2</td></tr>
<tr><td>3        </td><td>procedure files                  </td><td>.OB3</td></tr>
<tr><td>4        </td><td>Comms Link setup files           </td><td>.OB4</td></tr>
<tr><td>5        </td><td>Spreadsheet files                </td><td>.OB5</td></tr>
<tr><td>6        </td><td>Pager setup file                 </td><td>.OB6</td></tr>
<tr><td>7        </td><td>LZ Notepad files                 </td><td>.OB7</td></tr>
<tr><td>8-15     </td><td>Unspecified                      </td><td>.OB8-F</td></tr>
<tr><td>16       </td><td>LZ Notepad files (text)          </td><td>.NTS</td></tr>
</tbody></table>

</li></ol>

<a id="p8-9"></a>
<h5>Notes</h5>

<ol>
<li>The extensions of Organiser files held on a PC might
  get changed from those listed above. This doesn't mean
  you can't bring the files back to the Organiser.
<ul>
  <li>For types 0, 1 and 16, rename the file with its
      appropriate extension. Or specify its new extension
      at the From: prompt after selecting Receive.
  </li><li>For types 2-15, Comms Link adds a 6-byte
      identifying header to the file during transmission
      from the Organiser to the PC. Comms Link can
      therefore always identify what type a file on the PC
      is, regardless of its extension.
</li></ul>

</li><li><b>File types 2 to 15</b> produce binary files on the PC.
  These files are not directly usable on the PC, so use
  these type numbers when you want to just backup
  your data. Then use XTRECV: to restore them.
<p>
  <b>File types 0, 1 and 16</b> produce text files on the PC (a
  translation process occurs during the file transfer). The
  files produced can be manipulated directly on the PC.
  For example, you can edit a .OPL procedure file on the
  PC using your normal editor or word processor.
</p>
<p>
  <b>XTSEND: and XTRECV: with file types 0, 1 or 16
  perform the same functions as Transmit and
  Receive in the Comms menu.</b> When you select either
  Transmit or Receive, the menu items presented then
  correspond to these type numbers:
</p>
<table summary="">
<tbody><tr><td>File</td><td>0</td></tr>
<tr><td>Procedure</td><td>1</td></tr>
<tr><td>Notes (on model LZ)&nbsp;&nbsp;&nbsp;</td><td>16</td></tr>
</tbody></table>
<p>
  Procedure files on the Organiser are made up of two
  halves: 'source' code and 'object' code. You can choose
  <a id="p8-10"></a>to transmit either all or just the source (text) part -
  creating either .OPL or .OB3 files on the PC.
</p>
<p>
  On model LZ, you can send a notes file as a binary
  backup, by using 7 for <span class="code">type%</span>, creating a .OB7 file on
  the PC. To create a file that will be editable on the PC,
  use 16 for <span class="code">type%</span> - creating a .NTS file on the PC.
  You can't send password protected notes files. You will
  get a PAK NOT COPYABLE error if you try.
</p>
</li></ol>

<h4>Model LZ: file extensions used in DIRW$ function</h4>

<p>
On the Organiser model LZ, the DIRW$ function allows
you to obtain a directory listing of all the files of a
certain type stored on your Organiser. This function
uses file type extensions. The table below shows how
these extensions correspond to the value for the
<span class="code">type%</span> parameter and to the default PC file extensions.
</p>

<table summary="">
<tbody><tr><th>type%&nbsp;&nbsp;&nbsp;</th><th>file type</th><th>default<br>extension&nbsp;&nbsp;&nbsp;<br>on PC</th><th>extension<br>used for<br>DIRW$</th></tr>
<tr><td>0</td><td>data file or model LZ<br>diary file (text)</td><td>.ODB</td><td>.ODB</td></tr>
<tr><td>1</td><td>procedure file (text)</td><td>.OPL</td><td>.OPL</td></tr>
<tr><td>2</td><td>model XP/CM diary files</td><td>.OB2</td><td>.DIA</td></tr>
<tr><td>3</td><td>procedure file</td><td>.OB3</td><td>.OPL</td></tr>
<tr><td>4</td><td>Comms Link setup file</td><td>.OB4</td><td>.COM</td></tr>
<tr><td>5</td><td>Pocket Spreadsheet file</td><td>.OB5</td><td>.PLN</td></tr>
<tr><td>6</td><td>Pager setup file</td><td>.OB6</td><td>.PAG</td></tr>
<tr><td>7</td><td>Notepad files</td><td>.OB7</td><td>.NTS</td></tr>
<tr><td>8-15</td><td>Unspecified</td><td>.OB8-F</td><td>.TY8-F</td></tr>
<tr><td>16</td><td>LZ Notepad files (text)</td><td>.NTS</td><td>.NTS</td></tr>
</tbody></table>

<a id="p8-11"></a>
<p>
Because you can't use wildcards in <span class="code">local$</span> in
XTSEND: or XTRECV:, it would seem that you are
limited to sending only one file at a time. But with a
combination of DIRW$ and a loop, you can provide
successive file names of the required type for <span class="code">local$</span>,
and so send all the files of that type.
</p>

<p>
The example program below illustrates this. Note that
it is necessary to:
</p>

<ul>
 <li>Remove the file extension from the string returned
   by DIRW$, so that the file name is acceptable for
   <span class="code">local$</span>.
 </li><li>Use this file extension to find out the correct type
   number to be given to <span class="code">type%</span>.
</li></ul>

<p>
A null string ("") is provided for the remote file name
in XTSEND:. XTSEND: automatically gives the file on
the PC the name <span class="code">local$</span>, with the PC extension
appropriate for <span class="code">type%</span>.
</p>

<p class="program">Sendall:
LOCAL remote$(8),local$(14),b$(4)
LOCAL type%,len%
local$=DIRW$("A:*.*")
WHILE local$&lt;&gt;""
   b$=RIGHT$(local$,4)
   len%=LEN(local$)-4
   local$=LEFT$(local$,len%)
   remote$=RIGHT$(local$,(len%-2))
   IF b$=".ODB"
      type%=0
   ELSEIF b$=".OPL"
      type%=1
   ELSEIF b$=".DIA"
      type%=2
   ELSEIF b$=".COM"
<a id="p8-12"></a>      type%=4
   ELSEIF b$=".PLN"
      type%=5
   ELSEIF b$=".PAG"
      type%=6
   ELSEIF b$=".NTS"
      type%=7
   ENDIF
   PRINT "Send",local$;b$
   XTSEND:(remote$,local$,type%)
   local$=DIRW$("")
ENDWH
CLS :PRINT "Job done" :GET</p>

<p>
If you want to send procedure and notepad files as
binary instead of text, change <span class="code">type%=1</span> to <span class="code">type%=3</span>
and <span class="code">type%=7</span> to <span class="code">type%=16</span>. A program to restore all
Organiser files from the PC would have to sort out
which files in the directory are Organiser type files. To
do this, you could use XFGET$: to read the directory.
</p>

<h3>Remote file access</h3>

<h4>XFOPEN: and XFCLOSE:</h4>

<p>
You can access files on an attached computer <b>only
one at a time</b>. XFOPEN: opens a file, but XFCLOSE:
must be used before:
</p>

<ul>
 <li>Another file can be opened with XFOPEN:
 </li><li>Another file can be transferred using XTRECV: or
      XTSEND:
</li></ul>

<p>
The procedure will fail with the FILE IN USE error if a
remote file is already open.
</p>

<a id="p8-13"></a>
<p>
XFCLOSE: has no parameters and is harmless; it
reports no error if there is no open file.
</p>

<p>
XFOPEN: has the syntax:
</p>

<p><span class="code">XFOPEN:(remote$,amode%,ftype%)</span>
<br>
- where <span class="code">remote$</span> is the pathname of the file on the
PC, <span class="code">amode%</span> specifies the file access mode, and
<span class="code">ftype%</span> specifies the remote file type.
</p>

<ol>
<li><span class="code">remote$</span> may give either:

<ul>
 <li>Just the file name, in which case files are sent/
   looked for in the directory which was current when
   Comms Link was run.
</li></ul>

<p>
 or
</p>

<ul>
 <li> The full pathname (see the sections in the relevant
   Chapters on specifying pathnames, folder and file
   names on PCs and Macintoshes).
</li></ul>

</li><li><span class="code">ftype%</span> may be one of the following:

<table summary="">
<tbody><tr><td width="70">0</td><td>BINARY</td></tr>
<tr><td>1</td><td>TEXT</td></tr>
<tr><td>2</td><td>DIRECTORY</td></tr>
</tbody></table>

<p>
<b>Binary files</b> are random access files which consist of a
byte stream and have no record structure.
</p>

<p>
<b>Text files</b> are variable-length record sequential files.
Where each record normally contains characters with
ASCII codes greater than 31 (although this is not
enforced). The maximum record length (excluding any
record terminator) is 254 bytes - the maximum string
length in OPL. On the PC, it is assumed each record
ends with &lt;CR&gt;&lt;LF&gt;.
</p>

<a id="p8-14"></a>
<p>
<b>Directory files</b> behave like sequential files which may
be read only. The path name remote$ specifies a
normal PCDOS directory search string - e.g. you could
give <span class="code">remote$</span> the value <span class="code">C:/dirA/tools/*.doc</span>
(the / character is automatically translated to \ during
transfer.) Each record in a directory file is the name of
one file found in the path and directory given in
<span class="code">remote$</span>. When the last record has been accessed
and "EOF" returned, the file is <b>automatically</b> closed.
</p>

</li><li><span class="code">amode%</span> specifies one of the five modes in which a file
may be opened. When <span class="code">ftype%</span> is 2, XFOPEN: will fail
unless <span class="code">amode%</span> is 0 - i.e. you can only read, not write
to, a Directory file. When <span class="code">ftype%</span> is either 0 or 1, any
of the values of <span class="code">amode%</span> listed below are valid.<br>&nbsp;

<table summary="">
<tbody><tr><td width="70">0</td><td>READ</td></tr>
<tr><td>1</td><td>CREATE/REPLACE</td></tr>
<tr><td>2</td><td>REPLACE</td></tr>
<tr><td>3</td><td>CREATE</td></tr>
<tr><td>4</td><td>UPDATE</td></tr>
</tbody></table>

<p>
READ - the remote file is opened for reading only.
XFOPEN: will fail only if the file cannot be found.
</p>

<p>
CREATE/REPLACE - a new file is created for reading
and writing. Any existing file of the same name is
deleted.
</p>

<p>
REPLACE - behaves as for CREATE/REPLACE except
that it will fail if the file does not already exist.
</p>

<p>
CREATE - behaves as for CREATE/REPLACE except
that it will fall if the file already exists.
</p>

<p>
UPDATE - the file is opened for reading and writing.
XFOPEN: will fail if the file does not already exist. The
following, conditions apply:
</p>

<a id="p8-15"></a>
<ul>
<li>When <span class="code">ftype%</span> is 1, the file is opened at the <b>end</b>
   of the file, allowing records to be appended to the
   file.
</li><li>When <span class="code">ftype%</span> is 0, the file is opened at the
   <b>beginning</b> of the file and you may read and write
   to the file.
</li></ul>

</li></ol>

<h4>XFEOF:</h4>

<p>
XFEOF: tells you whether you are at the end of a file or
not. XFEOF: returns zero (false) if a file is open and
non-zero (true) if a file is closed.
</p>

<p>
<b>A file closes automatically when you have read its
final bytes.</b>
</p>

<h4>XFPOS:</h4>

<p>
XFPOS: sets the <b>current</b> file position and returns the
new position. It will work only with binary files - i.e. it
will fail if <span class="code">ftype%</span> was not 0 in XFOPEN:. The syntax
is:
</p>

<p><span class="code">newpos=XFPOS:(mode%,pos)</span>
</p>

<p>
<span class="code">mode%</span> and <span class="code">pos</span> specify the new position. <span class="code">mode%</span>
determines what the movement is relative to:
</p>

<p>
0     Relative to the start of the file
1     Relative to the current position
2     Relative to the end of the file
</p>

<p>
<span class="code">pos</span> specifies the number of bytes to move along, e.g.
setting <span class="code">pos</span> to 155 would move the current position
155 bytes. A negative number means going backwards.
<span class="code">pos</span> is a floating point number, since this lets you
quote numbers greater than the 32768 limit on
<a id="p8-16"></a>integers. Making <span class="code">pos</span> zero leaves the current position
unchanged.
</p>

<h4>XFGET$:</h4>

<p>
The XFGET$: procedure reads data from the current
position in the file and returns the data as a string
The syntax is:
</p>

<p><span class="code">data$=XFGET$:(len%)</span>
<br>- where the returned string is of length <span class="code">len%</span> or less.
The parameter <span class="code">len%</span> may be between 0 and 255
(bytes) inclusive.
</p>

<p>
If the file is a binary file (<span class="code">ftype%</span> was 0 in XFOPEN:)
XFGET$: reads <span class="code">len%</span> bytes from the file and advances
the file position by <span class="code">len%</span> bytes. Unless the end of file is
reached, the returned string is of length <span class="code">len%</span>.
</p>

<p>
When an end of file is encountered, less than <span class="code">len%</span>
bytes may be read and a string which is shorter than
<span class="code">len%</span> will be returned. The file is then closed and the
XFEOF: procedure will return non-zero (true).
</p>

<p>
If the file is a text file or a directory file (i.e. <span class="code">ftype%</span>
was 1 or 2 in XFOPEN:) XFGET$: reads a single record
from the file (provided it is not longer than the value
specified by <span class="code">len%</span>) and positions to the next record.
The returned record data does not include the
&lt;CR&gt;&lt;LF&gt; end of record sequence.
</p>

<p>
If XFGET$: is called alter the last record has been
read, an error is returned - since the file has
automatically been closed. In your program it is
sensible to call the XFEOF: procedure before any
attempt to read a file, to see whether you are at the
<a id="p8-17"></a>end of the file yet. The program at the end of this
Chapter shows this.
</p>

<h4>XFPUT:</h4>

<p>
The XFPUT: procedure writes data to the current
position in the open file on the PC. The syntax is:
</p>

<p>
<span class="code">XFPUT:(data$)</span>
</p>

<p>
XFPUT: will fail if the file is open for reading only (i.e.
<span class="code">amode%</span> was 0 in XFOPEN:).
</p>

<p>
When the file is a text file (<span class="code">ftype%</span> was 1 in XFOPEN:),
you may append an existing file or begin a new file:
</p>

<ul>
<li>If <span class="code">amode%</span> was 4 (you are updating) a new record
   is appended to the file. No &lt;CR&gt;&lt;Lb is added to
   the end of the record.
</li><li>If <span class="code">amode%</span> was 1, 2 or 3, you write to the start of a
   new file.
</li></ul>

<p>
XFPUT: positions to the end of the string it inserted.
</p>

<h4>Errors</h4>

<p>
If an error occurs in any of the Comms Link
procedures, an error is 'raised' in the normal way. See
the Organiser manual for a description of OPL
error-handling facilities.
</p>

<p>
When using the protocol-based procedures (those
beginning with an X) the error may be generated by the
software on the PC (the server) rather than on the
Organiser. For example, the server might fall with a
DISK FULL error. When this happens, the error
number will have a value from 190 downwards and an
<a id="p8-18"></a>error message will be displayed on the PC screen. But
there are no error messages stored in the Organiser
corresponding to these error numbers, so although the
OPL function ERR will correctly return the error
number, ERR$ will return only "***ERROR***" rather
than a specific error message.
</p>

<p>
If the OPL program does not trap errors, the program
will terminate when an error occurs, displaying an
error message which corresponds to the error number.
</p>

<p>
If you do trap errors (using the TRAP and ONERR
commands) you can arrange for an informative error
message to be displayed, not just the error number, by
looking up what error has the given number in the list
below and printing the relevant message to the screen.
</p>

<p>
<b>185</b> (RECORD TOO LONG) - XTRECV: or XFGETS:
failed while reading a record which is longer than the
maximum record length specified by <span class="code">len%</span>.
</p>

<p>
<b>186</b> (DISK FULL) - XTSEND: or XFPUT: failed to find
room on the remote disk.
</p>

<p>
<b>187</b> (FILE ALREADY EXISTS) - <span class="code">amode%</span> is 3 and the
tile with pathname remote$ already exists.
</p>

<p>
<b>188</b> (SERVER ERROR) - a miscellaneous server error
has occurred, e.g. a disk door was open.
</p>

<p>
<b>189</b> (FILE NOT FOUND) - XTRECV: or XFGETS: could
not find the file with pathname <span class="code">remote$</span> or the file
with that name is of the wrong type: <span class="code">amode%</span> is 0, 2 or
4 and XFOPEN: could not find the file with pathname
<span class="code">remote$</span>.
</p>

<p>
<b>190</b> (BAD PARAMETER) - the pathname <span class="code">remote$</span> is
illegal or <span class="code">amode%</span> or <span class="code">ftype%</span> is invalid.
</p>

<a id="p8-19"></a>
<h3>Example procedures</h3>

<p>
All these procedures work only with a computer
running the Comms Link program.
</p>

<h4>Backing up diary files</h4>

<p>
For models CM and XP only. To transfer LZ diary files
simply select Transmit from the Comms menu and
then select File as the file type.
</p>

<p>
When the following procedure is rum it presents a
two-item menu: Backup or Restore. When you have
made your selection it prompts for the local (Organiser)
and remote (PC/Macintosh) file names, in the
appropriate order. For the local name, you should
enter the device (A:, B: or C: with its colon) and the
saved diary file name.
</p>

<p>
To save the current contents of the diary to a file use
the Save option in the Diary menu (see the Organiser
manual for more details).
</p>

<p>
Pressing <span class="key">ON/CLEAR</span> during the input stage will
abandon the program.
</p>

<p class="program">
DBACK:
LOCAL lname$(8),rname$(8),m%
m%=MENU("Backup,Restore")
IF m%=1
   PRINT "From:";
   TRAP INPUT lname$
   IF ERR:206 :RETURN :ENDIF
   PRINT "To:";
   TRAP INPUT rname$
   IF ERR=206 :RETURN :ENDIF
   XTSEND:(rname$,lname$,2)
ELSEIF m%=2
<a id="p8-20"></a>   PRINT "TO:";
   TRAP INPUT lname$
   IF ERR=206 :RETURN :ENDIF
   PRINT "From:";
   TRAP INPUT rname$
   IF ERR=206 :RETURN :ENDIF
   XTRECV:(rname$,lname$,2)
ENDIF</p>

<h4>File transfer via a modem</h4>

<p>
This procedure shows how to log on to a HAYES
modem. The procedure has been broken into sections
only to make the commentary easier; it should be
entered consecutively.
</p>

<p>
The first section sets the parameters settings to those
suitable for communicating with the modem:
</p>

<p class="program">COMM:
LOCAL a$(254),i%
LSET:(1200,0,8,1,0,-1,-1,chr$(13)+chr$(10),
   chr$(26),"",chr$(13),chr$(26),"",10,0)
REM 1200 baud,no parity,8 bit,1 stop,no hand
REM reol=&lt;cr&gt;&lt;lf&gt;,reof=&lt;sub&gt;
REM teol=&lt;cr&gt;,teof=&lt;sub&gt;
REM no translates,timeout=10,protocol:none
</p>

<p>
The next section clears the Organisers receive buffer of
all characters, including error characters. It does this
by assigning characters from the buffer to <span class="code">a$</span> then
overwriting this value with another chunk of
characters. When no characters are left in the buffer
the empty string is assigned to <span class="code">a$</span>, the loop breaks and
continues with the next section of the procedure.
</p>

<p class="program">
REM clear buffer
ONERR jnk::
WHILE 1
<a id="p8-21"></a>JNK::
   a$=LINPUT$:(254,1)
   IF a$="" :BREAK :ENDIF
ENDWH
ONERR OFF</p>

<p>
The next section logs on to the modem. Firstly the
command is sent to the modem with TRIG$: to reset
itself: ATZ&lt;CR&gt;&lt;LF&gt;. The following LINPUT$: ((1))
overwrites the modem's echo of this command with its
confirmation (OK&lt;CR&gt;&lt;LF&gt;) that it has reset itself. The
next TRIG$: tells the modem to dial up number 237
(replace with the number you wish to dial). The next
LINPUT$: ((2)) overwrites the echo of this command with
the &lt;CR&gt;&lt;LF&gt; which the modem sends when it has got
through to the computer at the other end (it is allowed
120 seconds to do this). Because &lt;CR&gt;&lt;LF&gt; is the Reol
sequence, and the Reol sequence always forces the end
of the LINPUT$:, another LINPUT$: ((3)) is needed to
capture the modem's response.
</p>

<p class="program">
a$=TRIG$:(254,10,"ATZ"+CHR$(13))
a$=LINPUT$:(254,10)                          (1)
IF a$="OK"+CHR$(13)+CHR$(10)
   a$=TRIG$:(254,10,"ATD237"+CHR$(13))
   a$=LINPUT$:(254,120)                      (2)
   a$=LINPUT$:(254,10)                       (3)
   IF a$="CONNECT"+CHR$(13)+CHR$(10) OR
         a$="CONNECT 1200"+CHR$(13)+CHR$(10)
      XTSEND:("COMM","COMM",1)
      PRINT "sent ok"
   ELSEIF a$="NO CARRIER"+CHR$(13)+CHR$(10)
      PRINT "Cant find"
      PRINT "remote modem"
   ENDIF
   GET
ENDIF</p>

<a id="p8-22"></a>
<p>
Once it is confirmed at (3) that the correct response
(CONNECT&lt;CR&gt;&lt;LF&gt; or CONNECT 1200&lt;CR&gt;&lt;LF&gt;)
has been returned, you are safely linked up to the PC
or Macintosh and can send and receive as many files
as you want.
</p>

<p>
N.B. The string operation for recognising the modem's
responses "CONNECT", "CONNECT 1200", "OK" and
"NO CARRIER" is case dependent.
</p>

<p>
This procedure simply sends a copy of itself to the
other computer. One way to make the program easier
to use would be to replace <span class="code">"COMM"</span> in the XTSEND:
with a parameter which you pass to the procedure
from another procedure, which prompts you for the
names of the files you wish to transfer or receive, say.
</p>

<p>
For specialist applications only, a device driver for the
IBM PC/XT/AT is available by contacting:
</p>

<p>
PSION Technical Support
<br>PSION House
<br>Harcourt Street
<br>London W1H IDT
</p>

<h4>Opening and reading a binary file</h4>

<p>
This procedure simply opens a file, reads a series of
strings from it (up to 10 strings, each 80 bytes long)
and then closes the file. Before each read it checks
that the end of the file has not yet been reached. If an
error occurs on the PC or Macintosh the appropriate
error number is printed to the Organiser screen.
</p>

<p class="program">READ:
LOCAL b$(10,80),i%
i%=1
<a id="p8-23"></a>ONERR panic::
XFOPEN:("remote.doc",0,0)
WHILE 1
   b$(i%)=XFGET$:(80)
   IF XFEOF:
      BREAK
   ENDIF
   i%=i%+1
   IF i%=11
      PRINT "Too many records"
      GET
      CLS :BREAK
   ENDIF
ENDWH
XFCLOSE:
panic::
IF ERR&lt;=190
   PRINT "Remote error"
   PRINT "number",ERR
ELSE PRINT ERR$(ERR)
ENDIF
GET</p>

<hr>

<a id="pA-1"></a>
<a id="pA"></a><h2>
Appendix A
<br>ASCII control
characters
</h2>

<p>
The names of the ASCII control characters are shown
below. For the full printable ASCII character set, see
the relevant Appendix in the Organiser manual.
</p>


<table summary="">
<tbody><tr><td width="50">0  </td><td>NUL</td><td width="80" rowspan="16"></td><td width="50">16</td><td>DLE</td></tr>
<tr><td>1  </td><td>SOH</td><td>17</td><td>DC1 (XON) </td></tr>
<tr><td>2  </td><td>STX</td><td>18</td><td>DC2       </td></tr>
<tr><td>3  </td><td>ETX</td><td>19</td><td>DC3 (XOFF)</td></tr>
<tr><td>4  </td><td>EOT</td><td>20</td><td>DC4       </td></tr>
<tr><td>5  </td><td>ENQ</td><td>21</td><td>NAK       </td></tr>
<tr><td>6  </td><td>ACK</td><td>22</td><td>SYN       </td></tr>
<tr><td>7  </td><td>BEL</td><td>23</td><td>ETB       </td></tr>
<tr><td>8  </td><td>BS </td><td>24</td><td>CAN       </td></tr>
<tr><td>9  </td><td>HT </td><td>25</td><td>EM        </td></tr>
<tr><td>10 </td><td>LF </td><td>26</td><td>SUB       </td></tr>
<tr><td>11 </td><td>VT </td><td>27</td><td>ESC       </td></tr>
<tr><td>12 </td><td>FF </td><td>28</td><td>FS        </td></tr>
<tr><td>13 </td><td>CR </td><td>29</td><td>GS        </td></tr>
<tr><td>14 </td><td>SO </td><td>30</td><td>RS        </td></tr>
<tr><td>15 </td><td>SI </td><td>31</td><td>US        </td></tr>
<tr><td colspan="5">&nbsp;</td></tr>
<tr><td>127</td><td>DEL</td><td colspan="3"></td></tr>
</tbody></table>

<hr>

<a id="pB-1"></a>
<a id="pB"></a><h2>
Appendix B
<br>The Comms Link
interface
</h2>

<p>
This Appendix describes the hardware interface which
is presented by the Comms Link cable and contains
technical information which may be required for
advanced communications applications or for building
your own adaptor.
</p>

<h4>DCE interface</h4>

<p>
The Organiser presents an interface suitable for
connecting easily to another computer, since this is
what the majority of users require. This interface is
actually like a modem's - i.e. a DCE, as defined by the
RS232 standard.
</p>

<p>
The RS232 standard is based on the assumption that
communicating devices communicate via a pair of
modems, as in figure 1.
</p>

<p class="indent"><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/commdia1.gif" alt="Connecting via Modems" width="322" height="173"><br>
Figure 1: connecting via modems
</p>

<a id="pB-2"></a>
<p>
In the RS232 standard;
</p>

<ul>
 <li>DTE stands for Data Terminal Equipment<br>
   (Computers and some printers)
 </li><li>DCE stands for Data Communications Equipment<br>
   (modems).
</li></ul>

<p>
If the DCE and DTE have standard RS232 sockets, the
DTE will have a 25 pin D-type male connector and the
DCE will have the corresponding female connector. The
RS232 cable between the two is a regular 'straight
through' connector which is male at one end and
female at the other. (In fact, you only need a cable at
all because the connectors are usually mounted on the
chassis of the equipment and cannot be physically
brought together.)
</p>

<p>
In practice, the RS232 standard is often used over
short distances where there is no need for a pair of
modems and the computers (or DTEs) are connected
'back to back' - as in the figure below.
</p>

<p class="indent"><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/commdia2.gif" alt="Direct Connection" width="279" height="58"><br>
Figure 2: direct connection</p>

<p>
The cable between the DTEs is not a simple 'straight
through' cable, as exists between the DCE (modem)
and DTE (computer) in figure 1. The cable in figure 2
replaces the pair of modems and is called a 'null
modem cable'. A standard null modem cable is female
at both ends and is wired to simulate the effect of a
modem link.
</p>

<a id="pB-3"></a>
<p>
In the Organiser a null modem cable is 'built in' such
that the Comms Link cable will plug directly into most
computers without requiring additional leads or
adaptors. So to a DTE (e.g. a computer] the Organiser
25 pin D-type female connector emulates a DCE
(modem) interface.
</p>

<p>
Emulating a DCE works when the Organiser is
connecting to a DTE conforming strictly to the RS232
standard - which includes most computers and some
printers. For example, the IBM PC/XT and most
compatibles conform to the standard, and the Comms
Link connecter will plug directly into these computers.
However, the IBM AT and Apple Macintosh, for
example, use 9 pin connectors. Other DTEs,
particularly printers, may use a standard 25 pin
connector but with a non-standard gender (female
rather than male).
</p>

<p>
When the device you are trying to connect to does not
present a 25 pin male UTE interface, either because it
is a non-standard DTE or a DCE, you need an adaptor.
</p>

<h3>Adaptors</h3>

<p>
An adaptor consists of two connectors which are wired
back to back. One of the connectors is a 25 pin D-type
male connector which plugs into the female connector
on the Comms Link cable; the other end of the adaptor
plugs into your computer, printer or modem. According
to the application, the wiring between the connectors
may:
</p>
<ul>
<li>Swap some lines
</li><li>Exclude unnecessary connections
</li><li>Correct for any non-standard pin assignments.
</li></ul>

<a id="pB-4"></a>
<h5>Organiser pin assignments</h5>

<p>
Although there are 25 pins on the D-type socket, only
eight are connected through to the Organiser. Because
the built-in null modem cable swaps the active lines, it
is easy to get confused about the names of the lines,
depending on whether you are looking from the
Organiser's or the DTE's point of view. Figure 3 shows
the pin assignments on the Comms Link socket, the
signal names from both points of view and the
direction of signal flow for each pin.
</p>

<table summary="">
<tbody><tr><th colspan="2">Organiser</th><th></th><th>DTE</th></tr>
<tr><th>pin&nbsp;&nbsp;&nbsp;&nbsp;</th><th>pin no.</th><th></th><th>pin</th></tr>
<tr><td>FG </td><td>1 </td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connection.gif" alt="--" width="100" height="10"></td><td>FG</td></tr>
<tr><td>SG </td><td>7 </td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connection.gif" alt="--" width="100" height="10"></td><td>SG</td></tr>
<tr><td>RD </td><td>2 </td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connleft.gif" alt="&lt;-" width="100" height="10"></td><td>TD</td></tr>
<tr><td>TD </td><td>3 </td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connrght.gif" alt="-&gt;" width="100" height="10"></td><td>RD</td></tr>
<tr><td>CTS</td><td>4 </td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connleft.gif" alt="&lt;-" width="100" height="10"></td><td>CTS</td></tr>
<tr><td>RTS</td><td>5 </td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connrght.gif" alt="-&gt;" width="100" height="10"></td><td>RTS</td></tr>
<tr><td>DSR</td><td>20</td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connleft.gif" alt="&lt;-" width="100" height="10"></td><td>DSR</td></tr>
<tr><td>DTR</td><td>6 </td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connrght.gif" alt="-&gt;" width="100" height="10"></td><td>DTR</td></tr>
</tbody></table>

<p>
Figure 3: pin assignments
</p>

<table summary="">
<tbody><tr><th colspan="2">Key</th><td></td></tr>
<tr><td>FG </td><td>Frame Ground (earth)</td><td></td></tr>
<tr><td>SG </td><td>Signal Ground (common return)</td><td></td></tr>
<tr><td>TD </td><td>Transmitted Data    </td><td>\ carry the data signals</td></tr>
<tr><td>RD </td><td>Received Data       </td><td>/</td></tr>
<tr><td>RTS</td><td>Request To Send     </td><td>\ control RTS/CTS handshaking</td></tr>
<tr><td>CTS</td><td>Clear To Send       </td><td>/</td></tr>
<tr><td>DTR</td><td>Data Terminal Ready </td><td>\ control DTR/DSR handshaking</td></tr>
<tr><td>DSR</td><td>Data Set Ready.     </td><td>/</td></tr>
</tbody></table>

<a id="pB-5"></a>
<p>
Although the Organiser can read pin 20 (DSR), it
cannot drive pin 6 (DTR). However, pin 6 is connected
to pin 20 via the Organiser so that if the DTE drives
pin 20 it will see an 'asserted' pin 6.
</p>

<p>
Pin 20 on the Organiser is connected so that it has the
same effect as the <span class="key">ON/CLEAR</span> key. The Organiser can
be switched on by asserting pin 20 and it will not
switch off while pin 20 is held high. The main
application of this feature is when the Organiser is
connected to an auto-answer modem which is waiting
to be dialled (see below).
</p>

<h5>Computers with a non-standard connector</h5>

<p>
If the connector on your computer is a 25 pin female,
rather than a male, you need a male-to-male gender
changer. Gender changers which connect all 25 lines
are widely available. If you make your own, you need
only connect, with no swapping, the 8 pins (1-7 and
20) used by the Organiser. Psion supplies a suitable
gender changer in the form of the printer adaptor
described below.
</p>

<p>
If the connector is not a standard 25 pin D-type, you
could buy a modem cable. This would be a suitable
adaptor for the Organiser, and would double as a
modem adapter for your computer.
</p>

<p class="indent"><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/commdia4.gif" alt="Modem cable" width="348" height="100"></p>

<p>
If you want to build your own adaptor, start with a 25
pin male connector and a connector which plugs into
your computer. Then match the names in the right
<a id="pB-6"></a>hand column of figure 3 with the correspondingly
labelled pins on the RS232 interface on your computer.
Your computer manual (or the manual which came
with your serial card) should have a diagram which
gives the pin assignments.
</p>

<p>
<b>The IBM AT</b> uses a 9 pin miniature D type male
connector. Psion supplies an adapter for the IBM AT
which is based on figure 4.

</p><table summary="">
<tbody><tr><th colspan="2">Organiser<br>(25 pin male)</th><th></th><th colspan="2">IBM AT<br>(9 pin female)</th></tr>
<tr><th>pin&nbsp;&nbsp;&nbsp;&nbsp;</th><th>pin no.</th><th></th><th>pin no.</th><th>pin</th></tr>
<tr><td>RD </td><td>2 </td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connleft.gif" alt="&lt;-" width="100" height="10"></td><td>3</td><td>TD</td></tr>
<tr><td>TD </td><td>3 </td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connrght.gif" alt="-&gt;" width="100" height="10"></td><td>2</td><td>RD</td></tr>
<tr><td>CTS</td><td>4 </td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connleft.gif" alt="&lt;-" width="100" height="10"></td><td>7</td><td>RTS</td></tr>
<tr><td>RTS</td><td>5 </td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connrght.gif" alt="-&gt;" width="100" height="10"></td><td>8</td><td>CTS</td></tr>
<tr><td>DTR</td><td>6 </td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connrght.gif" alt="-&gt;" width="100" height="10"></td><td>6</td><td>DSR</td></tr>
<tr><td>SG </td><td>7 </td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connection.gif" alt="--" width="100" height="10"></td><td>5</td><td>SG</td></tr>
<tr><td>DSR</td><td>20</td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connleft.gif" alt="&lt;-" width="100" height="10"></td><td>4</td><td>DTR</td></tr>
</tbody></table>

<p>
Figure 4: IBM AT adaptor
</p>

<p>
<b>Apple Macintosh</b> uses a 9-pin miniature D-type
female connector. The Mac Plus has a different
connector, but an adaptor which presents the same
interface as the regular Macintosh is normally supplied
with the Mac Plus. Psion supplies an adaptor for the
Apple Macintosh which is based on figure 5.
</p>

<table summary="">
<tbody><tr><th colspan="2">Organiser<br>(25 pin male)</th><th></th><th colspan="2">Macintosh<br>(9 pin male)</th></tr>
<tr><th>pin&nbsp;&nbsp;&nbsp;&nbsp;</th><th>pin no.</th><th></th><th>pin no.</th><th>pin</th></tr>
<tr><td>RD </td><td>2 </td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connleft.gif" alt="&lt;-" width="100" height="10"></td><td>3</td><td>TD</td></tr>
<tr><td>TD </td><td>3 </td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connrght.gif" alt="-&gt;" width="100" height="10"></td><td>9</td><td>RD</td></tr>
<tr><td>CTS</td><td>4 </td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connleft.gif" alt="&lt;-" width="100" height="10"></td><td>6</td><td>DTR</td></tr>
<tr><td>RTS</td><td>5 </td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connrght.gif" alt="-&gt;" width="100" height="10"></td><td>7</td><td>DSR</td></tr>
<tr><td>SG </td><td>7 </td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connection.gif" alt="--" width="100" height="10"></td><td>3,4</td><td>SG,TD</td></tr>
</tbody></table>

<p>
Figure 5: Apple Macintosh adaptor
</p>

<a id="pB-7"></a>
<p>
The Macintosh hardware does not support the RTS
and CTS lines, but it does support DSR/DTR
handshaking in the sense that the Macintosh can be
paused when it sees its DSR asserted (DTR on the
Macintosh is a constant +12 Volts or SPACE state).
Since the Organiser cannot drive DTR, DSR/DTR is
swapped to RTS/CTS on the Macintosh adaptor so
that hardware handshaking will take place if the
Organiser has RTS/CTS handshaking enabled.
</p>

<h5>Connecting to a Printer</h5>

<p>
Many printers present a DTE connector, but female
rather than male. In these cases a gender changer will
often suffice. However, some printers also require DCD
(Data Carrier Detect) to be asserted. A printer adaptor
can do this by connecting pin 8 to pin 5. The printer
adaptor supplied by Psion is based on figure 6 and is
<b>reversible</b>.
</p>

<table summary="">
<tbody><tr><th colspan="2">Organiser<br>(25 pin male)</th><th></th><th colspan="2">Printer (as DTE)<br>(25 pin male)</th></tr>
<tr><th>pin&nbsp;&nbsp;&nbsp;&nbsp;</th><th>pin no.</th><th></th><th>pin no.</th><th>pin</th></tr>
<tr><td>FG </td><td>1 </td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connection.gif" alt="--" width="100" height="10"></td><td>1</td><td>FG</td></tr>
<tr><td>RD </td><td>2 </td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connleft.gif" alt="&lt;-" width="100" height="10"></td><td>2</td><td>TD</td></tr>
<tr><td>TD </td><td>3 </td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connrght.gif" alt="-&gt;" width="100" height="10"></td><td>3</td><td>RD</td></tr>
<tr><td>CTS</td><td>4 </td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connleft.gif" alt="&lt;-" width="100" height="10"></td><td>4</td><td>RTS</td></tr>
<tr><td>RTS</td><td>8,5</td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connrght.gif" alt="-&gt;" width="100" height="10"></td><td>5,8</td><td>CTS+DTD</td></tr>
<tr><td>DTR</td><td>6 </td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connrght.gif" alt="-&gt;" width="100" height="10"></td><td>6</td><td>DSR</td></tr>
<tr><td>SG </td><td>7 </td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connection.gif" alt="--" width="100" height="10"></td><td>7</td><td>SG</td></tr>
<tr><td>DSR</td><td>20</td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connleft.gif" alt="&lt;-" width="100" height="10"></td><td>20</td><td>DTR</td></tr>
</tbody></table>

<p>
Figure 6: Printer adaptor
</p>

<h5>Connecting to a Modem</h5>

<p>
To connect the Comms Link interface to a modem, or
to another Organiser, you need to swap the signal lines
from a DCE interface to a DTE interface (a DCE can't
<a id="pB-8"></a>connect directly with another DCE.) The other
connections in your adaptor depend on whether you
want to originate Calls on the Organiser or if you want
to have an auto-answer modem.
</p>

<p>
(a)
If you wish to dial from the Organiser, you have to stop
the modem from expecting the DTR line to be driven,
since the Organiser cannot drive this line. There
should be a configuration switch on the modem to do
this. The modem will then assume it is always
connected to a DTE.
</p>

<p>
For simple modem use, it is advisable that pins 6 and
20 are not connected, as in the adaptor which Psion
supplies, based on figure 7 below.
</p>

<table summary="">
<tbody><tr><th colspan="2">Organiser<br>(25 pin male)</th><th></th><th colspan="2">Modem<br>(25 pin male)</th></tr>
<tr><th>pin&nbsp;&nbsp;&nbsp;&nbsp;</th><th>pin no.</th><th></th><th>pin no.</th><th>pin</th></tr>
<tr><td>FG </td><td>1 </td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connection.gif" alt="--" width="100" height="10"></td><td>1</td><td>FG</td></tr>
<tr><td>RD </td><td>2 </td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connleft.gif" alt="&lt;-" width="100" height="10"></td><td>3</td><td>RD</td></tr>
<tr><td>TD </td><td>3 </td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connrght.gif" alt="-&gt;" width="100" height="10"></td><td>2</td><td>TD</td></tr>
<tr><td>CTS</td><td>4 </td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connleft.gif" alt="&lt;-" width="100" height="10"></td><td>5</td><td>CTS</td></tr>
<tr><td>RTS</td><td>5 </td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connrght.gif" alt="-&gt;" width="100" height="10"></td><td>4</td><td>RTS</td></tr>
<tr><td>DTR</td><td>6 </td><td></td><td>20</td><td>DTR</td></tr>
<tr><td>SG </td><td>7 </td><td><img src="./Comms Link Manual - Jaap&#39;s Psion Organiser II Page_files/connection.gif" alt="--" width="100" height="10"></td><td>7</td><td>SG</td></tr>
<tr><td>DSR</td><td>20</td><td></td><td>6</td><td>DSR</td></tr>
</tbody></table>


<p>
Figure 7: Modem adaptor
</p>

<p>
(b)
You may wish to connect the Organiser to an
auto-answer modem so that the Organiser can wait in
an 'off' state (where it uses very little power) and be
woken up when the modem answers a call. First set
the modem to auto-answer mode, with a configuration
switch. Then in the adaptor connect the modem's DCD
<a id="pB-9"></a>pin to the DSR pin on the Organiser. Now, when the
modem receives a call it asserts its DCD pin and the
Organisers DSR pin internally connected to the
<span class="key">ON/CLEAR</span> key, and so wakes up the Organiser. This
adaptor will not be reversible and you should label the
ends appropriately.
</p>

<p>
To switch the Organiser off and wait until DSR is
asserted by the modem when it answers a call, use the
OPL command OFF.
</p>

<h3>RS232 operation</h3>

<p>
Because the Comms Link software is stored on ROM
and because of power-conserving features of the
Organiser, the operation of the RS232 port is more
complex than for other computers.
</p>

<p>
In this section, the RS232 lines are described from the
Organiser point of view and you should read the left
hand column of figure 3 when converting the pin
names into pin numbers.
</p>

<p>
The RS232 port can be in one of three states:
</p>
<ul>
<li>OFF
</li><li>POWERED
</li><li>SELECTED.
</li></ul>

<h4>OFF</h4>

<p>
In the OFF state, no voltage is applied to any of the
pins of the Comms Link connector and the signals
seen by the connected device will depend upon the
hardware design of that device.
</p>

<a id="pB-10"></a>
<p>
The RS232 port is OFF when no power is supplied to
the top port. Actually, the Organiser architecture is
such that power is either supplied to all three ports or
to none of them.
</p>

<p>
Normally, in the interests of power conservation, the
Organiser switches off the ports whenever the software
is waiting for a key press. In Comms Link terminal
emulation, however, this effect is disabled.
</p>

<p>
When the Organiser is switched off, the ports are also
off. The Organiser is switched off when the top-level
menu OFF command is used, when the Organiser has
automatically switched itself off after being left for five
minutes without a key press (except in terminal
emulation), or when the OPL command OFF is used.
</p>

<h4>POWERED</h4>

<p>
The RS232 port is in the POWERED state when power
is supplied to the ports and the RS232 hardware is not
selected.
</p>

<p>
In the powered state, the Organiser is unable to
send or receive data, to set the state of RTS, or to read
CTS or DTR. However, the hardware drives TD and
RTS to the MARK state such that the communicating
device will see no data and, provided that it is using
RTS/CTS handshaking, it will not send any data to the
Organiser. If XON/XOFF handshaking is enabled, the
Comms Link software sends an XOFF followed by a
delay (to give the communicating device a chance to
respond to the XOFF) before entering into the
POWERED state from the SELECTED state.
</p>

<p>
The RS232 port is in the POWERED state when a
Datapak is being accessed or when the Comms Link
<a id="pB-11"></a>ROM is being accessed. For example, a procedure call
to any of the extensions to OPL supplied by the
Comms Link will put the RS232 port into a POWERED
state.
</p>

<h4>SELECTED</h4>

<p>
The RS232 port is in the SELECTED state when power
is supplied to the ports and the RS232 hardware is
selected.
</p>

<p>
In the SELECTED state, the Organiser is able to send
and receive data, drive RTS, and read CTS and DTR.
Received data is stored in a receive buffer by an
interrupt routine.
</p>

<p>
When the RS232 port is in the SELECTED state, RTS
is output in the SPACE state and is only temporarily
output in the MARK state when RTS/CTS
handshaking is enabled and the receive buffer is
nearly full. Also, when RTS/CTS handshaking is
enabled, transmission is paused when CTS is in the
MARK state (otherwise CTS is ignored). When CTS is
not connected on the Organiser, it floats to the MARK
state and RTS/CTS handshaking should not be
enabled when CTS is not connected.
</p>

<p>
The RS232 port is in the SELECTED state during
terminal emulation and when data is input or output
to the RS232 port. It normally remains in the
SELECTED state until something happens to move it
to the POWERED state (e.g. a Datapak access) or to
the OFF state (e.g. waiting for a key press).
</p>

<hr>

<a id="pC-1"></a>
<a id="pC"></a><h2>
Appendix C
Parity, Bits and
Stop
</h2>

<p>
As with the Baud parameter, Parity, Bits and Stop
must match the corresponding settings on the
communicating device. If they don't, then the
communicating device will almost certainly incorrectly
receive data sent to it, and the Organiser will
incorrectly interpret its received data.
</p>

<p>
These parameters determine how each character to be
transmitted over Comms Link is converted into bits.
The Organiser transmits and receives data in groups
('frames') of 10 or 11 bits. One character, or 'byte', of
data is included in each frame, together with other
information. The character itself is given by the 7 or 8
'data bits':
</p>

<p class="code">&lt;Start bit&gt;&lt;Data bits&gt;&lt;Parity bit&gt;&lt;Stop bits&gt;</p>

<p>
The start and stop bits are used to define the
beginning and end of a frame:
</p>

<p>
The start bit of a frame is always present and cannot
be altered.
</p>

<p>
The value of the <b>Stop</b> bits cannot be altered, but you
can choose whether to have 1 or 2 of them. Usually 1
stop bit is sufficient, but with slow baud rates (300 or
lower) or when communicating with some mechanical
devices you may need to have 2 bits. Having 2 stop
bits rather than 1 will never cause an error - it will just
Slow down the byte transfer rate. Putting 1 when you
should have 2, however, will cause an error.
</p>

<a id="pC-2"></a>
<p>
The number of stop bits is also used to make up the
length of the frame to either 10 or 11 bits, which are
the only lengths of frames which the Organiser can
transfer, when the other bits don't add up to one of
these totals. The software overrides the Stop parameter
value under the following circumstances:
</p>

<ul>
 <li>When Bits is set to 7 and Parity set to NONE (1
     start bit, 7 data bits and no parity bit = 8 bits
     altogether) the Organiser will add 2 stop bits
     regardless of the Stop setting.
 </li><li>When Bits is set to 8 and Parity is MARK, SPACE
     ODD or EVEN (1 start bit, 8 data bits and 1 parity
     bit = 10 bits altogether) the Organiser will add 1
     stop bit regardless of the Stop setting.
</li></ul>

<p>
The number of data bits is specified by the <b>Bits</b>
parameter. When there are only 7 data bits in the
frame, the missing 8th bit (the most significant bit) is
set to zero.
</p>

<p>
If the <b>Parity</b> parameter is set to NONE, there is no
parity bit. Otherwise the parity bit is present and its
value (0 or 1) is determined by the Parity parameter
setting. To find out the correct setting, consult the
documentation of the machine you are attaching to or
use trial and error. MARK and SPACE parity are rarely
used.
</p>

<p>
One way of telling that your Parity, Bits and/or Stop
settings are incorrect is to see whether in terminal
emulation characters are being displayed as a solid
block. These are characters which are received with an
error and are set to ASCII 255 - a solid block. (This
may also indicate that your Baud setting is wrong.) In
other cases, e.g. during file transfer or a call via
Comms Link from an OPL procedure, a DEVICE READ
<a id="pC-3"></a>ERROR is reported. If the parameter values do not
match those of the correspondents but are not too
dissimilar, you may receive some characters
(sometimes as much as half the characters) without
error.
</p>

<p>
Some manufacturers include the parity bit in their
definition of data bits. This means that 7 data bits and
a parity bit would be called 8 data bits. Check the
definition of data bits used by your target device in its
documentation.
</p>

<p>
<b>The setting of Parity, Bits and Stop are ignored in
communications involving the PSION protocol.</b>
PSION uses 8 data bits, no parity and 1 stop bit. Other
than this case, the Parity, Bits and Stop parameters
are used by all aspects of the Comms Link software.
</p>

<hr>

<a id="pI"></a><h2>
Index
</h2>

<p class="contents">A

<a href="https://www.jaapsch.net/psion/mancomms2.htm#p2-7">Abandon (Setup list)</a>
Adaptors
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#pB-6">IBM AT</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#pB-6">Macintosh</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#pB-7">modems</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#pB-5">non-standard computers</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#pB-4">Organiser pin connections</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#pB-7">printers</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p1-5">when needed</a>, <a href="https://www.jaapsch.net/psion/mancomms2.htm#pB-3">(2)</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-14">amode% parameter (XFOPEN:)</a>
Any computer
   see 'Other computers'
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-14">Appending</a>
Apple Macintosh
   see 'Macintosh'
ASCII characters
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#pA-1">control character set</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p2-5">in Setup list</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-7">in terminal emulation</a>
Auto
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p6-3">with printer</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-4">with other computers</a>
Auto-answer modem
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#pB-8">adaptor</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p4-15">with Macintosh</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p3-14">with PC</a>

B

<a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-18">BAD PARAMETER error</a>
Baud
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p6-4">for printer</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p3-16">for PC via modems</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p4-18">for Macintosh via modems</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-2">in terminal emulation</a>
Binary files
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-7">file transfer</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-12">opening/reading</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-22">example program</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#pC-1">Bits</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p6-4">for printer</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p4-15">Boot</a>

C

Capture buffer
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-13">clearing</a> <a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-18">(2)</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-11">editing</a> <a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-14">(2)</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-12">saving</a> <a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-16">(2)</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-13">transmitting</a> <a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-17">(2)</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p6-8">printing contents</a>
Capture menu
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-15">model LZ</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-10">models XP, CM</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#pB-7">Carrier detect</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-13">Clear (capture buffer)</a> <a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-18">(2)</a>
Comms Link
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p1-1">fitting/removing cable</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p4-2">installing on Macintosh</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p3-2">installing on PC</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#pB-1">interface</a>
   running program
      see 'PCs' and 'Macintosh'
Communications parameters
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p2-4">changing settings</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-3">changing with LSET:</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-2">for host dial-up service</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p4-4">for Macintosh</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-2">for other computers</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p3-4">for PC</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p6-1">for printer</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p2-2">table</a>
Communications procedures
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-5">LINPUT$:</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-3">LSET:</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-6">TRIG$:</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-12">XFCLOSE:</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-15">XFEOF:</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-16">XFGET$:</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-12">XFOPEN:</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-15">XFPOS:</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-17">XFPUT:</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-7">XTRECV.</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-7">XTSEND:</a>

D

Data files
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-14">appending</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-13">format</a>
   sending/receiving
      see 'File transfer'
<a href="https://www.jaapsch.net/psion/mancomms2.htm#pB-7">DCD (carrier detect)</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#pB-1">DCE/DTE interface</a>
Dial string
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p4-18">for Macintosh</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p3-16">for PC</a>
Dial-up services
   See 'Hosts'
Diary files
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-13">format (model LZ)</a>
   sending/receiving
      See file transfer
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p2-9">Dir (directory of Setup lists)</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-10">DIRW$ function</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-18">DISK FULL error</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#pB-5">DSR/DTR pins</a>

E

<a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-4">Echo</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-11">Editing capture buffer</a> <a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-14">(2)</a>
Electronic mail
   See 'Hosts'
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p2-9">Setup files</a>
Error messages
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-11">during XMODEM file transfer</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-18">from comm. procedures</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-18">trapping with TRAP/ONERR</a>
Example programs
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-20">connecting to modem</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-19">diary backup</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-22">opening/reading binary file</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p6-10">printing MAIN</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-11">sending all files</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-14">Existing file names</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p2-7">Exit (Setup list)</a>

F

<a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-18">FILE ALREADY EXISTS error</a>
File extensions
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-15">added by Transmit</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-8">added by XTSEND:</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-10">for DIRW$</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-18">FILE NOT FOUND error</a>
File transfer
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-7">from OPL</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-13">to/from capture buffer</a> <a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-17">(2)</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-18">with host</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p4-3">with Macintosh</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-6">with other computers</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p3-3">with PC</a>
File types
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-13">ftype% (XFOPEN:)</a>
   see 'Data files', 'Diary files',
      'Notepad files', 'Procedure files'
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-8">type% (XTSEND:)</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p4-6">Folders (Macintosh)</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-13">ftype% parameter (XFOPEN:)</a>

G

<a href="https://www.jaapsch.net/psion/mancomms2.htm#p1-4">Gender changers</a> <a href="https://www.jaapsch.net/psion/mancomms2.htm#pB-2">(2)</a>

H

Hand(shaking)
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-2">for host</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p4-18">for Macintosh via modems</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p3-17">for PC via modems</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p6-5">for printer</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p6-5">XON/XOFF, DSR/DTR</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-4">HOST echo</a>
Hosts
   capture buffer
      <a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-15">model LZ</a>
      <a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-10">model XP, CM</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-18">file transfer</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p1-4">fitting Comms Link cable</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-2">setting parameters</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-6">terminal emulation</a>

K

<a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-8">Keyboard in terminal emulation</a>

L

<a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-16">len% parameter (XFGET$:)</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-5">LINPUT$:</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p2-9">LOAD, Setup files</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-4">LOCAL Echo</a>
LPRINT
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-5">in OPL</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p6-10">printer example</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-3">LSET:</a>

M

Macintosh
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#pB-6">adaptors</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p4-15">connecting via modems</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p4-18">dial string</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p4-3">file transfer</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p1-4">fitting Comms Link cable</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p4-6">folders and file names</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p4-18">handshaking for modems</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p4-2">installing Comms Link</a>
   setting parameters
      <a href="https://www.jaapsch.net/psion/mancomms2.htm#p4-17">Setup on Macintosh</a>
      <a href="https://www.jaapsch.net/psion/mancomms2.htm#p4-4">on Organiser</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p4-7">viewing Organiser files</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p1-4">Male/female connectors</a> <a href="https://www.jaapsch.net/psion/mancomms2.htm#pB-2">(2)</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-15">mode% parameter (XFPOS:)</a>
Modems
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#pB-7">adaptors</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#pB-2">null</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#pB-1">RS232 standard</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p4-15">with Macintosh</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p3-14">with PC</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-16">with other computers</a>

N

<a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-7">NONE Protocol</a>
Notepad files
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-12">password protection</a>
   sending/receiving
      see 'File transfer'
<a href="https://www.jaapsch.net/psion/mancomms2.htm#pB-2">Null modems</a>

O

<a href="https://www.jaapsch.net/psion/mancomms2.htm#pB-9">OFF state</a>
OPL
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-17">errors</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-9">example procedures</a> <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-19">(2)</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-7">file transfer</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p6-9">printing from</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-12">remote file access</a>
   see also 'Comm. procedures'
Other computers
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-6">file transfer</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p1-4">fitting Comms Link cable</a>
   Protocol
      <a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-9">NONE</a>
      <a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-10">XMODEM</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-1">requirements</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-2">setting parameters</a>
   testing the link
      <a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-4">Auto</a>
      <a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-5">handshaking</a>
      <a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-3">Term</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-16">using modems</a>

P

<a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-8">Pager setup files, transfer</a>
Parameters
   comm. parameters
      see 'Communications parameters'
      or parameter name
   in comm. procedures
      <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-14">amode% (XFOPEN:)</a>
      <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-16">len% (XFGET$:)</a>
      <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-13">type% (XFOPEN:)</a>
      <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-15">mode% (XFPOS:)</a>
      <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-15">pos (XFOPEN:)</a>
      <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-8">type% (XTSEND:, XTRECV:)</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#pC-1">Parity</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p3-6">Pathnames</a> <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-8">(2)</a>
PCs
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p3-14">connecting via modems</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p3-3">file transfer</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p1-4">fitting Comms Link cable</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p3-2">installing Comms Link files</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p3-6">pathnames</a>
   setting up
      <a href="https://www.jaapsch.net/psion/mancomms2.htm#p3-4">on Organiser</a>
      <a href="https://www.jaapsch.net/psion/mancomms2.htm#p3-3">on PC</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p3-18">single disk drives</a>
PORT
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p4-18">for Macintosh via modems</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p3-16">for PC via modems</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-15">pos parameter (XFPOS:)</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#pB-10">POWERED state</a>
Printer
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#pB-7">adaptors</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p6-4">Baud, Parity, Bits, Stop</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p1-4">fitting Comms Link cable</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p6-11">optional features</a>
   testing the connection
      <a href="https://www.jaapsch.net/psion/mancomms2.htm#p6-3">Auto</a>
      <a href="https://www.jaapsch.net/psion/mancomms2.htm#p6-5">handshaking</a>
      <a href="https://www.jaapsch.net/psion/mancomms2.htm#p6-4">Term</a>
Printing
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p6-6">from model LZ</a>
   from models XP, CM
      <a href="https://www.jaapsch.net/psion/mancomms2.htm#p6-7">data files</a>
      <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-8">diary files</a>
      <a href="https://www.jaapsch.net/psion/mancomms2.htm#p6-8">notes from capture buffer</a>
      <a href="https://www.jaapsch.net/psion/mancomms2.htm#p6-7">procedures</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p6-9">from OPL</a>
Procedure files
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-15">names</a>
   sending/receiving
      see 'File transfer'
Protocol
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p4-4">for Macintosh</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-5">for other computers</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p3-4">for PC</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-9">NONE</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-10">XMODEM</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p3-4">PSION protocol</a> <a href="https://www.jaapsch.net/psion/mancomms2.htm#p4-4">(2)</a>

R

Receive
   see 'File transfer'
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-18">RECORD TOO LONG error</a>
Reof
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-5">for host</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-6">for other computers</a>
Reol
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-3">for host</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-6">for other computers</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p2-8">Reset</a>
RS232 port states
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#pB-9">OFF</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#pB-10">POWERED</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#pB-11">SELECTED</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-13">Rtrn</a>

S

Save
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-12">capture buffer</a> <a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-16">(2)</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p2-9">Setup files</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-7">Scrolling in terminal emulation</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#pB-11">SELECTED state</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-18">SERVER ERROR error</a>
Setup files
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-8">file transfer</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p2-8">saving/loading etc.</a>
Setup list
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p2-8">when reinitialised</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p2-7">Setup menu</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-2">Split speed host</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-8">Spreadsheet files transfer</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#pC-1">Stop</a>

T

<a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-13">TABs</a>
Teof
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-5">for host</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-6">for other computers</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p6-13">for printer</a>
Teol
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-3">for host</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-6">for other computers</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p6-12">for printer</a>
Term
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-6">with host</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-3">with other computers</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p6-4">with printer</a>
Timeout
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p6-11">for printer</a>
Transmit
   see 'File transfer'
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-18">Trapping errors</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-6">TRIG$:</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-13">Ttrn</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-8">type% (XTSEND:, XTRECV:)</a>

W

Width
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p7-4">for host</a>
   <a href="https://www.jaapsch.net/psion/mancomms2.htm#p6-11">for printer</a>

X

<a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-12">XFCLOSE:</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-15">XFEOF:</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-16">XFGET$:</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-12">XFOPEN:</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-15">XFPOS:</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-17">XFPUT:</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p5-10">XMODEM protocol</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-7">XTRECV:</a>
<a href="https://www.jaapsch.net/psion/mancomms2.htm#p8-7">XTSEND:</a>
</p>

<hr>

<div class="nav"><ul>
<li><a href="https://www.jaapsch.net/index.htm">Home</a></li>
</ul></div>



</body></html>